"undefined"===typeof console&&(console={warn:function(){},error:function(){},log:function(){},dir:function(){},time:function(){},timeEnd:function(){}});console.warn||(console.warn=function(){});console.error||(console.error=function(){});(function(){typeof window==="undefined"&&(window=this);$data=window.$data||(window.$data={});if(typeof module!=="undefined"&&module.exports){(sqLiteModule=require("sqlite3"))&&(window.openDatabase=true);module.exports=$data}})(this);
(function(a){a.__namespace=true;a.version="JayData 1.1.0";a.versionNumber="1.1.0";a.root={}})($data);
var Guard={requireValue:function(a,b){(typeof b==="undefined"||b===null)&&Guard.raise(a+" requires a value other than undefined or null")},requireType:function(a,b,c){return(c instanceof Array?c:[c]).some(function(c){switch(typeof c){case "string":return typeof b===c;case "function":return b instanceof c;default:Guard.raise("Unknown type format : "+typeof c+" for: "+a)}})},raise:function(a){if(typeof intellisense==="undefined"){a instanceof Exception?console.error(a.name+":",a.message+"\n",a):console.error(a);
throw a;}}};Object.isNullOrUndefined=function(a){return a===void 0||a===null};
(function(){if(!Object.getOwnPropertyNames)Object.getOwnPropertyNames=function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c);return b};if(!Object.create)Object.create=function(a){function b(){}arguments.length>1&&Guard.raise(Error("Object.create implementation only accepts the first parameter."));b.prototype=a;return new b};if(!Object.keys){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty",
"isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;Object.keys=function(e){(typeof e!=="object"&&typeof e!=="function"||e===null)&&Guard.raise(new TypeError("Object.keys called on non-object"));var h=[],f;for(f in e)a.call(e,f)&&h.push(f);if(b)for(f=0;f<d;f++)a.call(e,c[f])&&h.push(c[f]);return h}}if(!Object.defineProperty)Object.defineProperty=function(a,b,c){a[b]=c.value||{}};if(!Object.defineProperties)Object.defineProperties=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=
b[c].value||{})};if(!Array.prototype.forEach)Array.prototype.forEach=function(a,b){for(var c=0,d=this.length;c<d;c++)b?a.call(b,this[c],c,this):a(this[c],c,this)};if(!Array.prototype.filter)Array.prototype.filter=function(a,b){for(var c=[],d=0,n=this.length;d<n;d++)(b?a.call(b,this[d],d,this):a(this[d],d,this))===true&&c.push(this[d]);return c};if(!Array.prototype.map)Array.prototype.map=function(a,b){for(var c=[],d=0,n=this.length;d<n;d++){var u=b?a.call(b,this[d],d,this):a(this[d],d,this);c.push(u)}return c};
if(!Array.prototype.some)Array.prototype.some=function(a,b){for(var c=0,d=this.length;c<d;c++)if(b?a.call(b,this[c],c,this):a(this[c],c,this))return true;return false};if(!Array.prototype.indexOf)Array.prototype.indexOf=function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]===a)return b;return-1}})();
(function(a,b){if(!a.datajs)a.datajs={};if(!a.OData)a.OData={};var c=a.datajs,d=a.OData,e=function(a){return a!==null&&a!==b},h=function(a,b){var c,d;c=0;for(d=a.length;c<d;c++)if(a[c]===b)return true;return false},f=function(b){if(arguments.length===1)a.setTimeout(b,0);else{var c=Array.prototype.slice.call(arguments,1);a.setTimeout(function(){b.apply(this,c)},0)}},j=function(a,b){if(!a)return null;if(k(a)){var c,d,i;c=0;for(d=a.length;c<d;c++)if(i=j(a[c],b))return i;return null}return a.dataServices?
j(a.dataServices.schema,b):b(a)},n=function(a){return a.__edmType==="Edm.DateTimeOffset"||!a.__edmType&&a.__offset},u=function(a,b){a=a===0?"":"."+A(a.toString(),3);if(b>0){a===""&&(a=".000");a=a+A(b.toString(),4)}return a},q=function(a){if(typeof a==="string")return a;var b=n(a),c=s(a.__offset);if(b&&c!=="Z"){var a=new Date(a.valueOf()),d=H(c),b=a.getUTCHours()+d.d*d.h,d=a.getMinutes()+d.d*d.m;a.setUTCHours(b,d)}else b||(c="");var b=a.getUTCFullYear(),d=a.getUTCMonth()+1,i="";if(b<=0){b=-(b-1);i=
"-"}var e=u(a.getUTCMilliseconds(),a.__ns);return i+A(b,4)+"-"+A(d,2)+"-"+A(a.getUTCDate(),2)+"T"+A(a.getUTCHours(),2)+":"+A(a.getUTCMinutes(),2)+":"+A(a.getUTCSeconds(),2)+e+c},M=function(a){var b=a.ms,c="";if(b<0){c="-";b=-b}var d=Math.floor(b/864E5),b=b-864E5*d,i=Math.floor(b/36E5),b=b-36E5*i,e=Math.floor(b/6E4),b=b-6E4*e,f=Math.floor(b/1E3),b=b-f*1E3;return c+"P"+A(d,2)+"DT"+A(i,2)+"H"+A(e,2)+"M"+A(f,2)+u(b,a.ns)+"S"},A=function(a,b,c){for(a=a.toString(10);a.length<b;)a=c?a+"0":"0"+a;return a},
s=function(a){return!a||a==="Z"||a==="+00:00"||a==="-00:00"?"Z":a},o=function(a,c,d,i,e,f){return e.request(a,function(e){try{e.headers&&F(e.headers);e.data===b&&i.read(e,f)}catch(l){if(l.request===b)l.request=a;if(l.response===b)l.response=e;d(l);return}c(e.data,e)},d)},k=function(a){return Object.prototype.toString.call(a)==="[object Array]"},Ia=function(a,b){if(a){var c,d;c=0;for(d=a.length;c<d;c++)if(a[c].name===b)return a[c]}return null},va=function(a,b,c){return a?j(b,function(b){var d;a:{if(b){d=
a.indexOf(b.namespace)===0&&a.charAt(b.namespace.length)==="."?a.substr(b.namespace.length+1):null;b=b[c];if(d&&b){var i,ab;i=0;for(ab=b.length;i<ab;i++)if(b[i].name===d){d=b[i];break a}}}d=null}return d}):null},C=function(a,b){return va(a,b,"entityType")},O={accept:"Accept","content-type":"Content-Type",dataserviceversion:"DataServiceVersion",maxdataserviceversion:"MaxDataServiceVersion"},F=function(a){for(var b in a){var c=b.toLowerCase();if((c=O[c])&&b!==c){var d=a[b];delete a[b];a[c]=d}}},w=function(a){return parseInt(a,
10)},bb=/^([+-])?P(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)D)?(?:T(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)(?:\.(\d+))?S)?)?/,B=function(a){a=bb.exec(a);if(a===null)throw{message:"Invalid duration value."};var b=a[2]||"0",c=a[3]||"0",d=w(a[4]||0),i=w(a[5]||0),e=w(a[6]||0),f=parseFloat(a[7]||0);if(b!=="0"||c!=="0")throw{message:"Unsupported duration value."};c=a[8];b=0;if(c){if(c.length>7)throw{message:"Cannot parse duration value to given precision."};b=A(c.substring(3),4,true);c=A(c.substring(0,3),3,true);c=w(c);b=w(b)}else c=
0;c=c+(f*1E3+e*6E4+i*36E5+d*864E5);a[1]==="-"&&(c=-c);a={ms:c,__edmType:"Edm.Time"};if(b)a.ns=b;return a},H=function(a){var b=a.substring(0,1),b=b==="+"?1:-1,c=w(a.substring(1)),a=w(a.substring(a.indexOf(":")+1));return{d:b,h:c,m:a}},J=function(a){switch(typeof a){case "object":return!a?"n":k(a)||k(a.results)?"f":a.__metadata&&a.__metadata.uri!==b?"entry":k(a.EntitySets)?"s":k(a.__batchRequests)?"b":Object.prototype.toString.call(a)==="[object Date]"?"p":"c";case "string":case "number":case "boolean":return"p"}return"u"},
K=function(a,c,d){if(!a.method)a.method="GET";a.headers?F(a.headers):a.headers={};if(a.headers.Accept===b)a.headers.Accept=c.accept;e(a.data)&&a.body===b&&c.write(a,d);if(!e(a.headers.MaxDataServiceVersion))a.headers.MaxDataServiceVersion=c.maxDataServiceVersion||"1.0"},ga=function(a){switch(J(a)){case "c":return a.__deferred&&a.__deferred.uri?"d":"c";case "f":case "entry":return"i";case "p":return"p"}return"n"},Pa=function(a){throw a;},ea=/^([^:\/?#]+:)?(\/\/[^\/?#]*)?([^?#:]+)?(\?[^#]*)?(#.*)?/,
t=["scheme","authority","path","query","fragment"],Qa=function(a){var b={isAbsolute:false};if(a){if(a=ea.exec(a)){var c,d;c=0;for(d=t.length;c<d;c++)a[c+1]&&(b[t[c]]=a[c+1])}if(b.scheme)b.isAbsolute=true}return b},R=function(a){return"".concat(a.scheme||"",a.authority||"",a.path||"",a.query||"",a.fragment||"")},Ra=/^\/{0,2}(?:([^@]*)@)?([^:]+)(?::{1}(\d+))?/,Eb=/%[0-9A-F]{2}/ig,Z=function(a){var a=Qa(a),b=a.scheme,c=a.authority;if(b){a.scheme=b.toLowerCase();if(c)if(b=Ra.exec(c))a.authority="//"+
(b[1]?b[1]+"@":"")+b[2].toLowerCase()+(b[3]?":"+b[3]:"")}a=R(a);return a.replace(Eb,function(a){return a.toLowerCase()})},ha=function(a,b){if(!b)return a;var c=Qa(a);if(c.isAbsolute)return a;var d=Qa(b),i={},e;if(c.authority){i.authority=c.authority;e=c.path;i.query=c.query}else{if(c.path){if(c.path.charAt(0)==="/")e=c.path;else{e=c.path;var f=d.path,l="/";if(f){l=f.lastIndexOf("/");l=f.substring(0,l);l.charAt(l.length-1)!=="/"&&(l=l+"/")}e=l+e}i.query=c.query}else{e=d.path;i.query=c.query||d.query}i.authority=
d.authority}for(var l=f="",g;e;)if(e.indexOf("..")===0||e.indexOf(".")===0)e=e.replace(/^\.\.?\/?/g,"");else if(e.indexOf("/..")===0){e=e.replace(/^\/\..\/?/g,"/");g=f.lastIndexOf("/");f=g===-1?"":f.substring(0,g)}else if(e.indexOf("/.")===0)e=e.replace(/^\/\.\/?/g,"/");else{l=e;g=e.indexOf("/",1);g!==-1&&(l=e.substring(0,g));f=f+l;e=e.replace(l,"")}i.path=f;i.scheme=d.scheme;i.fragment=c.fragment;return R(i)},za=0,Pb=function(b){var c=a.document.createElement("IFRAME");c.style.display="none";b='<html><head><script type="text/javascript" src="'+
b.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/\</g,"&lt;")+'"><\/script></head><body></body></html>';a.document.getElementsByTagName("BODY")[0].appendChild(c);N(c,b);return c},V=function(){if(a.XMLHttpRequest)return new a.XMLHttpRequest;var b;if(a.ActiveXObject)try{return new a.ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(c){try{return new a.ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(d){b=d}}else b={message:"XMLHttpRequest not supported"};throw b;},Aa=function(b){if(!(b.indexOf("http://")===
0||b.indexOf("https://")===0||b.indexOf("file://")===0))return true;var c=a.location;return b.indexOf(c.protocol+"//"+c.host+"/")===0},ib=function(a){if(a){N(a,"");a.parentNode.removeChild(a)}return null},N=function(a,b){var c=a.contentWindow?a.contentWindow.document:a.contentDocument.document;c.open();c.write(b);c.close()};d.defaultHttpClient={callbackParameterName:"$callback",formatQueryString:"$format=json",enableJsonpCallback:false,request:function(c,d,i){var e={},l=null,g=false,h;e.abort=function(){h=
ib(h);if(!g){g=true;if(l){l.abort();l=null}i({message:"Request aborted"})}};var j=function(){h=ib(h);if(!g){g=true;l=null;i({message:"Request timed out"})}},z,n=c.requestUri,u=c.callbackParameterName!==b?c.callbackParameterName:this.callbackParameterName,k=c.formatQueryString!==b?c.formatQueryString:this.formatQueryString;if(!(c.enableJsonpCallback!==b?c.enableJsonpCallback:this.enableJsonpCallback)||Aa(n)){l=V();l.onreadystatechange=function(){if(!g&&!(l===null||l.readyState!==4)){var a=l.statusText,
b=l.status;if(b===1223){b=204;a="No Content"}var e=[],f=l.getAllResponseHeaders().split(/\r?\n/),h,j;h=0;for(j=f.length;h<j;h++)if(f[h]){var ic=f[h].split(": ");e[ic[0]]=ic[1]}a={requestUri:n,statusCode:b,statusText:a,headers:e,body:l.responseText};g=true;l=null;b>=200&&b<=299?d(a):i({message:"HTTP request failed",request:c,response:a})}};l.open(c.method||"GET",n,true,c.user,c.password);if(c.headers)for(z in c.headers)l.setRequestHeader(z,c.headers[z]);if(c.timeoutMS){l.timeout=c.timeoutMS;l.ontimeout=
j}l.send(c.body)}else{var T;T=c.method&&c.method!=="GET"?false:true;if(!T)throw{message:"Request is not local and cannot be done through JSONP."};var m=za;za=za+1;var q;z="handleJSONP_"+m.toString();a[z]=function(c){h=ib(h);if(!g){a.clearTimeout(q);var ua=z;try{delete a[ua]}catch(i){a[ua]=b;m===za-1&&(za=za-1)}a.ActiveXObject&&!a.DOMParser&&(c=a.JSON.parse(a.JSON.stringify(c)));f(d,{body:c,statusCode:200,headers:{"Content-Type":"application/json"}})}};q=a.setTimeout(j,c.timeoutMS?c.timeoutMS:12E4);
j=u+"=parent."+z;this.formatQueryString&&(j=j+("&"+k));k=n.indexOf("?");n=k===-1?n+"?"+j:k===n.length-1?n+j:n+"&"+j;h=Pb(n)}return e}};var x=function(a){if(!a)return null;var a=a.split(";"),b={},c,d;c=1;for(d=a.length;c<d;c++){var i=a[c].split("=");b[i[0].trim?i[0].trim():i[0].replace(/^\s+|\s+$/g,"")]=i[1]}return{mediaType:a[0].trim?a[0].trim():a[0].replace(/^\s+|\s+$/g,""),properties:b}},Ta=function(a,b,c,d){return{contentType:a,dataServiceVersion:b,metadata:c?c.metadata:null,context:c,handler:d}},
jb=function(a,b,c){if(a){a=a.headers;a[b]||(a[b]=c)}},P=function(a,c){var d=a.headers;return d&&d[c]||b},wa=/^\s?(\d+\.\d+);?.*$/,qa=function(a){if(a=P(a,"DataServiceVersion"))if((a=wa.exec(a))&&a.length)return a[1]},Ua=function(a,c,d,i){return{accept:d,maxDataServiceVersion:i,read:function(c,d){var i;if(!c||!c.headers)i=false;else{var ab=x(P(c,"Content-Type")),f=qa(c)||"";i=c.body;if(e(i))if(this.accept.indexOf(ab.mediaType)>=0){ab=Ta(ab,f,d,this);ab.response=c;c.data=a(this,i,ab);i=c.data!==b}else i=
false;else i=false}return i},write:function(a,d){var ua;a:{if(a&&a.headers){var i=x(P(a,"Content-Type")),e=qa(a);if(!i||this.accept.indexOf(i.mediaType)>=0){i=Ta(i,e,d,this);i.request=a;a.body=c(this,a.data,i);if(a.body!==b){jb(a,"DataServiceVersion",i.dataServiceVersion||"1.0");if(i=i.contentType){e=i.mediaType;for(ua in i.properties)e=e+(";"+ua+"="+i.properties[ua]);ua=e}else ua=b;jb(a,"Content-Type",ua);jb(a,"MaxDataServiceVersion",this.maxDataServiceVersion);ua=true;break a}}}ua=false}return ua}}};
d.textHandler=Ua(function(a,b){return b},function(a,c){return e(c)?c.toString():b},"text/plain","2.0");var ra=function(a,b,c){try{a.setProperty(b,c)}catch(d){}},ia=function(){var b;if(a.ActiveXObject)try{b=new ActiveXObject("Msxml2.DOMDocument.6.0");b.async=false;return b}catch(c){try{b=new ActiveXObject("Msxml2.DOMDocument.3.0");b.async=false;ra(b,"ProhibitDTD",true);ra(b,"MaxElementDepth",256);ra(b,"AllowDocumentFunction",false);ra(b,"AllowXsltScript",false);return b}catch(d){b=d}}else{if(a.DOMParser)return new a.DOMParser;
b={message:"XML DOM parser not supported"}}throw b;},Va=function(a){return{name:a.localName,namespace:a.nsURI,value:a.domNode.value}},Fb=function(a){var b={name:a.localName,namespace:a.nsURI,value:Ja(a.domNode),attributes:[],children:[]};Ba(a,function(a){a.nsURI!=="http://www.w3.org/2000/xmlns/"&&b.attributes.push(Va(a))});fa(a,function(a){b.children.push(Fb(a))});return b},Ja=function(a){for(var c=null,d=a.firstChild,i=a.ownerDocument.preserveWhiteSpace===false,e;d;){if(d.nodeType===3||d.nodeType===
4){var f=d.nodeValue,l;if(!(l=i)){l=/^\s*$/;l=!(f===null||l.test(f))}if(!l){if(e===b)a:{for(e=a;e!==null&&e.nodeType===1;){l=W(e,"space","http://www.w3.org/XML/1998/namespace");if(l==="preserve"){e=true;break a}else if(l==="default")break;else e=e.parentNode}e=false}l=e}l&&(c=c?c+f:f)}d=d.nextSibling}return c},sa=function(a,b,c){if(a.getElementsByTagNameNS){b=a.getElementsByTagNameNS(b,c);if(b.length!==0)return b[0]}else for(a=a.firstChild;a;){if(a.nodeType===1&&(a.localName?a.localName:a.baseName)===
c&&a.namespaceURI===b)return a;a=a.nextSibling}return null},Ka=function(a,b,c){var d=a.ownerDocument,b=d.createAttributeNS?d.createAttributeNS("http://www.w3.org/2000/xmlns/",b):d.createNode(2,b,"http://www.w3.org/2000/xmlns/");b.nodeValue=c;a.setAttributeNode(b)},na=function(a,b){if(/(^\s)|(\s$)/.test(b))tb(a,"space","http://www.w3.org/XML/1998/namespace","xml").value="preserve";var c=a.ownerDocument.createTextNode(b);a.appendChild(c)},Ba=function(a,b){var c,d=a.domNode,i,e;i=0;for(e=d.attributes.length;i<
e;i++){c=d.attributes.item(i);b(ja(c))}},fa=function(a,b){for(var c=a.domNode.firstChild,d;c!==null;){if(c.nodeType===1){d=ha(W(c,"base","http://www.w3.org/XML/1998/namespace"),a.baseURI);b(ja(c,d))}c=c.nextSibling}},I=function(a){for(var b=a.domNode.firstChild;b!==null;){if(b.nodeType===1){a=ha(W(b,"base","http://www.w3.org/XML/1998/namespace"),a.baseURI);return ja(b,a)}b=b.nextSibling}return null},X=function(a){var c=a.text;if(c!==b)return c;var c="",d=a.firstChild;if(d){do{if(d.nodeType===3||d.nodeType===
4)c=c+d.nodeValue;var i=d.firstChild;if(i)d=i;else for(;d!==a;)if(i=d.nextSibling){d=i;break}else d=d.parentNode}while(d!==a)}return c},ub=function(b,c){var d;if(a.ActiveXObject){d=ia();d.documentElement=d.createNode(1,b,c)}else a.document.implementation&&a.document.implementation.createDocument&&(d=a.document.implementation.createDocument(c,b,null));return ja(d.documentElement)},tb=function(a,c,d,i){var e=a.ownerDocument,c=i?i+":"+c:c;if(e.createAttributeNS){c=e.createAttributeNS(d,c);a.setAttributeNodeNS(c)}else{c=
e.createNode(2,c,d||b);a.setAttributeNode(c)}return c},aa=function(a,c,d,i){var e=a.domNode.ownerDocument,c=e.createElementNS?e.createElementNS(d,c):e.createNode(1,c,d||b);i&&na(c,i);a.domNode.appendChild(c);return ja(c)},ta=function(a,c,d,i){var e=a.domNode.ownerDocument;if(e.createAttributeNS){c=e.createAttributeNS(d,c);c.value=i;a.domNode.setAttributeNodeNS(c)}else{c=e.createNode(2,c,d||b);c.value=i;a.domNode.setAttributeNode(c)}return ja(c)},oa=function(a,b){var c,d=ia();if(d.parseFromString){var d=
d.parseFromString(a,"text/xml"),i=d.documentElement;c=ja(i,"");if(c.localName==="parsererror"&&c.nsURI==="http://www.mozilla.org/newlayout/xml/parsererror.xml"){d=Ja(i);c=sa(c,"http://www.mozilla.org/newlayout/xml/parsererror.xml","sourcetext");throw{message:d,errorXmlText:a,srcText:c?c.nodeValue:""};}if(c.localName==="h3"&&c.nsURI=="http://www.w3.org/1999/xhtml"||sa(i,"http://www.w3.org/1999/xhtml","h3"))throw{message:X(i),errorXmlText:a,srcText:""};}else{d.loadXML(a);if(d.parseError.errorCode!==
0)throw{message:d.parseError.reason,errorXmlText:a,srcText:d.parseError.srcText};}c=d.documentElement;d=ha(W(c,"base","http://www.w3.org/XML/1998/namespace"),b);return ja(c,d)},D=function(c){var d=c.xml;if(d!==b)return d;if(a.XMLSerializer)return(new a.XMLSerializer).serializeToString(c);throw{message:"XML serialization unsupported"};},W=function(a,b,c){if(a.getAttributeNS)return a.getAttributeNS(c||null,b);return(a=a.attributes.getQualifiedItem(b,c))?a.value:null},ja=function(a,b){var c=a.namespaceURI,
d=a.nodeName;c||(c=a.nodeType===2&&(d==="xmlns"||d.indexOf("xmlns:",0)===0)?"http://www.w3.org/2000/xmlns/":null);return{baseURI:b,domNode:a,localName:a.localName?a.localName:a.baseName,nsURI:c}},Wa=function(a){var b=[];fa(a,function(a){if(a.localName==="uri"&&a.nsURI==="http://schemas.microsoft.com/ado/2007/08/dataservices"){a={uri:X(a.domNode)};b.push(a)}});return{results:b}};d.xmlHandler=Ua(function(a,c){if(c){var d=oa(c);if(d){a:{if(d.nsURI==="http://schemas.microsoft.com/ado/2007/08/dataservices")switch(d.localName){case "links":d=
Wa(d);break a;case "uri":d={uri:X(d.domNode)};break a}d=b}return d}}},function(a,c,d){d=d.contentType=d.contentType||x("application/xml");a=b;if(d&&d.mediaType==="application/xml"){if(J(c)==="c"&&!c.__metadata&&c.hasOwnProperty("uri")){d=ub("uri","http://schemas.microsoft.com/ado/2007/08/dataservices");c.uri&&na(d.domNode,c.uri);c=d}else c=void 0;c&&(a=D(c.domNode.ownerDocument))}return a},"application/xml","2.0");var vb=["application/atom+xml","application/atomsvc+xml","application/xml"],Gb=vb[0],
cb=["http://www.w3.org/2005/Atom","http://www.w3.org/2007/app","http://www.w3.org/XML/1998/namespace","http://www.w3.org/2000/xmlns/"],Hb={SyndicationAuthorEmail:"author/email",SyndicationAuthorName:"author/name",SyndicationAuthorUri:"author/uri",SyndicationContributorEmail:"contributor/email",SyndicationContributorName:"contributor/name",SyndicationContributorUri:"contributor/uri",SyndicationPublished:"published",SyndicationRights:"rights",SyndicationSummary:"summary",SyndicationTitle:"title",SyndicationUpdated:"updated"},
db=function(a){return a},ka=/^(-?\d{4,})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?(.*)$/,eb=function(a,b){var c=ka.exec(a),d=c?s(c[8]):null;if(!c||!b&&d!=="Z")throw{message:"Invalid date/time value"};var i=w(c[1]);i<=0&&i++;var e=c[7],f=0;if(e){if(e.length>7)throw{message:"Cannot parse date/time value to given precision."};f=A(e.substring(3),4,true);e=A(e.substring(0,3),3,true);e=w(e);f=w(f)}else e=0;var l=w(c[4]),g=w(c[5]),h=w(c[6]);if(d!=="Z")var j=H(d),z=-j.d,l=l+j.h*z,g=g+j.m*z;j=new Date;
j.setUTCFullYear(i,w(c[2])-1,w(c[3]));j.setUTCHours(l,g,h,e);if(isNaN(j.valueOf()))throw{message:"Invalid date/time value"};if(b){j.__edmType="Edm.DateTimeOffset";j.__offset=d}if(f)j.__ns=f;return j},La={"Edm.Boolean":function(a){return a==="true"},"Edm.Binary":db,"Edm.DateTime":function(a){return eb(a,false)},"Edm.DateTimeOffset":function(a){return eb(a,true)},"Edm.Time":B,"Edm.Decimal":db,"Edm.Guid":db,"Edm.String":db,"Edm.Byte":w,"Edm.Double":parseFloat,"Edm.Single":parseFloat,"Edm.Int16":w,"Edm.Int32":w,
"Edm.Int64":db,"Edm.SByte":w},S=function(a){return a.toString()},Ib={"Edm.Binary":S,"Edm.Boolean":S,"Edm.Byte":S,"Edm.DateTime":q,"Edm.DateTimeOffset":q,"Edm.Decimal":S,"Edm.Double":S,"Edm.Guid":S,"Edm.Int16":S,"Edm.Int32":S,"Edm.Int64":S,"Edm.SByte":S,"Edm.Single":S,"Edm.String":S,"Edm.Time":M},kb=function(a,b){if(a!==null&&b){var c=La[b];c&&(a=c(a))}return a},Qb=function(a,b){if(a!==null&&b){Object.prototype.toString.call(a)==="[object Date]"&&(b=n(a)?"Edm.DateTimeOffset":"Edm.DateTime");var c=
Ib[b];c&&(a=c(a))}return a},mb=function(a,b){if(a.nsURI==="http://www.w3.org/2005/Atom")switch(a.localName){case "feed":return Jb(a,b);case "entry":return lb(a,b)}if(a.nsURI==="http://www.w3.org/2007/app"&&a.localName==="service")return wb(a)},Jb=function(a,b){var c={},d={results:[],__metadata:c};c.feed_extensions=Ca(a);fa(a,function(a){switch(a.nsURI){case "http://www.w3.org/2005/Atom":switch(a.localName){case "id":c.uri=ha(X(a.domNode),a.baseURI);c.uri_extensions=Ca(a);break;case "title":c.title=
X(a.domNode);c.title_extensions=Ca(a);break;case "entry":a=lb(a,b);d.results.push(a);break;case "link":var a=Rb(a),i=d.__metadata;switch(a.rel){case "next":d.__next=a.href;i.next_extensions=a.extensions;break;case "self":i.self=a.href;i.self_extensions=a.extensions}}return;case "http://schemas.microsoft.com/ado/2007/08/dataservices/metadata":if(a.localName==="count"){d.__count=w(X(a.domNode));return}}a=G(a);c.feed_extensions.push(a)});return d},Rb=function(a){var b={extensions:[]},c;Ba(a,function(d){if(!d.nsURI)switch(d.localName){case "href":b.href=
ha(d.domNode.nodeValue,a.baseURI);return;case "type":case "rel":b[d.localName]=d.domNode.nodeValue;return}if(!h(cb,d.nsURI)){c=Ma(d);b.extensions.push(c)}});if(!b.href)throw{error:"href attribute missing on link element",element:a};return b},G=function(a){var b={name:a.localName,namespaceURI:a.nsURI,attributes:Ca(a),children:[]};fa(a,function(a){a=G(a);b.children.push(a)});if(b.children.length===0)if(a=X(a.domNode))b.value=a;return b},Ca=function(a){var b=[];Ba(a,function(a){if(!h(cb,a.nsURI)){a=
Ma(a);b.push(a)}});return b},Ma=function(a){return{name:a.localName,namespaceURI:a.nsURI,value:a.domNode.nodeValue}},xb=function(a,c){if(a.indexOf("/")===-1)return c[a];var d=a.split("/"),i,e;i=0;for(e=d.length;i<e;i++){if(c===null)return b;c=c[d[i]];if(c===b)break}return c},Zb=function(a){if(a.childNodes.length)return false;var a=a.attributes,b=a.length;if(b===0)return true;for(var c=0;c<b;c++){var d=a[c].nodeName;if(d!=="xmlns"&&d.indexOf("xmlns:")!==0&&d!=="m:type")return false}return true},Xa=
function(a,c,d,i,f,l,g){var h=a["FC_TargetPath"+l],j=Hb[h]||h,h=h!==j?"http://www.w3.org/2005/Atom":a["FC_NsUri"+l],z=a["FC_KeepInContent"+l]==="true"?true:false,n=a["FC_ContentKind"+l],a=a["FC_NsPrefix"+l]||null,i=xb(c,i);if(e(i)){if(!z){g.dataServiceVersion="2.0";a:{g=sa(d.domNode,"http://schemas.microsoft.com/ado/2007/08/dataservices/metadata","properties");if(!g)(z=sa(d.domNode,"http://www.w3.org/2005/Atom","content"))&&(g=sa(z,"http://schemas.microsoft.com/ado/2007/08/dataservices/metadata",
"properties"));if(g){var z=g,c=c.split("/"),k,l=0;for(k=c.length-1;l<k;l++){z=sa(z,"http://schemas.microsoft.com/ado/2007/08/dataservices",c[l]);if(!z)break a}(c=sa(z,"http://schemas.microsoft.com/ado/2007/08/dataservices",c[l]))&&z.removeChild(c);for(c=z;c!==g&&Zb(c);){z=c.parentNode;z.removeChild(c);c=z}}}}f=i=Qb(i,f);c=d.domNode;j=j.split("/");d=0;for(i=j.length;d<i;d++){if(j[d].charAt(0)==="@"){g=j[d].substring(1);z=h;l=c.attributes;(g=l.getNamedItemNS?l.getNamedItemNS(z,g):l.getQualifiedItem(g,
z))||(g=tb(c,j[d].substring(1),h,a))}else{g=sa(c,h,j[d]);if(!g){g=j[d];z=h;l=c.ownerDocument;k=void 0;g=a?a+":"+g:g;k=l.createElementNS?l.createElementNS(z,g):l.createNode(1,g,z||b);c.appendChild(k);g=k}}c=g}if(c.nodeType===2)c.value=f;else{n&&c.setAttribute("type",n);if(n==="xhtml"){h=c;n=oa("<c>"+f+"</c>",null);a=h.ownerDocument;j=n.domNode;"importNode"in a&&(j=a.importNode(n.domNode,true));for(n=j.firstChild;n;){h.appendChild(n);n=n.nextSibling}}else na(c,f)}}},yb=function(a,c,d,i,e,f){if(a["FC_KeepInContent"+
f]!=="true"&&xb(c,i)!==null){var l=a["FC_TargetPath"+f],g=Hb[l]||l;a:{var l=l!==g?"http://www.w3.org/2005/Atom":a["FC_NsUri"+f],d=d.domNode,a=a["FC_ContentKind"+f]==="xhtml",g=g.split("/"),h,f=0;for(h=g.length;f<h;f++)if(g[f].charAt(0)==="@"){d=W(d,g[f].substring(1),l);break a}else{d=sa(d,l,g[f]);if(!d){d=b;break a}}if(a){l=d.childNodes;g=l.length;if(g===0)d="";else{a=d.ownerDocument.createDocumentFragment();for(d=0;d<g;d++)a.appendChild(l[d].cloneNode(true));d=D(a)}}else d=X(d)}if(d!==b){d=kb(d,
e);a:{if(c.indexOf("/")!==-1){c=c.split("/");l=0;for(g=c.length-1;l<g;l++){a=i[c[l]];if(a===b){a={};i[c[l]]=a}else if(a===null)break a;i=a}c=c[l]}i[c]=d;if(e){i=i.__metadata=i.__metadata||{};i=i.properties=i.properties||{};(i[c]=i[c]||{}).type=e}}}}},zb=function(a,c,d){for(var d=d.split("/"),i,e;c;){var l=c;i=0;for(e=d.length;i<e;i++){l=l.property;if(!l)break;l=Ia(l,d[i]);if(!l)break;l=l.type;if(!l||l&&La[l]!==b)return l||null;l=va(l,a,"complexType");if(!l)return null}c=C(c.baseType,a)}return null},
Sb=function(a,b,c){if(c&&c.length!==0)for(var d=b.__metadata.type;d;){d=C(d,c);if(!d)break;var i,e=d.FC_SourcePath;if(e){i=zb(c,d,e);yb(d,e,a,b,i,"")}var l=d.property;if(l){var f,g;f=0;for(g=l.length;f<g;f++)for(var h=l[f],j=0,z="";h["FC_TargetPath"+z];){e=h.name;i=h.type;var n=h["FC_SourcePath"+z];if(n){e=e+("/"+n);i=zb(c,d,e)}yb(h,e,a,b,i,z);j++;z="_"+j}}d=d.baseType}},lb=function(a,b){var c={},d={__metadata:c},i=W(a.domNode,"etag","http://schemas.microsoft.com/ado/2007/08/dataservices/metadata");
if(i)c.etag=i;fa(a,function(a){if(a.nsURI==="http://www.w3.org/2005/Atom")switch(a.localName){case "id":c.uri=ha(X(a.domNode),a.baseURI);c.uri_extensions=Ca(a);break;case "category":$b(a,d,c);break;case "content":ac(a,d);break;case "link":var i=Rb(a),e=d.__metadata;switch(i.rel){case "self":e.self=i.href;e.self_link_extensions=i.extensions;break;case "edit":e.edit=i.href;e.edit_link_extensions=i.extensions;break;case "edit-media":e.edit_media=i.href;e.edit_media_extensions=[];var l,f;l=0;for(f=i.extensions.length;l<
f;l++)i.extensions[l].namespaceURI==="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata"&&i.extensions[l].name==="etag"?e.media_etag=i.extensions[l].value:e.edit_media_extensions.push(i.extensions[l]);break;default:i.rel.indexOf("http://schemas.microsoft.com/ado/2007/08/dataservices/related/")===0&&bc(a,i,d,b)}}a.nsURI==="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata"&&a.localName==="properties"&&r(a,d,c)});Sb(a,d,b);return d},$b=function(a,b,c){var d=W(a.domNode,"scheme",
void 0),i=W(a.domNode,"term",void 0);if(d==="http://schemas.microsoft.com/ado/2007/08/dataservices/scheme"){if(b.__metadata.type)throw{message:"Invalid AtomPub document: multiple category elements defining the entry type were encounterd withing an entry",element:a};c.type=i;c.type_extensions=[];var e;Ba(a,function(a){if(a.nsURI){if(!h(cb,a.nsURI)){e=Ma(a);c.type_extensions.push(e)}}else if(a.localName!=="scheme"&&a.localName!=="term"){e=Ma(a);c.type_extensions.push(e)}})}},ac=function(a,b){var c=
W(a.domNode,"src",void 0),d=W(a.domNode,"type",void 0),i=b.__metadata;if(c){if(!d)throw{message:"Invalid AtomPub document: content element must specify the type attribute if the src attribute is also specified",element:a};i.media_src=ha(c,a.baseURI);i.content_type=d}fa(a,function(d){if(c)throw{message:"Invalid AtomPub document: content element must not have child elements if the src attribute is specified",element:a};d.nsURI==="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata"&&d.localName===
"properties"&&r(d,b,i)})},bc=function(a,c,d,i){var e=c.rel.substring(62),l=b;fa(a,function(a){if(a.nsURI==="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata"&&a.localName==="inline")l=(a=I(a))?mb(a,i):null});l===b&&(l={__deferred:{uri:c.href}});d[e]=l;d.__metadata.properties=d.__metadata.properties||{};d.__metadata.properties[e]={extensions:c.extensions}},r=function(a,b,c){fa(a,function(a){if(a.nsURI==="http://schemas.microsoft.com/ado/2007/08/dataservices"){c.properties=c.properties||
{};nb(a,b,c.properties)}})},nb=function(a,c,d){var i=null,e="Edm.String",l=[];Ba(a,function(a){if(a.nsURI==="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata")switch(a.localName){case "null":i=a.domNode.nodeValue;return;case "type":e=a.domNode.nodeValue;return}if(!h(cb,a.nsURI)){a=Ma(a);l.push(a)}});var f=null,g={type:e,extensions:l};if(i!=="true"){f=X(a.domNode);if(e&&La[e]!==b)f=kb(f,e);else if(I(a)){f={__metadata:{type:e}};r(a,f,g)}}c[a.localName]=f;d[a.localName]=g},wb=function(a){var b=
{workspaces:[],extensions:[]};fa(a,function(c){if(c.nsURI==="http://www.w3.org/2007/app"&&c.localName==="workspace"){c=pa(c);b.workspaces.push(c)}else{c=G(a);b.extensions.push(c)}});if(b.workspaces.length===0)throw{message:"Invalid AtomPub service document: No workspace element found.",element:a};return b},pa=function(a){var b={collections:[],extensions:[]};fa(a,function(c){if(c.nsURI==="http://www.w3.org/2005/Atom"){if(c.localName==="title"){if(a.title)throw{message:"Invalid AtomPub service document: workspace has more than one child title element",
element:c};b.title=X(c.domNode)}}else if(c.nsURI==="http://www.w3.org/2007/app"){if(c.localName==="collection"){c=ob(c,b);b.collections.push(c)}}else{c=G(a);b.extensions.push(c)}});b.title=b.title||"";return b},ob=function(a){var b={href:W(a.domNode,"href",void 0),extensions:[]};if(!b.href)throw{message:"Invalid AtomPub service document: collection has no href attribute",element:a};b.href=ha(b.href,a.baseURI);fa(a,function(c){if(c.nsURI==="http://www.w3.org/2005/Atom"){if(c.localName==="title"){if(b.title)throw{message:"Invalid AtomPub service document: collection has more than one child title element",
element:c};b.title=X(c.domNode)}}else if(c.nsURI!=="http://www.w3.org/2007/app"){c=G(a);b.extensions.push(c)}});if(!b.title)throw{message:"Invalid AtomPub service document: collection has no title element",element:a};return b},Ab=function(a,b){if(a)return aa(a,b,"http://www.w3.org/2005/Atom");var c=ub(b,"http://www.w3.org/2005/Atom");Ka(c.domNode,"xmlns:d","http://schemas.microsoft.com/ado/2007/08/dataservices");Ka(c.domNode,"xmlns:m","http://schemas.microsoft.com/ado/2007/08/dataservices/metadata");
return c},pb=function(a,b,c){a=Ab(a,"feed");if(b=k(b)?b:b.results){var d,i;d=0;for(i=b.length;d<i;d++)Ya(a,b[d],c)}return a},Ya=function(a,b,c){var a=Ab(a,"entry"),d=aa(a,"author","http://www.w3.org/2005/Atom");aa(d,"name","http://www.w3.org/2005/Atom");aa(a,"title","http://www.w3.org/2005/Atom");d=aa(a,"content","http://www.w3.org/2005/Atom");ta(d,"type",null,"application/xml");var d=aa(d,"m:properties","http://schemas.microsoft.com/ado/2007/08/dataservices/metadata"),i=b.__metadata?b.__metadata.properties:
null,e=b.__metadata;if(e){e.etag&&ta(a,"etag","http://schemas.microsoft.com/ado/2007/08/dataservices/metadata",e.etag);e.uri&&aa(a,"id","http://www.w3.org/2005/Atom",e.uri);if(e.type){var l=aa(a,"category","http://www.w3.org/2005/Atom");ta(l,"term",null,e.type);ta(l,"scheme",null,"http://schemas.microsoft.com/ado/2007/08/dataservices/scheme")}}y(a,d,b,i,c);if(b.__metadata){d=c.metadata;for(i=C(b.__metadata.type,d);i;){if(e=i.FC_SourcePath){l=zb(d,i,e);Xa(i,e,a,b,l,"",c)}if(l=i.property){var f,g;f=
0;for(g=l.length;f<g;f++)for(var h=l[f],j=0,z="";h["FC_TargetPath"+z];){e=h.name;h["FC_SourcePath"+z]&&(e=e+("/"+h["FC_SourcePath"+z]));Xa(h,e,a,b,h.type,z,c);j++;z="_"+j}}i=C(i.baseType,d)}}return a},y=function(a,c,d,i,e){var l,f,g,h,j=e.metadata,z;for(l in d)if(l!=="__metadata"){f=d[l];g=ga(f);h=i?i[l]:null;if(!h){z===b&&d.__metadata&&(z=C(d.__metadata.type,j));if(z)(h=Ia(z.property,l))||(h=Ia(z.navigationProperty,l))}if(g==="n"){g="p";h&&!(h.type&&La[h.type]!==b)&&(h.relationship?g="i":va(h.type,
e.metadata,"complexType")&&(g="c"))}if(g==="p"||g==="c"){var n=c,k=e,u="d:"+l,T=h&&h.type,m=void 0;if(g==="c"){m=aa(n,u,"http://schemas.microsoft.com/ado/2007/08/dataservices");g=void 0;if(h)g=h.properties;if(f===null)k.dataServiceVersion="2.0";y(null,m,f,g,k)}else m=aa(n,u,"http://schemas.microsoft.com/ado/2007/08/dataservices",Qb(f,T||"Edm.String"));f===null&&ta(m,"m:null","http://schemas.microsoft.com/ado/2007/08/dataservices/metadata","true");T&&ta(m,"m:type","http://schemas.microsoft.com/ado/2007/08/dataservices/metadata",
T)}else{T=a;m=l;n=f;f=e;k=h=u=void 0;if(g=g==="i"){u=n&&n.__metadata?n.__metadata.uri:"";k=J(n);switch(k){case "entry":h=Ya;break;case "f":k="feed";h=pb;break;case "n":k="entry";h=null;break;default:throw{message:"Invalid payload for inline navigation property: "+k};}}else u=n.__deferred.uri;var q=ha(m,"http://schemas.microsoft.com/ado/2007/08/dataservices/related/"),m=u,u=q,T=aa(T,"link","http://www.w3.org/2005/Atom");ta(T,"rel",null,u);ta(T,"href",null,m);if(g){g=aa(T,"m:inline","http://schemas.microsoft.com/ado/2007/08/dataservices/metadata");
ta(T,"type",null,"application/atom+xml;type="+k);h&&h(g,n,f)}}}};d.atomHandler=Ua(function(a,b,c){if(b)if(a=oa(b))return mb(a,c.metadata)},function(a,c,d){var a=d.contentType=d.contentType||x(Gb),i=b;if(a&&a.mediaType===Gb){var e;switch(J(c)){case "f":e=pb(null,c,d);break;case "entry":case "c":e=Ya(null,c,d)}i=D(e.domNode.ownerDocument)}return i},vb.join(","),"2.0");var L={Association:{attributes:["Name"],elements:["End*","ReferentialConstraint"]},AssociationSet:{attributes:["Name","Association"],
elements:["End*"]},CollectionType:{attributes:["ElementType","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation"]},ComplexType:{attributes:["Name","BaseType","Abstract"],elements:["Property*"]},DefiningExpression:{text:true},Dependent:{attributes:["Role"],elements:["PropertyRef*"]},Documentation:{text:true},End:{attributes:["Type","Role","Multiplicity","EntitySet"],elements:["OnDelete"]},EntityContainer:{attributes:["Name","Extends"],elements:["EntitySet*",
"AssociationSet*","FunctionImport*"]},EntitySet:{attributes:["Name","EntityType"]},EntityType:{attributes:["Name","BaseType","Abstract","OpenType"],elements:["Key","Property*","NavigationProperty*"]},Function:{attributes:["Name","ReturnType"],elements:["Parameter*","DefiningExpression","ReturnType"]},FunctionImport:{attributes:["Name","ReturnType","EntitySet"],elements:["Parameter*"]},Key:{elements:["PropertyRef*"]},NavigationProperty:{attributes:["Name","Relationship","ToRole","FromRole"]},OnDelete:{attributes:["Action"]},
Parameter:{attributes:["Name","Type","Mode","MaxLength","Precision","Scale"]},Principal:{attributes:["Role"],elements:["PropertyRef*"]},Property:{attributes:["Name","Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation","ConcurrencyMode"]},PropertyRef:{attributes:["Name"]},ReferenceType:{attributes:["Type"]},ReferentialConstraint:{elements:["Principal","Dependent"]},ReturnType:{attributes:["ReturnType"],elements:["CollectionType","ReferenceType","RowType"]},
RowType:{elements:["Property*"]},Schema:{attributes:["Namespace","Alias"],elements:["Using*","EntityContainer*","EntityType*","Association*","ComplexType*","Function*"]},TypeRef:{attributes:["Type","Nullable","DefaultValue","MaxLength","FixedLength","Precision","Scale","Unicode","Collation"]},Using:{attributes:["Namespace","Alias"]}},Da=["m:FC_ContentKind","m:FC_KeepInContent","m:FC_NsPrefix","m:FC_NsUri","m:FC_SourcePath","m:FC_TargetPath"];L.Property.attributes=L.Property.attributes.concat(Da);
L.EntityType.attributes=L.EntityType.attributes.concat(Da);L.Edmx={attributes:["Version"],elements:["DataServices"],ns:"http://schemas.microsoft.com/ado/2007/06/edmx"};L.DataServices={elements:["Schema*"],ns:"http://schemas.microsoft.com/ado/2007/06/edmx"};L.EntityContainer.attributes.push("m:IsDefaultEntityContainer");L.Property.attributes.push("m:MimeType");L.FunctionImport.attributes.push("m:HttpMethod");L.EntityType.attributes.push("m:HasStream");L.DataServices.attributes=["m:DataServiceVersion",
"m:MaxDataServiceVersion"];var fb=function(a){if(!a)return a;if(a.length>1){var b=a.substr(0,2);return b===b.toUpperCase()?a:a.charAt(0).toLowerCase()+a.substr(1)}return a.charAt(0).toLowerCase()},qb=function(a,b){if(b==="Documentation")return{isArray:true,propertyName:"documentation"};var c=a.elements;if(!c)return null;var d,i;d=0;for(i=c.length;d<i;d++){var e=c[d],l=false;if(e.charAt(e.length-1)==="*"){l=true;e=e.substr(0,e.length-1)}if(b===e){c=fb(e);return{isArray:l,propertyName:c}}}return null},
rb=/^(m:FC_.*)_[0-9]+$/,Ea=function(a){a.domNode||(a=ja(a,""));var b=L[a.localName];if(!b)return null;if(b.ns){if(a.nsURI!==b.ns)return null}else if(!(a.nsURI==="http://schemas.microsoft.com/ado/2008/09/edm"||a.nsURI==="http://schemas.microsoft.com/ado/2006/04/edm"||a.nsURI==="http://schemas.microsoft.com/ado/2007/05/edm"||a.nsURI==="http://schemas.microsoft.com/ado/2009/11/edm"))return null;var c={},d=[],i=b.attributes||[];Ba(a,function(a){var b=a.localName,e=a.nsURI,l=a.domNode.value;if(e!=="http://www.w3.org/2000/xmlns/"){var f=
null,g=false;e==="http://schemas.microsoft.com/ado/2008/09/edm"||e==="http://schemas.microsoft.com/ado/2006/04/edm"||e==="http://schemas.microsoft.com/ado/2007/05/edm"||e==="http://schemas.microsoft.com/ado/2009/11/edm"||e===null?f="":e==="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata"&&(f="m:");if(f!==null){f=f+b;(e=rb.exec(f))&&(f=e[1]);if(h(i,f)){g=true;c[fb(b)]=l}}g||d.push(Va(a))}});fa(a,function(a){var i=qb(b,a.localName);if(i)if(i.isArray){var e=c[i.propertyName];if(!e){e=
[];c[i.propertyName]=e}e.push(Ea(a))}else c[i.propertyName]=Ea(a);else d.push(Fb(a))});if(b.text)c.text=X(a);if(d.length)c.extensions=d;return c};d.metadataHandler=Ua(function(a,c){var d=oa(c);return Ea(d)||b},null,"application/xml","2.0");var Kb=["application/json","application/json;odata=verbose"],Bb=x(Kb[0]),cc=x(Kb[1]),g=/^\/Date\((-?\d+)(\+|-)?(\d+)?\)\/$/,Na=function(a){var b=a&&g.exec(a);if(b){a=new Date(w(b[1]));if(b[2]){var c=w(b[3]);b[2]==="-"&&(c=-c);b=a.getUTCMinutes();a.setUTCMinutes(b-
c);a.__edmType="Edm.DateTimeOffset";if(c<0){b="-";c=-c}else b="+";var d=Math.floor(c/60),c=c-60*d,c=b+A(d,2)+":"+A(c,2);a.__offset=c}if(!isNaN(a.valueOf()))return a}},m=function(a,c){if(a&&typeof a==="object")for(var d in a){var i=a[d],e=m(i,c),e=c(d,e);e!==i&&(i===b?delete a[d]:a[d]=e)}return a},ba=function(a,b){return b("",m(a,b))},Lb=function(a,b){return b&&b.__edmType==="Edm.Time"?M(b):b},la=function(a,b){if(J(a)==="s"){var c={collections:[]},d,i;d=0;for(i=a.EntitySets.length;d<i;d++){var e=a.EntitySets[d],
e={title:e,href:ha(e,b)};c.collections.push(e)}return{workspaces:[c]}}return a},Fa=function(a,b){b&&b.lastIndexOf(";")===b.length-1&&(b=b.substr(0,b.length-1));b||k(a)&&(b="1.0");b==="1.0"&&k(a)&&(a={results:a});return a};d.jsonHandler=Ua(function(c,d,i){var e=i.metadata,l=(i.context?i.context.recognizeDates:b)!==b?i.context?i.context.recognizeDates:b:c.recognizeDates,c=typeof d==="string"?a.JSON.parse(d):d,c=ba(c,function(a,b){if(b&&typeof b==="object"){var c=b.__metadata&&b.__metadata.type;if(c=
C(c,e)||va(c,e,"complexType")){var d=c.property;if(d){var i,f;i=0;for(f=d.length;i<f;i++){var g=d[i],h=g.name,c=b[h];if(g.type==="Edm.DateTime"||g.type==="Edm.DateTimeOffset"){if(c){c=Na(c);if(!c)throw{message:"Invalid date/time value"};b[h]=c}}else g.type==="Edm.Time"&&(b[h]=B(c))}}}else if(l)for(d in b){c=b[d];typeof c==="string"&&(b[d]=Na(c)||c)}}return b}).d,c=Fa(c,i.dataServiceVersion);return c=la(c,i.response.requestUri)},function(c,d,i){c=b;if((i=i.contentType=i.contentType||cc)&&i.mediaType===
Bb.mediaType){i=Date.prototype.toJSON;try{Date.prototype.toJSON=function(){return q(this)};c=a.JSON.stringify(d,Lb)}finally{Date.prototype.toJSON=i}}return c},Kb.join(","),"2.0");d.jsonHandler.recognizeDates=false;var dc=/^HTTP\/1\.\d (\d{3}) (.*)$/i,ec=/^([^()<>@,;:\\"\/[\]?={} \t]+)\s?:\s?(.*)/,E=function(){return Math.floor((1+Math.random())*65536).toString(16).substr(1)},Tb=function(a){a=a.boundaries;return a[a.length-1]},Cb=function(a,b){var c="--"+Tb(b);Ga(a,b,c);Ga(a,b,"\r\n");for(var d=[],
i;i!=="--"&&b.position<a.length;){i=Q(a,b);if((i=x(i["Content-Type"]))&&i.mediaType==="multipart/mixed"){b.boundaries.push(i.properties.boundary);try{var e=Cb(a,b)}catch(l){l.response=Ub(a,b,c);e=[l]}d.push({__changeResponses:e});b.boundaries.pop();Ga(a,b,"--"+Tb(b))}else{if(!i||i.mediaType!=="application/http")throw{message:"invalid MIME part type "};Ga(a,b,"\r\n");i=Ub(a,b,c);try{i.statusCode>=200&&i.statusCode<=299?b.handlerContext.handler.partHandler.read(i,b.handlerContext):i={message:"HTTP request failed",
response:i}}catch(f){i=f}d.push(i)}i=a.substr(b.position,2);Ga(a,b,"\r\n")}return d},Q=function(a,b){var c={},d,i,e;do{e=b.position;i=Ga(a,b,"\r\n");d=ec.exec(i);d!==null?c[d[1]]=d[2]:b.position=e}while(i&&d);F(c);return c},Ub=function(a,b,c){var d=b.position,i=dc.exec(Ga(a,b,"\r\n")),e,l,f;if(i){e=i[1];l=i[2];f=Q(a,b);Ga(a,b,"\r\n")}else b.position=d;return{statusCode:e,statusText:l,headers:f,body:Ga(a,b,"\r\n"+c)}},Ga=function(a,b,c){var d=b.position||0,i=a.length;if(c){i=a.indexOf(c,d);if(i===
-1)return null;b.position=i+c.length}else b.position=i;return a.substring(d,i)},xa=function(a,b){var c="\r\n--"+a;b&&(c=c+"--");return c+"\r\n"},ma=function(a,b,c){var d=a.__changeRequests;if(k(d)){if(c)throw{message:"Not Supported: change set nested in other change set"};var a="changeset_"+E()+"-"+E()+"-"+E(),c="Content-Type: multipart/mixed; boundary="+a+"\r\n",i,e;i=0;for(e=d.length;i<e;i++)c=c+(xa(a,false)+ma(d[i],b,true));c=c+xa(a,true)}else{c="Content-Type: application/http\r\nContent-Transfer-Encoding: binary\r\n\r\n";
K(a,b.handler.partHandler,{metadata:b.metadata});b=(a.method?a.method:"GET")+" "+a.requestUri+" HTTP/1.1\r\n";for(i in a.headers)a.headers[i]&&(b=b+i+": "+a.headers[i]+"\r\n");b=b+"\r\n";a.body&&(b=b+a.body);c=c+b}return c};d.batchHandler=Ua(function(a,b,c){return{__batchResponses:Cb(b,{boundaries:[c.contentType.properties.boundary],handlerContext:c})}},function(a,b,c){if((c.contentType=c.contentType||x("multipart/mixed")).mediaType==="multipart/mixed"){a=J(b);if(a!=="b")throw{message:'Serialization of batches of type "'+
a+'" is not supported'};var a="batch_"+E()+"-"+E()+"-"+E(),b=b.__batchRequests,d="",i,e;i=0;for(e=b.length;i<e;i++)d=d+(xa(a,false)+ma(b[i],c));d=d+xa(a,true);c.contentType.properties.boundary=a;return d}},"multipart/mixed","2.0");var sb=[d.jsonHandler,d.atomHandler,d.xmlHandler,d.textHandler],p=function(a,b,c){var d,i;d=0;for(i=sb.length;d<i&&!sb[d][a](b,c);d++);if(d===i)throw{message:"no handler for data"};};d.defaultSuccess=function(b){a.alert(a.JSON.stringify(b))};d.defaultError=Pa;d.defaultHandler=
{read:function(a,b){a&&e(a.body)&&a.headers["Content-Type"]&&p("read",a,b)},write:function(a,b){p("write",a,b)},maxDataServiceVersion:"2.0",accept:"application/atomsvc+xml;q=0.8, application/json;odata=verbose;q=0.5, */*;q=0.1"};d.defaultMetadata=[];d.read=function(a,b,c,i,e,l){return d.request(a instanceof String||typeof a==="string"?{requestUri:a}:a,b,c,i,e,l)};d.request=function(a,c,i,e,l,f){if(!c)c=d.defaultSuccess;if(!i)i=d.defaultError;if(!e)e=d.defaultHandler;if(!l)l=d.defaultHttpClient;if(!f)f=
d.defaultMetadata;a.recognizeDates=a.recognizeDates!==b?a.recognizeDates:d.jsonHandler.recognizeDates;a.callbackParameterName=a.callbackParameterName!==b?a.callbackParameterName:d.defaultHttpClient.callbackParameterName;a.formatQueryString=a.formatQueryString!==b?a.formatQueryString:d.defaultHttpClient.formatQueryString;a.enableJsonpCallback=a.enableJsonpCallback!==b?a.enableJsonpCallback:d.defaultHttpClient.enableJsonpCallback;f={metadata:f,recognizeDates:a.recognizeDates,callbackParameterName:a.callbackParameterName,
formatQueryString:a.formatQueryString,enableJsonpCallback:a.enableJsonpCallback};try{K(a,e,f);return o(a,c,i,e,l,f)}catch(g){i(g)}};d.batchHandler.partHandler=d.defaultHandler;var ca=a.localStorage,Ha=function(){var a={v:this.valueOf(),t:"[object Date]"},b;for(b in this)a[b]=this[b];return a},Db=function(a,b){if(b&&b.t==="[object Date]"){var c=new Date(b.v),d;for(d in b)d!=="t"&&d!=="v"&&(c[d]=b[d]);b=c}return b},U=function(a){this.name=a};U.create=function(a){if(U.isSupported())return new U(a);throw{message:"Web Storage not supported by the browser"};
};U.isSupported=function(){return!!ca};U.prototype.add=function(a,b,c,d){var d=d||this.defaultError,i=this;this.contains(a,function(e){e?f(d,{message:"key already exists",key:a}):i.addOrUpdate(a,b,c,d)},d)};U.prototype.addOrUpdate=function(c,d,i,e){e=e||this.defaultError;if(c instanceof Array)e({message:"Array of keys not supported"});else{var l=this.name+"#!#"+c,g=Date.prototype.toJSON;try{var h=d;if(h!==b){Date.prototype.toJSON=Ha;h=a.JSON.stringify(d)}ca.setItem(l,h);f(i,c,d)}catch(j){j.code===
22||j.number===2147942414?f(e,{name:"QUOTA_EXCEEDED_ERR",error:j}):f(e,j)}finally{Date.prototype.toJSON=g}}};U.prototype.clear=function(a,b){b=b||this.defaultError;try{for(var c=0,d=ca.length;d>0&&c<d;){var i=ca.key(c),e=i.replace(this.name+"#!#","");if(i!==e){ca.removeItem(i);d=ca.length}else c++}f(a)}catch(l){f(b,l)}};U.prototype.close=function(){};U.prototype.contains=function(a,b,c){c=c||this.defaultError;try{var d=ca.getItem(this.name+"#!#"+a);f(b,d!==null)}catch(i){f(c,i)}};U.prototype.defaultError=
Pa;U.prototype.getAllKeys=function(a,b){var b=b||this.defaultError,c=[],d,i;try{d=0;for(i=ca.length;d<i;d++){var e=ca.key(d),l=e.replace(this.name+"#!#","");e!==l&&c.push(l)}f(a,c)}catch(g){f(b,g)}};U.prototype.mechanism="dom";U.prototype.read=function(c,d,i){i=i||this.defaultError;if(c instanceof Array)i({message:"Array of keys not supported"});else try{var e=ca.getItem(this.name+"#!#"+c),e=e!==null&&e!=="undefined"?a.JSON.parse(e,Db):b;f(d,c,e)}catch(l){f(i,l)}};U.prototype.remove=function(a,b,
c){c=c||this.defaultError;if(a instanceof Array)c({message:"Batches not supported"});else try{ca.removeItem(this.name+"#!#"+a);f(b)}catch(d){f(c,d)}};U.prototype.update=function(a,b,c,d){var d=d||this.defaultError,i=this;this.contains(a,function(e){e?i.addOrUpdate(a,b,c,d):f(d,{message:"key not found",key:a})},d)};var Vb=a.mozIndexedDB,v=a.IDBTransaction,da=a.IDBKeyRange,ya=function(a,b){return function(c){c.code===11&&(c={name:"QUOTA_EXCEEDED_ERR",error:c});a?a(c):b&&b(c)}},Oa=function(a,b,c,d){var i=
a.name,e=a.db,l=ya(d,a.defaultError);if(e)c(e.transaction(i,b));else{var f=Vb.open("_datajs_"+i);f.onsuccess=function(d){e=a.db=d.target.result;if(e.objectStoreNames.contains(i))c(e.transaction(i,b));else{d=e.setVersion("1.0");d.onsuccess=function(){e.createObjectStore(i,null,false);c(e.transaction(i,b))};d.onerror=l;d.onblocked=l}};f.onerror=ya(d,this.defaultError)}},Y=function(a){this.name=a};Y.create=function(a){if(Y.isSupported())return new Y(a);throw{message:"IndexedDB is not supported on this browser"};
};Y.isSupported=function(){return!!Vb};Y.prototype.add=function(a,b,c,d){var i=this.name,e=this.defaultError,l=[],f=[];if(a instanceof Array){l=a;f=b}else{l=[a];f=[b]}Oa(this,v.READ_WRITE,function(g){g.onabort=ya(d,e);g.oncomplete=function(){a instanceof Array?c(l,f):c(a,b)};for(var h=0;h<l.length&&h<f.length;h++)g.objectStore(i).add(f[h],l[h])},d)};Y.prototype.addOrUpdate=function(a,b,c,d){var i=this.name,e=this.defaultError,l=[],f=[];if(a instanceof Array){l=a;f=b}else{l=[a];f=[b]}Oa(this,v.READ_WRITE,
function(g){g.onabort=ya(d,e);g.oncomplete=function(){a instanceof Array?c(l,f):c(a,b)};for(var h=0;h<l.length&&h<f.length;h++)g.objectStore(i).put(f[h],l[h])},d)};Y.prototype.clear=function(a,b){var c=this.name,d=this.defaultError;Oa(this,v.READ_WRITE,function(i){i.onerror=ya(b,d);i.oncomplete=function(){a()};i.objectStore(c).clear()},b)};Y.prototype.close=function(){if(this.db){this.db.close();this.db=null}};Y.prototype.contains=function(a,c,d){var i=this.name,e=this.defaultError;Oa(this,v.READ_ONLY,
function(l){var f=l.objectStore(i).openCursor(da.only(a));l.oncomplete=function(){c(f.result!==b)};l.onerror=ya(d,e)},d)};Y.prototype.defaultError=Pa;Y.prototype.getAllKeys=function(a,b){var c=this.name,d=this.defaultError;Oa(this,v.READ_ONLY,function(i){var e=[];i.oncomplete=function(){a(e)};i=i.objectStore(c).openCursor();i.onerror=ya(b,d);i.onsuccess=function(a){if(a=a.target.result){e.push(a.key);a["continue"].call(a)}}},b)};Y.prototype.mechanism="indexeddb";Y.prototype.read=function(a,b,c){var d=
this.name,i=this.defaultError,e=a instanceof Array?a:[a];Oa(this,v.READ_WRITE,function(l){var f=[];l.onerror=ya(c,i);l.oncomplete=function(){a instanceof Array?b(e,f):b(e[0],f[0])};for(var g=0;g<e.length;g++){var h=l.objectStore(d);h.get.call(h,e[g]).onsuccess=function(a){f.push(a.target.result)}}},c)};Y.prototype.remove=function(a,b,c){var d=this.name,i=this.defaultError,e=a instanceof Array?a:[a];Oa(this,v.READ_WRITE,function(a){a.onerror=ya(c,i);a.oncomplete=function(){b()};for(var l=0;l<e.length;l++){var f=
a.objectStore(d);f["delete"].call(f,e[l])}},c)};Y.prototype.update=function(a,b,c,d){var i=this.name,e=this.defaultError,l=[],f=[];if(a instanceof Array){l=a;f=b}else{l=[a];f=[b]}Oa(this,v.READ_WRITE,function(g){g.onabort=ya(d,e);g.oncomplete=function(){a instanceof Array?c(l,f):c(a,b)};for(var h=0;h<l.length&&h<f.length;h++){var j=g.objectStore(i).openCursor(da.only(l[h]));j.pair={key:l[h],value:f[h]};j.onsuccess=function(a){var b=a.target.result;b?b.update(a.target.pair.value):g.abort()}}},d)};
var Za=function(a){var c=[],d=[],i={};this.name=a;var e=function(a){return a||this.defaultError},l=function(a,c){var d;a instanceof Array&&(d="Array of keys not supported");if(a===b||a===null)d="Invalid key";if(d){f(c,{message:d});return false}return true};this.add=function(a,b,c,d){d=e(d);l(a,d)&&(i.hasOwnProperty(a)?d({message:"key already exists",key:a}):this.addOrUpdate(a,b,c,d))};this.addOrUpdate=function(a,g,h,j){j=e(j);if(l(a,j)){j=i[a];j===b&&(j=c.length>0?c.splice(0,1):d.length);d[j]=g;i[a]=
j;f(h,a,g)}};this.clear=function(a){d=[];i={};c=[];f(a)};this.contains=function(a,b){var c=i.hasOwnProperty(a);f(b,c)};this.getAllKeys=function(a){var b=[],c;for(c in i)b.push(c);f(a,b)};this.read=function(a,b,c){c=e(c);l(a,c)&&f(b,a,d[i[a]])};this.remove=function(a,g,h){h=e(h);if(l(a,h)){h=i[a];if(h!==b){if(h===d.length-1)d.pop();else{d[h]=b;c.push(h)}delete i[a];d.length===0&&(c=[])}f(g)}};this.update=function(a,b,c,d){d=e(d);l(a,d)&&(i.hasOwnProperty(a)?this.addOrUpdate(a,b,c,d):d({message:"key not found",
key:a}))}};Za.create=function(a){return new Za(a)};Za.isSupported=function(){return true};Za.prototype.close=function(){};Za.prototype.defaultError=Pa;Za.prototype.mechanism="memory";var fc={indexeddb:Y,dom:U,memory:Za};c.defaultStoreMechanism="best";c.createStore=function(a,b){if(!b)b=c.defaultStoreMechanism;b==="best"&&(b=U.isSupported()?"dom":"memory");var d=fc[b];if(d)return d.create(a);throw{message:"Failed to create store",name:a,mechanism:b};};var Wb=function(a,b,c){return function(){a[b].apply(a,
arguments);return c}},$a=function(){this._fail=this._done=this._arguments=b;this._rejected=this._resolved=false};$a.prototype={then:function(a,b){if(a)this._done?this._done.push(a):this._done=[a];if(b)this._fail?this._fail.push(b):this._fail=[b];this._resolved?this.resolve.apply(this,this._arguments):this._rejected&&this.reject.apply(this,this._arguments);return this},resolve:function(){if(this._done){var a,c;a=0;for(c=this._done.length;a<c;a++)this._done[a].apply(null,arguments);this._done=b;this._resolved=
false;this._arguments=b}else{this._resolved=true;this._arguments=arguments}},reject:function(){if(this._fail){var a,c;a=0;for(c=this._fail.length;a<c;a++)this._fail[a].apply(null,arguments);this._fail=b;this._rejected=false;this._arguments=b}else{this._rejected=true;this._arguments=arguments}},promise:function(){var a={};a.then=Wb(this,"then",a);return a}};var gb=function(){return a.jQuery&&a.jQuery.Deferred?new a.jQuery.Deferred:new $a},gc=function(a,b){var c=a.indexOf("?"),d="";if(c>=0){d=a.substr(c);
a=a.substr(0,c)}a[a.length-1]!=="/"&&(a=a+"/");return a+b+d},Mb=function(a,b){return{method:"GET",requestUri:a,user:b.user,password:b.password,enableJsonpCallback:b.enableJsonpCallback,callbackParameterName:b.callbackParameterName,formatQueryString:b.formatQueryString}},Xb=function(a,c,i,e,l){var a=Mb(a,c),f=d.request(a,function(a){var b=a.__next;i=i.concat(a.results);b?f=Xb(b,c,i,e,l):e(i)},l,b,c.httpClient,c.metadata);return{abort:function(){f.abort()}}},hc=function(a){var c=this,i=a.source;c.identifier=
Z(encodeURI(decodeURI(i)));c.options=a;c.count=function(a,e){var l=c.options;return d.request(Mb(gc(i,"$count"),l),function(b){b=w(b.toString());isNaN(b)?e({message:"Count is NaN",count:b}):a(b)},e,b,l.httpClient,l.metadata)};c.read=function(a,b,d,e){a="$skip="+a+"&$top="+b;b=i.indexOf("?")>=0?"&":"?";return Xb(i+b+a,c.options,[],d,e)};return c},Yb=function(a,c){if(a===b||typeof a!=="number")throw{message:"'"+c+"' must be a number."};if(isNaN(a)||a<0||!isFinite(a))throw{message:"'"+c+"' must be greater than or equal to zero."};
},Nb=function(a,c){if(a!==b&&(typeof a!=="number"||isNaN(a)||!isFinite(a)))throw{message:"'"+c+"' must be a number."};},Ob=function(a,b){var c,d;c=0;for(d=a.length;c<d;c++)if(a[c]===b){a.splice(c,1);return true}return false},i=function(a,b){for(var c in b)a[c]=b[c];return a},l=function(a){var b=0,c=typeof a;if(c==="object"&&a)for(var d in a)b=b+(d.length*2+l(a[d]));else b=c==="string"?a.length*2:8;return b},z=function(a,b,c){a=Math.floor(a/c)*c;b=Math.ceil((b+1)/c)*c;return{i:a,c:b-a}},T=function(a,
b,c,d,i,e,l){var f,g,h=this;h.p=b;h.i=d;h.c=i;h.d=e;h.s="start";h.canceled=false;h.pending=l;h.oncomplete=null;h.cancel=function(){if(c){var a=h.s;if(a!=="error"&&a!=="end"&&a!=="cancel"){h.canceled=true;j("cancel",f)}}};h.complete=function(){j("end",f)};h.error=function(a){h.canceled||j("error",a)};h.run=function(a){g=a;h.transition(h.s,f)};h.wait=function(a){j("wait",a)};var j=function(b,c){h.s=b;f=c;var d=g;switch(b){case "start":d!=="init"&&a(h,b,d,c);break;case "wait":a(h,b,d,c);break;case "cancel":a(h,
b,d,c);h.fireCanceled();j("end");break;case "error":a(h,b,d,c);h.canceled=true;h.fireRejected(c);j("end");break;case "end":if(h.oncomplete)h.oncomplete(h);h.canceled||h.fireResolved();a(h,b,d,c);break;default:a(h,b,d,c)}};h.transition=j;return h};T.prototype.fireResolved=function(){var a=this.p;if(a){this.p=null;a.resolve(this.d)}};T.prototype.fireRejected=function(a){var b=this.p;if(b){this.p=null;b.reject(a)}};T.prototype.fireCanceled=function(){this.fireRejected({canceled:true,message:"Operation canceled"})};
var hb=function(d){var h="init",g={counts:0,netReads:0,prefetches:0,cacheReads:0},j=[],n=[],k=[],u=0,m=false,q=d.cacheSize!==b?d.cacheSize:1048576,o=0,Sa=0,hb=0,p=q===0,s=d.pageSize!==b?d.pageSize:50,M=d.prefetchSize!==b?d.prefetchSize:s,r="1.0",A,C=0,v=d.source;typeof v==="string"&&(v=new hc(d));v.options=d;var y=c.createStore(d.name,d.mechanism),t=this;t.onidle=d.idle;t.stats=g;t.count=function(){if(A)throw A;var a=gb(),b=false;if(m){f(function(){a.resolve(o)});return a.promise()}var c=v.count(function(b){c=
null;g.counts++;a.resolve(b)},function(d){c=null;a.reject(i(d,{canceled:b}))});return i(a.promise(),{cancel:function(){if(c){b=true;c.abort();c=null}}})};t.clear=function(){if(A)throw A;if(j.length===0){var a=gb(),b=new T(P,a,false);G(b,j);return a.promise()}return j[0].p};t.filterForward=function(a,b,c){return x(a,b,c,false)};t.filterBack=function(a,b,c){return x(a,b,c,true)};t.readRange=function(a,b){Yb(a,"index");Yb(b,"count");if(A)throw A;var c=gb(),d=new T(S,c,true,a,b,[],0);G(d,n);return i(c.promise(),
{cancel:function(){d.cancel()}})};t.ToObservable=t.toObservable=function(){if(!a.Rx||!a.Rx.Observable)throw{message:"Rx library not available - include rx.js"};if(A)throw A;return a.Rx.Observable.CreateWithDisposable(function(a){var b=false,c=0,d=function(c){b||a.OnError(c)},i=function(e){if(!b){var l,f;l=0;for(f=e.length;l<f;l++)a.OnNext(e[l]);if(e.length<s)a.OnCompleted();else{c=c+s;t.readRange(c,s).then(i,d)}}};t.readRange(c,s).then(i,d);return{Dispose:function(){b=true}}})};var F=function(a){return function(b){A=
{message:a,error:b};var c,b=0;for(c=n.length;b<c;b++)n[b].fireRejected(A);b=0;for(c=j.length;b<c;b++)j[b].fireRejected(A);n=j=null}},B=function(a){if(a!==h){h=a;var a=j.concat(n,k),b,c;b=0;for(c=a.length;b<c;b++)a[b].run(h)}},Ia=function(){var a=new $a;y.clear(function(){u=0;m=false;hb=Sa=o=0;p=q===0;g={counts:0,netReads:0,prefetches:0,cacheReads:0};t.stats=g;y.close();a.resolve()},function(b){a.reject(b)});return a},E=function(a){var b=Ob(j,a);if(!b)(b=Ob(n,a))||Ob(k,a);C--;B("idle")},O=function(a){var b=
new $a,c=v.read(a,s,function(c){b.resolve({i:a,c:c.length,d:c})},function(a){b.reject(a)});return i(b,{cancel:function(){if(c){c.abort();c=null}}})},x=function(a,b,c,d){a=w(a);b=w(b);if(isNaN(a))throw{message:"'index' must be a valid number.",index:a};if(isNaN(b))throw{message:"'count' must be a valid number.",count:b};if(A)throw A;var a=Math.max(a,0),e=gb(),l=[],f=false,h=null,g=function(a,i){f||(b>=0&&l.length>=b?e.resolve(l):h=t.readRange(a,i).then(function(f){for(var h=0,j=f.length;h<j&&(b<0||
l.length<b);h++){var z=d?j-h-1:h,n=f[z];if(c(n)){z={index:a+z,item:n};d?l.unshift(z):l.push(z)}}if(!d&&f.length<i||d&&a<=0)e.resolve(l);else{f=d?Math.max(a-s,0):a+i;g(f,s)}},function(a){e.reject(a)}))},j=z(a,a,s);g(d?j.i:a,d?a-j.i+1:j.i+j.c-a);return i(e.promise(),{cancel:function(){h&&h.cancel();f=true}})},D=function(){if(t.onidle&&C===0)t.onidle()},G=function(a,b){a.oncomplete=E;b.push(a);C++;a.run(h)},J=function(a){var c=false,d=i(new $a,{cancel:function(){c=true}}),e=K(d,"Read page from store failure");
y.contains(a,function(i){c||(i?y.read(a,function(a,i){c||d.resolve(i!==b,i)},e):d.resolve(false))},e);return d},I=function(a,b){var c=i(new $a,{cancel:function(){}}),d=K(c,"Save page to store failure"),e=function(){c.resolve(true)};if(b.c>0){var f=l(b);(p=q>=0&&q<u+f)?e():y.addOrUpdate(a,b,function(){L(b,f);H(e,d)},d)}else{L(b,0);H(e,d)}return c},H=function(a,b){y.addOrUpdate("__settings",{actualCacheSize:u,allDataLocal:m,cacheSize:q,collectionCount:o,highestSavedPage:Sa,highestSavedPageSize:hb,pageSize:s,
sourceId:v.identifier,version:r},a,b)},K=function(a){return function(){a.resolve(false)}},L=function(a,b){var c=a.c,d=a.i;if(c===0)Sa===d-s&&(o=Sa+hb);else{Sa=Math.max(Sa,d);Sa===d&&(hb=c);u=u+b;c<s&&!o&&(o=d+c)}!m&&o===Sa+hb&&(m=true)},N=function(a,b,c,d){(a=a.canceled&&b!=="end")&&b==="cancel"&&d&&d.cancel&&d.cancel();return a},P=function(a,b,c){var d=a.transition;if(c!=="destroy"){B("destroy");return true}switch(b){case "start":d("clear");break;case "end":D();break;case "clear":Ia().then(function(){a.complete()});
a.wait();break;default:return false}return true},R=function(a,b,c,d){if(!N(a,b,c,d)){var i=a.transition;if(c!=="prefetch"){c==="destroy"?b!=="cancel"&&a.cancel():c==="idle"&&B("prefetch");return true}switch(b){case "start":k[0]===a&&i("local",a.i);break;case "done":b=a.pending;b>0&&(b=b-Math.min(b,d.c));if(m||b===0||d.c<s||p)a.complete();else{a.pending=b;i("local",d.i+s)}break;default:return Q(a,b,c,d,true)}}return true},S=function(a,b,c,d){if(!N(a,b,c,d)){var i=a.transition;if(c!=="read"&&b!=="start"){c===
"destroy"?b!=="start"&&a.cancel():c!=="write"&&B("read");return true}switch(b){case "start":if(c==="idle"||c==="prefetch"){B("read");if(a.c>0){a=z(a.i,a.c,s);i("local",a.i)}else i("done",a)}break;case "done":var e,c=a.i+a.c,l=d.i+d.c,b=a.i>d.i?a.i:d.i,c=c<l?c:l;c>=b&&(e={i:b,c:c-b});if(e){e=e.i-d.i;a.d=a.d.concat(d.d.slice(e,e+(a.c-a.d.length)))}if(a.c===a.d.length||d.c<s){g.cacheReads++;if(!m&&!(M===0||p))if(k.length===0||k[0]&&k[0].c!==-1){i=new T(R,null,true,d.i+d.c,M,null,M);G(i,k)}a.complete()}else i("local",
d.i+s);break;default:return Q(a,b,c,d,false)}}return true},Q=function(a,b,c,d,i){var e=a.error,l=a.transition,f=a.wait,h;switch(b){case "end":D();break;case "local":h=J(d).then(function(b,c){a.canceled||(b?l("done",c):l("source",d))});break;case "source":h=O(d).then(function(b){if(!a.canceled){i?g.prefetches++:g.netReads++;l("save",b)}},e);break;case "save":if(c!=="write"){B("write");h=I(d.i,d).then(function(b){if(!a.canceled){if(!b&&i)a.pending=0;l("done",d)}B("idle")})}break;default:return false}h&&
(a.canceled?h.cancel():a.s===b&&f(h));return true};y.read("__settings",function(a,b){if(e(b)){var c=b.version;if(!c||c.indexOf("1.")!==0)F("Unsupported cache store version "+c)();else if(s!==b.pageSize||v.identifier!==b.sourceId)Ia().then(function(){B("idle")},F("Unable to clear store during initialization"));else{u=b.actualCacheSize;m=b.allDataLocal;q=b.cacheSize;o=b.collectionCount;Sa=b.highestSavedPage;hb=b.highestSavedPageSize;r=c;B("idle")}}else H(function(){B("idle")},F("Unable to write settings during initialization."))},
F("Unable to read settings from store."));return t};c.createDataCache=function(a){var c=a.pageSize;if(c!==b){if(typeof c!=="number")throw{message:"'pageSize' must be a number."};if(isNaN(c)||c<=0||!isFinite(c))throw{message:"'pageSize' must be greater than zero."};}Nb(a.cacheSize,"cacheSize");Nb(a.prefetchSize,"prefetchSize");if(!e(a.name))throw{message:"Undefined or null name",options:a};if(!e(a.source))throw{message:"Undefined source",options:a};return new hb(a)}})(this);
var JAYLINT=function(){function a(){return this}function b(){}function c(a){return bc[a]||"\\u"+("0000"+a.charCodeAt().toString(16)).slice(-4)}function d(a){Object.keys(a).forEach(function(b){ba[b]=a[b]})}function e(){if(!m.safe){if(m.rhino){d(ec);m.rhino=false}if(m.devel){d(ac);m.devel=false}if(m.browser){d(Rb);m.browser=false}if(m.windows){d(Vb);m.windows=false}if(m.node){d(Kb);m.node=false;Bb=true}if(m.widget){d(U);m.widget=false}}}function h(a,b,c){throw{name:"JSLintError",line:b,character:c,
message:G.scanned_a_b.supplant({a:a,b:Math.floor(b/qb.length*100)})};}function f(a,b,c,d,e,f){var j,n,b=b||g;n=b.line||0;j=b.from||0;a={id:"(error)",raw:G[a]||a,evidence:qb[n-1]||"",line:n,character:j,a:c||b.value,b:d,c:e,d:f};a.reason=a.raw.supplant(a);JAYLINT.errors.push(a);m.passfail&&h(G.stopping,n,j);Db=Db+1;Db>=m.maxerr&&h(G.too_many,n,j);return a}function j(a,b,c,d,e,h,g){return f(a,{line:b,from:c},d,e,h,g)}function n(a,b,c,d,e,g){a=f(a,b,c,d,e,g);h(G.stopping,a.line,a.character)}function u(a,
b,c,d,e,f,h){return n(a,{line:b,from:c},d,e,f,h)}function q(a){!m.white&&g.from!==a&&f("expected_a_at_b_c",g,g.value,a,g.from)}function M(a,b,c){if(a[b]!==c){f("expected_a_b",a,c,a[b]);return true}return false}function A(a,b,c){c=c||a.value;if(r===pa){m.safe&&f("adsafe_a",a,c);if(typeof pa[c]!=="string"){a.writeable=typeof ba[c]==="boolean"?ba[c]:true;a.funct=r;ob[c]=a}b==="becoming"&&(b="var")}else if(typeof r[c]==="string")if(r[c]==="undef"){m.undef||f("used_before_a",a,c);b="var"}else f("already_defined",
a,c);else{a.funct=r;a.writeable=true;E[c]=a}r[c]=b}function s(a){for(var b,c=0,a=a||0;c<=a;){(b=rb[c])||(b=rb[c]=fb.token());c=c+1}return b}function o(a){a=a||p;if(a.comments){for(var b=a.prev;b.comments===null;)b=b.prev;b.comments=b.comments?b.comments.concat(a.comments):a.comments}a.comments=null}function k(a,b){if(y){if(Ha&&g.line!==p.line){if((Ha!==y||!g.edge)&&g.from===y.at-(g.edge?m.indent:0)){for(var c=y;;){c.at=c.at-m.indent;if(c===Ha)break;c=c.was}c.open=false}Ha=null}if(y.open)if(g.edge)g.edge===
"label"?q(1):g.edge==="case"?q(y.at-m.indent):(y.mode!=="array"||g.line!==p.line)&&q(y.at);else{if(g.line!==p.line){g.from<y.at+(y.mode==="expression"?0:m.indent)&&q(y.at+m.indent);y.wrap=true}}else if(g.line!==p.line)if(g.edge)q(y.at);else{y.wrap=true;y.mode==="statement"||y.mode==="var"?q(y.at+m.indent):g.from<y.at+(y.mode==="expression"?0:m.indent)&&q(y.at+m.indent)}}switch(p.id){case "(number)":g.id==="."&&f("trailing_decimal_a");break;case "-":(g.id==="-"||g.id==="--")&&f("confusing_a");break;
case "+":(g.id==="+"||g.id==="++")&&f("confusing_a")}if(p.id==="(string)"||p.identifier)Ib=p.value;a&&g.id!==a&&(b?f("expected_a_b_from_c_d",g,a,b.id,b.line,g.value):(!g.identifier||g.value!==a)&&f("expected_a_b",g,a,g.value));la=p;p=g;g=rb.shift()||fb.token();p.id==="(end)"&&o()}function Ia(){if(m.adsafe)m.safe=true;if(m.safe){m.browser=m["continue"]=m.css=m.debug=m.devel=m.evil=m.forin=m.newcap=m.nomen=m.on=m.rhino=m.sloppy=m.sub=m.undef=m.widget=m.windows=false;delete ba.Array;delete ba.Date;delete ba.Function;
delete ba.Object;delete ba.eval;d({ADSAFE:false,lib:false})}}function va(){var a=this.id,b=Ca;g.line===p.line&&g.from===p.thru&&f("missing_space_a_b",g,p.value,g.value);Ca=true;m.white=true;(rb.length>0||g.comments)&&f("unexpected_a",this);switch(a){case "/*properties":case "/*property":case "/*members":case "/*member":a:for(Fa||(Fa={});;){if(g.id!=="(string)"&&!g.identifier)break a;Fa[g.value]=true;k();if(g.id!==",")break a;k(",")}break;case "/*jslint":for(m.safe&&f("adsafe_a",this);g.id==="(string)"||
g.identifier;){a=g.value;k();g.id!==":"&&n("expected_a_b",g,":",g.value);k(":");switch(a){case "indent":a=+g.value;(typeof a!=="number"||!isFinite(a)||a<0||Math.floor(a)!==a)&&n("expected_small_a");m.indent=a;break;case "maxerr":a=+g.value;(typeof a!=="number"||!isFinite(a)||a<=0||Math.floor(a)!==a)&&n("expected_small_a",g);m.maxerr=a;break;case "maxlen":a=+g.value;(typeof a!=="number"||!isFinite(a)||a<0||Math.floor(a)!==a)&&n("expected_small_a");m.maxlen=a;break;default:g.id==="true"?m[a]=true:g.id===
"false"?m[a]=false:n("unexpected_a");if(a==="adsafe"){m.adsafe=m.safe=true;Ia()}else a==="safe"&&Ia()}k();g.id===","&&k(",")}e();break;case "/*globals":case "/*global":m.safe&&f("adsafe_a",this);a:for(var c;;){if(g.id!=="(string)"&&!g.identifier)break a;a=g.value;k();c=false;if(g.id===":"){k(":");switch(g.id){case "true":c=ba[a]!==false;k("true");break;case "false":k("false");break;default:n("unexpected_a")}}ba[a]=c;if(g.id!==",")break a;k(",")}break;default:n("unpexpected_a",this)}Ca=b;k("*/")}function C(a){g.edge=
!y||y.open&&(a||true)}function O(a){var b,c;if(typeof a==="number")y={at:a,open:true,was:c};else if(y){c=y;b=a==="var"||g.line!==p.line&&a!=="statement";y={at:(b||a==="control"?c.at+m.indent:c.at)+(c.wrap?m.indent:0),mode:a,open:b,was:c};a==="var"&&b&&(Ha=y)}else y={at:1,mode:"statement",open:true}}function F(a,b){if(a){if(y&&y.open){y.at=y.at-m.indent;C()}k(a,b)}if(y)y=y.was}function w(a,b){b=b||g;b.id!=="(end)"&&!m.white&&(p.line!==b.line||p.thru+1!==b.from)&&f("expected_space_a_b",b,p.value,b.value)}
function bb(a,b){a=a||p;b=b||g;b.id!=="(end)"&&(a.line!==b.line||!m.white&&a.thru+1!==b.from)&&f("expected_space_a_b",b,a.value,b.value)}function B(a,b){a=a||p;b=b||g;(!m.white||v==="styleproperty"||v==="style")&&a.thru!==b.from&&a.line===b.line&&f("unexpected_space_a_b",b,a.value,b.value)}function H(a,b){a=a||p;b=b||g;b.id!=="(end)"&&(a.line!==b.line||!m.white&&a.thru!==b.from)&&f("unexpected_space_a_b",b,a.value,b.value)}function J(a,b){if(!m.white){a=a||p;b=b||g;a.thru===b.from&&a.line===b.line&&
f("missing_space_a_b",b,a.value,b.value)}}function K(){if(g.id!==",")j("expected_a_b",p.line,p.thru,",",g.value);else{m.white||H();k(",");o();J()}}function ga(){if(g.id!==";")j("expected_a_b",p.line,p.thru,";",g.value);else{m.white||H();k(";");o();Tb[g.id]!==true&&J()}}function Pa(){if(g.value==="use strict"){xa&&f("unnecessary_use");C();k();ga();xa=true;m.newcap=false;m.undef=false;return true}return false}function ea(a,b){if(a===b)return true;if(Array.isArray(a)){if(Array.isArray(b)&&a.length===
b.length){var c;for(c=0;c<a.length;c=c+1)if(!ea(a[c],b[c]))return false;return true}return false}if(Array.isArray(b))return false;if(a.arity===b.arity&&a.value===b.value)switch(a.arity){case "prefix":case "suffix":case void 0:return a.id===b.id&&ea(a.first,b.first);case "infix":return ea(a.first,b.first)&&ea(a.second,b.second);case "ternary":return ea(a.first,b.first)&&ea(a.second,b.second)&&ea(a.third,b.third);case "function":case "regexp":break;default:return true}else{if(a.id==="."&&b.id==="["&&
b.arity==="infix")return a.second.value===b.second.value&&b.second.id==="(string)";if(a.id==="["&&a.arity==="infix"&&b.id===".")return a.second.value===b.second.value&&a.second.id==="(string)"}return false}function t(a,b){var c;g.id==="(end)"&&n("unexpected_a",p,g.id);k();m.safe&&E[p.value]&&E[p.value]===ob[p.value]&&g.id!=="("&&g.id!=="."&&f("adsafe",p);if(b){Ib="anonymous";r["(verb)"]=p.value}if(b===true&&p.fud)c=p.fud();else{if(p.nud)c=p.nud();else{if(g.id==="(number)"&&p.id==="."){f("leading_decimal_a",
p,g.value);k();return p}n("expected_identifier_a",p,p.id)}for(;a<g.lbp;){k();p.led?c=p.led(c):n("expected_operator_a",p,p.id)}}return c}function Qa(a,b){var c=ma[a];if(!c||typeof c!=="object")ma[a]=c={id:a,lbp:b,value:a};return c}function R(a){return Qa(a,0)}function Ra(a){a.postscript=true;return a}function Eb(a){var b=Qa(a,0);b.from=1;b.thru=1;b.line=0;b.edge=true;a.value=a;return Ra(b)}function Z(a,b){var c=R(a);c.identifier=c.reserved=true;c.fud=b;return c}function ha(a,b){Z(a,b).labeled=true}
function za(a,b){Z(a,b).disrupt=true}function Pb(a){var b=a.id.charAt(0);if(b>="a"&&b<="z"||b>="A"&&b<="Z")a.identifier=a.reserved=true;return a}function V(a,b,c){var d=Qa(a,150);Pb(d);d.nud=typeof b==="function"?b:function(){a==="typeof"?w():H();this.first=t(150);this.arity="prefix";if(this.id==="++"||this.id==="--")m.plusplus?(!this.first.identifier||this.first.reserved)&&this.first.id!=="."&&this.first.id!=="["&&f("bad_operand",this):f("unexpected_a",this);this.type=c;return this};return d}function Aa(a,
b,c){a=R(a);a.arity=a.type=b;if(c)a.nud=c;return a}function ib(a){return(a=a.identifier&&E[a.value]||a)&&a.type}function N(a,b,c){var d="",e,h,g;if(typeof a!=="string"){h=a.identifier&&E[a.value]||a;a=h.type}g=b.identifier&&E[b.value]||b;e=g.type;if(a)e?a===e?d=a:m.type||f("type_inconsistency_a_b",c||b,a,e):g.type=d=a;else if(e){if(h)h.type=e;d=e}return d}function x(a,b){var c=R(a);c.identifier=c.reserved=true;if(typeof b==="function")c.nud=b;return c}function Ta(b,c,d){b=x(b);b.type=c;b.value=d;
b.nud=a;return b}function jb(a,b){return x(a,function(){typeof b==="function"&&b(this);return this})}function P(a,b,c,d,e){a=Qa(a,b);Pb(a);a.led=function(a){this.arity="infix";if(!e){J(la,p);J()}!m.bitwise&&this.bitwise&&f("unexpected_a",this);if(typeof c==="function")return c(a,this);this.first=a;this.second=t(b);return this};if(d)a.type=d;return a}function wa(a,b){a.assign&&f(b||G.conditional_assignment,a);return a}function qa(a,b){switch(a.id){case "[":case "-":a.arity!=="infix"&&f(b||G.weird_condition,
a);break;case "false":case "function":case "Infinity":case "NaN":case "null":case "true":case "undefined":case "void":case "(number)":case "(regexp)":case "(string)":case "{":f(b||G.weird_condition,a);break;case "(":a.first.id==="."&&cc[a.first.second.value]===true&&f(b||G.weird_condition,a)}return a}function Ua(a){switch(a.arity){case "prefix":switch(a.id){case "{":case "[":f("unexpected_a",a);break;case "!":f("confusing_a",a)}break;case "function":case "regexp":f("unexpected_a",a);break;default:a.id===
"NaN"&&f("isnan",a)}return a}function ra(a,b){return P(a,100,function(a,c){Ua(a);b&&!m.eqeq&&f("expected_a_b",c,b,c.id);var d=t(100);(ea(a,d)||(a.id==="(string)"||a.id==="(number)")&&(d.id==="(string)"||d.id==="(number)"))&&f("weird_relation",c);c.first=a;c.second=Ua(d);N(a,c.second,c);return c},"boolean")}function ia(a,b){var c=P(a,20,function(a,b){var c;b.first=a;if(a.identifier)E[a.value]?E[a.value].writeable===false&&f("read_only",a):n("read_only");else if(m.safe){c=a;do{typeof ba[c.value]===
"boolean"&&f("adsafe",c);c=c.first}while(c)}a===ma["function"]&&f("identifier_function",p);if(a.id==="."||a.id==="["){(!a.first||a.first.value==="arguments")&&f("bad_assignment",b);b.second=t(19);b.id==="="&&ea(b.first,b.second)&&f("weird_assignment",b)}else if(a.identifier&&!a.reserved){r[a.value]==="exception"&&f("assign_exception",a);b.second=t(19);b.id==="="&&ea(b.first,b.second)&&f("weird_assignment",b);if(b.type){N(a,b);N(b,b.second,b)}else N(a,b.second,b)}return b});c.assign=true;if(b){if(ma[b].type)c.type=
ma[b].type;if(ma[b].bitwise)c.bitwise=true}return c}function Va(a,b){var c=P(a,b,"number");c.bitwise=true;return c}function Fb(a){a=Qa(a,150);a.led=function(a){H(la,p);m.plusplus?(!a.identifier||a.reserved)&&a.id!=="."&&a.id!=="["&&f("bad_operand",this):f("unexpected_a",this);this.first=a;this.arity="suffix";return this};return a}function Ja(){if(g.identifier){k();m.safe&&mb[p.value]?f("adsafe_a",p):p.reserved&&!m.es5&&f("expected_identifier_a_reserved",p);return p.value}}function sa(){var a,b=E;
if(g.id===";"){f("unexpected_a");ga()}else{if(g.identifier&&!g.reserved&&s().id===":"){C("label");a=g;k();o();k(":");o();E=Object.create(b);A(a,"label");g.labeled!==true?f("label_a_b",g,a.value,g.value):gb.test(a.value+":")?f("url",a):r===pa&&n("unexpected_a",p);g.label=a}C();O("statement");if(a=t(0,true))if(a.arity==="statement")a.id==="switch"||a.block&&a.id!=="do"?J():ga();else{a.id==="("?a.first.id==="new"&&f("bad_new"):!a.assign&&a.id!=="delete"&&a.id!=="++"&&a.id!=="--"&&f("assignment_function_expression",
p);ga()}F();E=b;return a}}function Ka(){for(var a=[],b,c;g.postscript!==true;)if(g.id===";"){f("unexpected_a",g);ga()}else{if(g.value==="use strict"){(!Bb||r!==pa||a.length>0)&&f("function_strict");Pa()}if(b){f("unreachable_a_b",g,g.value,b.value);b=null}if(c=sa()){a.push(c);if(c.disrupt){b=c;a.disrupt=true}}}return a}function na(a){var b,c=g,d=Ya,e=E,h=xa;Ya=a;E=Object.create(E);J();if(g.id==="{"){k("{");O();!a&&!Pa()&&!h&&!m.sloppy&&r["(context)"]===pa&&f("missing_use_strict");b=Ka();xa=h;F("}",
c);o()}else if(a){f("expected_a_b",g,"{",g.value);b=[sa()];b.disrupt=b[0].disrupt}else n("expected_a_b",g,"{",g.value);r["(verb)"]=null;E=e;Ya=d;a&&b.length===0&&f("empty_block");return b}function Ba(a){Fa&&typeof Fa[a]!=="boolean"&&f("unexpected_property_a",p,a);Ea[a]=typeof Ea[a]==="number"?Ea[a]+1:1}function fa(){var a=Ja(true);if(!a)if(g.id==="(string)"){a=g.value;m.safe&&(mb[a]?f("adsafe_a"):(a.charAt(0)==="_"||a.charAt(a.length-1)==="_")&&f("dangling_a"));k()}else if(g.id==="(number)"){a=g.value.toString();
k()}return a}function I(a){var b=0;if(a)if(Array.isArray(a))a.forEach(function(a){b=b+I(a)});else switch(a.arity){case "statement":switch(a.id){case "if":b=b+(I(a.first)+I(a.block)+I(a["else"])+1);break;case "while":case "do":a.first.id!=="true"&&a.first.value!==1&&(b=b+1);b=b+(I(a.first)+I(a.block));break;case "for":a.second!==void 0&&a.second.id!=="true"&&a.second.value!==1&&(b=b+1);b=b+(I(a.first)+I(a.second)+I(a.third)+I(a.block));break;case "switch":b=b+(I(a.first)+I(a.second)+a.second.length);
a.second[a.second.length-1].id==="default"&&(b=b-1);break;case "try":a.second&&(b=b+1);a.third&&(b=b+1);b=b+(I(a.first)+I(a.second)+I(a.third)+I(a.block))}break;case "prefix":b=b+I(a.first);break;case "case":case "infix":b=b+(I(a.first)+I(a.second));if(a.id==="&&"||a.id==="||")b=b+1;break;case "ternary":b=b+(I(a.first)+I(a.second)+I(a.third))}return b}function X(a,b){var d=r,e=m,f=Fa,h=E;r={"(name)":b||"'"+(Ib||"").replace(Mb,c)+"'","(line)":g.line,"(context)":d,"(breakage)":0,"(loopage)":0,"(scope)":E,
"(token)":a};Fa=f&&Object.create(f);m=Object.create(e);E=Object.create(h);wb.push(r);(a.name=b)&&A(a,"function",b);a.writeable=false;var j=r,n;a:{var u=g,q=[];k("(");O();o();B();if(g.id===")"){B();F(")",u);o();n=void 0}else for(;;){C();Ja();q.push(p);A(p,m.unparam?"parameter":"unparam");if(g.id===",")K();else{B();F(")",u);o();n=q;break a}}}a.first=j["(params)"]=n;a.type="function";w();a.block=na(false);r["(complexity)"]=I(a.block)+1;r=d;m=e;Fa=f;E=h}function ub(){function a(){var b=g,c={};k("{");
if(g.id!=="}")for(;g.id!=="(end)";){for(;g.id===",";){f("unexpected_a",g);K()}g.id!=="(string)"&&f("expected_string_a");c[g.value]===true?f("duplicate_a"):g.value==="__proto__"?f("dangling_a"):c[g.value]=true;k();k(":");ub();if(g.id!==",")break;K();if(g.id==="}"){f("unexpected_a",p);break}}k("}",b)}function b(){var a=g;k("[");if(g.id!=="]")for(;g.id!=="(end)";){for(;g.id===",";){f("unexpected_a",g);K()}ub();if(g.id!==",")break;K();if(g.id==="]"){f("unexpected_a",p);break}}k("]",a)}switch(g.id){case "{":a();
break;case "[":b();break;case "true":case "false":case "null":case "(number)":case "(string)":k();break;case "-":k("-");H();k("(number)");break;default:n("unexpected_a")}}function tb(){if(g.identifier){k();return true}}function aa(){if(g.id==="-"){k("-");H()}if(g.id==="(number)"){k("(number)");return true}}function ta(){if(g.id==="(string)"){k();return true}}function oa(){var a,b,c,d;if(g.identifier){d=g.value;if(d==="rgb"||d==="rgba"){k();c=g;k("(");for(a=0;a<3;a=a+1){a&&K();b=g.value;if(g.id!==
"(string)"||b<0){f("expected_positive_a",g);k()}else{k();if(g.id==="%"){k("%");b>100&&f("expected_percent_a",p,b)}else b>255&&f("expected_small_a",p,b)}}if(d==="rgba"){K();b=+g.value;(g.id!=="(string)"||b<0||b>1)&&f("expected_fraction_a",g);k();if(g.id==="%"){f("unexpected_a");k("%")}}k(")",c);return true}if(Zb[g.value]===true){k();return true}}else if(g.id==="(color)"){k();return true}return false}function D(){if(g.id==="-"){k("-");H()}if(g.id==="(number)"){k();if(g.id!=="(string)"&&zb[g.value]===
true){H();k()}else+p.value!==0&&f("expected_linear_a");return true}return false}function W(){if(g.identifier)switch(g.value){case "thin":case "medium":case "thick":k();return true}else return D()}function ja(){if(g.identifier){if(g.value==="auto"){k();return true}}else return D()}function Wa(){var a,b;if(g.identifier&&g.value==="url"){g=fb.range("(",")");b=g.value;a=b.charAt(0);if(a==='"'||a==="'")if(b.slice(-1)!==a)f("bad_url");else{b=b.slice(1,-1);b.indexOf(a)>=0&&f("bad_url")}b||f("missing_url");
m.safe&&Nb.test(b)&&n("adsafe_a",g,b);ca.push(b);k();return true}return false}function vb(a){var b=0,c,d,e,f=0;switch(typeof a){case "function":return a();case "string":if(g.identifier&&g.value===a){k();return true}return false}for(;;){if(b>=a.length)return false;e=a[b];b=b+1;if(typeof e==="boolean")break;else if(typeof e==="number"){c=e;e=a[b];b=b+1}else c=1;for(d=false;c>0;)if(vb(e)){d=true;c=c-1}else break;if(d)return true}f=b;for(c=[];;){e=false;for(b=f;b<a.length;b=b+1)if(!c[b]&&vb(Ma[a[b]])){e=
d=true;c[b]=true;break}if(!e)return d}}function Gb(){for(var a;;){if(g.id==="}"||g.id==="(end)"||da&&g.id===da)break;for(;g.id===";";){f("unexpected_a");ga()}for(a=void 0;g.id==="*"||g.id==="#"||g.value==="_";){m.css||f("unexpected_a");k()}if(g.id==="-"){m.css||f("unexpected_a");k("-");g.identifier||f("expected_nonstandard_style_attribute");k();a=xb}else{if(g.identifier)if(Object.prototype.hasOwnProperty.call(Ma,g.value))a=Ma[g.value];else{a=xb;m.css||f("unrecognized_style_attribute_a")}else f("expected_style_attribute");
k()}k(":");if(g.identifier&&g.value==="inherit")k();else if(!vb(a)){f("unexpected_a");k()}if(g.id==="!"){k("!");H();g.identifier&&g.value==="important"?k():f("expected_a_b",g,"important",g.value)}g.id==="}"||g.id===da?f("expected_a_b",g,";",g.value):ga()}}function cb(){if(g.identifier){Object.prototype.hasOwnProperty.call(Ab,m.cap?g.value.toLowerCase():g.value)||f("expected_tagname_a");k()}else switch(g.id){case ">":case "+":k();cb();break;case ":":k(":");switch(g.value){case "active":case "after":case "before":case "checked":case "disabled":case "empty":case "enabled":case "first-child":case "first-letter":case "first-line":case "first-of-type":case "focus":case "hover":case "last-child":case "last-of-type":case "link":case "only-of-type":case "root":case "target":case "visited":k();
break;case "lang":k();k("(");g.identifier||f("expected_lang_a");k(")");break;case "nth-child":case "nth-last-child":case "nth-last-of-type":case "nth-of-type":k();k("(");if(g.id==="(number)"){k();if(g.value==="n"&&g.identifier){H();k();if(g.id==="+"){H();k("+");H();k("(number)")}}}else g.identifier&&(g.value==="odd"||g.value==="even")?k():f("unexpected_a");k(")");break;case "not":k();k("(");g.id===":"&&s(0).value==="not"&&f("not");cb();k(")");break;default:f("expected_pseudo_a")}break;case "#":k("#");
g.identifier||f("expected_id_a");k();break;case "*":k("*");break;case ".":k(".");g.identifier||f("expected_class_a");k();break;case "[":k("[");g.identifier||f("expected_attribute_a");k();if(g.id==="="||g.value==="~="||g.value==="$="||g.value==="|="||g.id==="*="||g.id==="^="){k();g.id!=="(string)"&&f("expected_string_a");k()}k("]");break;default:n("expected_selector_a")}}function Hb(){for(;g.id!=="</"&&g.id!=="(end)";){a:for(g.id==="{"&&f("expected_style_pattern");;){cb();if(g.id==="</"||g.id==="{"||
g.id==="(end)")break a;g.id===","&&K()}v="styleproperty";if(g.id===";")ga();else{k("{");Gb();v="style";k("}")}}}function db(){for(;g.id==="@";){s();k("@");if(g.identifier)switch(g.value){case "import":k();if(!Wa()){f("expected_a_b",g,"url",g.value);k()}ga();break;case "media":for(k();;){(!g.identifier||Sb[g.value]===true)&&n("expected_media_a");k();if(g.id!==",")break;K()}k("{");Hb();k("}");break;default:f("expected_at_a")}else f("expected_at_a")}Hb()}var ka,eb,La,S,Ib,kb,Qb={"<":true,"<=":true,"==":true,
"===":true,"!==":true,"!=":true,">":true,">=":true,"+":true,"-":true,"*":true,"/":true,"%":true},mb={arguments:true,callee:true,caller:true,constructor:true,eval:true,prototype:true,stack:true,unwatch:true,valueOf:true,watch:true},Jb,Rb={clearInterval:false,clearTimeout:false,document:false,event:false,frames:false,history:false,Image:false,localStorage:false,location:false,name:false,navigator:false,Option:false,parent:false,screen:false,sessionStorage:false,setInterval:false,setTimeout:false,Storage:false,
window:false,XMLHttpRequest:false},G={a_label:"'{a}' is a statement label.",a_not_allowed:"'{a}' is not allowed.",a_not_defined:"'{a}' is not defined.",a_scope:"'{a}' used out of scope.",adsafe:"ADsafe violation.",adsafe_a:"ADsafe violation: '{a}'.",adsafe_autocomplete:"ADsafe autocomplete violation.",adsafe_bad_id:"ADSAFE violation: bad id.",adsafe_div:"ADsafe violation: Wrap the widget in a div.",adsafe_fragment:"ADSAFE: Use the fragment option.",adsafe_go:"ADsafe violation: Misformed ADSAFE.go.",
adsafe_html:"Currently, ADsafe does not operate on whole HTML documents. It operates on <div> fragments and .js files.",adsafe_id:"ADsafe violation: id does not match.",adsafe_id_go:"ADsafe violation: Missing ADSAFE.id or ADSAFE.go.",adsafe_lib:"ADsafe lib violation.",adsafe_lib_second:"ADsafe: The second argument to lib must be a function.",adsafe_missing_id:"ADSAFE violation: missing ID_.",adsafe_name_a:"ADsafe name violation: '{a}'.",adsafe_placement:"ADsafe script placement violation.",adsafe_prefix_a:"ADsafe violation: An id must have a '{a}' prefix",
adsafe_script:"ADsafe script violation.",adsafe_source:"ADsafe unapproved script source.",adsafe_subscript_a:"ADsafe subscript '{a}'.",adsafe_tag:"ADsafe violation: Disallowed tag '{a}'.",already_defined:"'{a}' is already defined.",and:"The '&&' subexpression should be wrapped in parens.",assign_exception:"Do not assign to the exception parameter.",assignment_function_expression:"Expected an assignment or function call and instead saw an expression.",attribute_case_a:"Attribute '{a}' not all lower case.",
avoid_a:"Avoid '{a}'.",bad_assignment:"Bad assignment.",bad_color_a:"Bad hex color '{a}'.",bad_constructor:"Bad constructor.",bad_entity:"Bad entity.",bad_html:"Bad HTML string",bad_id_a:"Bad id: '{a}'.",bad_in_a:"Bad for in variable '{a}'.",bad_invocation:"Bad invocation.",bad_name_a:"Bad name: '{a}'.",bad_new:"Do not use 'new' for side effects.",bad_number:"Bad number '{a}'.",bad_operand:"Bad operand.",bad_type:"Bad type.",bad_url:"Bad url string.",bad_wrap:"Do not wrap function literals in parens unless they are to be immediately invoked.",
combine_var:"Combine this with the previous 'var' statement.",conditional_assignment:"Expected a conditional expression and instead saw an assignment.",confusing_a:"Confusing use of '{a}'.",confusing_regexp:"Confusing regular expression.",constructor_name_a:"A constructor name '{a}' should start with an uppercase letter.",control_a:"Unexpected control character '{a}'.",css:"A css file should begin with @charset 'UTF-8';",dangling_a:"Unexpected dangling '_' in '{a}'.",dangerous_comment:"Dangerous comment.",
deleted:"Only properties should be deleted.",duplicate_a:"Duplicate '{a}'.",empty_block:"Empty block.",empty_case:"Empty case.",empty_class:"Empty class.",es5:"This is an ES5 feature.",evil:"eval is evil.",expected_a:"Expected '{a}'.",expected_a_b:"Expected '{a}' and instead saw '{b}'.",expected_a_b_from_c_d:"Expected '{a}' to match '{b}' from line {c} and instead saw '{d}'.",expected_at_a:"Expected an at-rule, and instead saw @{a}.",expected_a_at_b_c:"Expected '{a}' at column {b}, not column {c}.",
expected_attribute_a:"Expected an attribute, and instead saw [{a}].",expected_attribute_value_a:"Expected an attribute value and instead saw '{a}'.",expected_class_a:"Expected a class, and instead saw .{a}.",expected_fraction_a:"Expected a number between 0 and 1 and instead saw '{a}'",expected_id_a:"Expected an id, and instead saw #{a}.",expected_identifier_a:"Expected an identifier and instead saw '{a}'.",expected_identifier_a_reserved:"Expected an identifier and instead saw '{a}' (a reserved word).",
expected_linear_a:"Expected a linear unit and instead saw '{a}'.",expected_lang_a:"Expected a lang code, and instead saw :{a}.",expected_media_a:"Expected a CSS media type, and instead saw '{a}'.",expected_name_a:"Expected a name and instead saw '{a}'.",expected_nonstandard_style_attribute:"Expected a non-standard style attribute and instead saw '{a}'.",expected_number_a:"Expected a number and instead saw '{a}'.",expected_operator_a:"Expected an operator and instead saw '{a}'.",expected_percent_a:"Expected a percentage and instead saw '{a}'",
expected_positive_a:"Expected a positive number and instead saw '{a}'",expected_pseudo_a:"Expected a pseudo, and instead saw :{a}.",expected_selector_a:"Expected a CSS selector, and instead saw {a}.",expected_small_a:"Expected a small number and instead saw '{a}'",expected_space_a_b:"Expected exactly one space between '{a}' and '{b}'.",expected_string_a:"Expected a string and instead saw {a}.",expected_style_attribute:"Excepted a style attribute, and instead saw '{a}'.",expected_style_pattern:"Expected a style pattern, and instead saw '{a}'.",
expected_tagname_a:"Expected a tagName, and instead saw {a}.",for_if:"The body of a for in should be wrapped in an if statement to filter unwanted properties from the prototype.",function_block:"Function statements should not be placed in blocks. Use a function expression or move the statement to the top of the outer function.",function_eval:"The Function constructor is eval.",function_loop:"Don't make functions within a loop.",function_statement:"Function statements are not invocable. Wrap the whole function invocation in parens.",
function_strict:"Use the function form of 'use strict'.",html_confusion_a:"HTML confusion in regular expression '<{a}'.",html_handlers:"Avoid HTML event handlers.",identifier_function:"Expected an identifier in an assignment and instead saw a function invocation.",implied_evil:"Implied eval is evil. Pass a function instead of a string.",infix_in:"Unexpected 'in'. Compare with undefined, or use the hasOwnProperty method instead.",insecure_a:"Insecure '{a}'.",isNaN:"Use the isNaN function to compare with NaN.",
label_a_b:"Label '{a}' on '{b}' statement.",lang:"lang is deprecated.",leading_decimal_a:"A leading decimal point can be confused with a dot: '.{a}'.",missing_a:"Missing '{a}'.",missing_a_after_b:"Missing '{a}' after '{b}'.",missing_option:"Missing option value.",missing_property:"Missing property name.",missing_space_a_b:"Missing space between '{a}' and '{b}'.",missing_url:"Missing url.",missing_use_strict:"Missing 'use strict' statement.",mixed:"Mixed spaces and tabs.",move_invocation:"Move the invocation into the parens that contain the function.",
move_var:"Move 'var' declarations to the top of the function.",name_function:"Missing name in function statement.",nested_comment:"Nested comment.",not:"Nested not.",not_a_constructor:"Do not use {a} as a constructor.",not_a_defined:"'{a}' has not been fully defined yet.",not_a_function:"'{a}' is not a function.",not_a_label:"'{a}' is not a label.",not_a_scope:"'{a}' is out of scope.",not_greater:"'{a}' should not be greater than '{b}'.",parameter_a_get_b:"Unexpected parameter '{a}' in get {b} function.",
parameter_set_a:"Expected parameter (value) in set {a} function.",radix:"Missing radix parameter.",read_only:"Read only.",redefinition_a:"Redefinition of '{a}'.",reserved_a:"Reserved name '{a}'.",scanned_a_b:"{a} ({b}% scanned).",slash_equal:"A regular expression literal can be confused with '/='.",statement_block:"Expected to see a statement and instead saw a block.",stopping:"Stopping. ",strange_loop:"Strange loop.",strict:"Strict violation.",subscript:"['{a}'] is better written in dot notation.",
tag_a_in_b:"A '<{a}>' must be within '<{b}>'.",too_long:"Line too long.",too_many:"Too many errors.",trailing_decimal_a:"A trailing decimal point can be confused with a dot: '.{a}'.",type:"type is unnecessary.",type_inconsistency_a_b:"Type inconsistency: {a} and {b}.",unclosed:"Unclosed string.",unclosed_comment:"Unclosed comment.",unclosed_regexp:"Unclosed regular expression.",unescaped_a:"Unescaped '{a}'.",unexpected_a:"Unexpected '{a}'.",unexpected_char_a_b:"Unexpected character '{a}' in {b}.",
unexpected_comment:"Unexpected comment.",unexpected_property_a:"Unexpected /*property*/ '{a}'.",unexpected_space_a_b:"Unexpected space between '{a}' and '{b}'.",unnecessary_initialize:"It is not necessary to initialize '{a}' to 'undefined'.",unnecessary_use:"Unnecessary 'use strict'.",unreachable_a_b:"Unreachable '{a}' after '{b}'.",unrecognized_style_attribute_a:"Unrecognized style attribute '{a}'.",unrecognized_tag_a:"Unrecognized tag '<{a}>'.",unsafe:"Unsafe character.",url:"JavaScript URL.",use_array:"Use the array literal notation [].",
use_braces:"Spaces are hard to count. Use {{a}}.",use_charAt:"Use the charAt method.",use_object:"Use the object literal notation {}.",use_or:"Use the || operator.",use_param:"Use a named parameter.",used_before_a:"'{a}' was used before it was defined.",var_a_not:"Variable {a} was not declared correctly.",weird_assignment:"Weird assignment.",weird_condition:"Weird condition.",weird_new:"Weird construction. Delete 'new'.",weird_program:"Weird program.",weird_relation:"Weird relation.",weird_ternary:"Weird ternary.",
wrap_immediate:"Wrap an immediate function invocation in parentheses to assist the reader in understanding that the expression is the result of a function, and not the function itself.",wrap_regexp:"Wrap the /regexp/ literal in parens to disambiguate the slash operator.",write_is_wrong:"document.write can be a form of eval."},Ca,Ma,xb,Zb={aliceblue:true,antiquewhite:true,aqua:true,aquamarine:true,azure:true,beige:true,bisque:true,black:true,blanchedalmond:true,blue:true,blueviolet:true,brown:true,
burlywood:true,cadetblue:true,chartreuse:true,chocolate:true,coral:true,cornflowerblue:true,cornsilk:true,crimson:true,cyan:true,darkblue:true,darkcyan:true,darkgoldenrod:true,darkgray:true,darkgreen:true,darkkhaki:true,darkmagenta:true,darkolivegreen:true,darkorange:true,darkorchid:true,darkred:true,darksalmon:true,darkseagreen:true,darkslateblue:true,darkslategray:true,darkturquoise:true,darkviolet:true,deeppink:true,deepskyblue:true,dimgray:true,dodgerblue:true,firebrick:true,floralwhite:true,
forestgreen:true,fuchsia:true,gainsboro:true,ghostwhite:true,gold:true,goldenrod:true,gray:true,green:true,greenyellow:true,honeydew:true,hotpink:true,indianred:true,indigo:true,ivory:true,khaki:true,lavender:true,lavenderblush:true,lawngreen:true,lemonchiffon:true,lightblue:true,lightcoral:true,lightcyan:true,lightgoldenrodyellow:true,lightgreen:true,lightpink:true,lightsalmon:true,lightseagreen:true,lightskyblue:true,lightslategray:true,lightsteelblue:true,lightyellow:true,lime:true,limegreen:true,
linen:true,magenta:true,maroon:true,mediumaquamarine:true,mediumblue:true,mediumorchid:true,mediumpurple:true,mediumseagreen:true,mediumslateblue:true,mediumspringgreen:true,mediumturquoise:true,mediumvioletred:true,midnightblue:true,mintcream:true,mistyrose:true,moccasin:true,navajowhite:true,navy:true,oldlace:true,olive:true,olivedrab:true,orange:true,orangered:true,orchid:true,palegoldenrod:true,palegreen:true,paleturquoise:true,palevioletred:true,papayawhip:true,peachpuff:true,peru:true,pink:true,
plum:true,powderblue:true,purple:true,red:true,rosybrown:true,royalblue:true,saddlebrown:true,salmon:true,sandybrown:true,seagreen:true,seashell:true,sienna:true,silver:true,skyblue:true,slateblue:true,slategray:true,snow:true,springgreen:true,steelblue:true,tan:true,teal:true,thistle:true,tomato:true,turquoise:true,violet:true,wheat:true,white:true,whitesmoke:true,yellow:true,yellowgreen:true,activeborder:true,activecaption:true,appworkspace:true,background:true,buttonface:true,buttonhighlight:true,
buttonshadow:true,buttontext:true,captiontext:true,graytext:true,highlight:true,highlighttext:true,inactiveborder:true,inactivecaption:true,inactivecaptiontext:true,infobackground:true,infotext:true,menu:true,menutext:true,scrollbar:true,threeddarkshadow:true,threedface:true,threedhighlight:true,threedlightshadow:true,threedshadow:true,window:true,windowframe:true,windowtext:true},Xa,yb,zb={"%":true,cm:true,em:true,ex:true,"in":true,mm:true,pc:true,pt:true,px:true},Sb,lb,$b={b:"\u0008",t:"\t",n:"\n",
f:"\u000c",r:"\r",'"':'"',"/":"/","\\":"\\"},ac={alert:false,confirm:false,console:false,Debug:false,opera:false,prompt:false},bc={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r","'":"\\'",'"':'\\"',"/":"\\/","\\":"\\\\"},r,nb=["closure","exception","global","label","outer","undef","unused","var"],wb,pa,ob,Ab={a:{},abbr:{},acronym:{},address:{},applet:{},area:{empty:true,parent:" map "},article:{},aside:{},audio:{},b:{},base:{empty:true,parent:" head "},bdo:{},big:{},blockquote:{},
body:{parent:" html noframes "},br:{empty:true},button:{},canvas:{parent:" body p div th td "},caption:{parent:" table "},center:{},cite:{},code:{},col:{empty:true,parent:" table colgroup "},colgroup:{parent:" table "},command:{parent:" menu "},datalist:{},dd:{parent:" dl "},del:{},details:{},dialog:{},dfn:{},dir:{},div:{},dl:{},dt:{parent:" dl "},em:{},embed:{},fieldset:{},figure:{},font:{},footer:{},form:{},frame:{empty:true,parent:" frameset "},frameset:{parent:" html frameset "},h1:{},h2:{},h3:{},
h4:{},h5:{},h6:{},head:{parent:" html "},header:{},hgroup:{},hr:{empty:true},"hta:application":{empty:true,parent:" head "},html:{parent:"*"},i:{},iframe:{},img:{empty:true},input:{empty:true},ins:{},kbd:{},keygen:{},label:{},legend:{parent:" details fieldset figure "},li:{parent:" dir menu ol ul "},link:{empty:true,parent:" head "},map:{},mark:{},menu:{},meta:{empty:true,parent:" head noframes noscript "},meter:{},nav:{},noframes:{parent:" html body "},noscript:{parent:" body head noframes "},object:{},
ol:{},optgroup:{parent:" select "},option:{parent:" optgroup select "},output:{},p:{},param:{empty:true,parent:" applet object "},pre:{},progress:{},q:{},rp:{},rt:{},ruby:{},samp:{},script:{empty:true,parent:" body div frame head iframe p pre span "},section:{},select:{},small:{},span:{},source:{},strong:{},style:{parent:" head ",empty:true},sub:{},sup:{},table:{},tbody:{parent:" table "},td:{parent:" tr "},textarea:{},tfoot:{parent:" table "},th:{parent:" tr "},thead:{parent:" table "},time:{},title:{parent:" head "},
tr:{parent:" table tbody thead tfoot "},tt:{},u:{},ul:{},"var":{},video:{}},pb,Ya,y,L,Da,fb,qb,rb,Ea,Kb={Buffer:false,clearInterval:false,clearTimeout:false,console:false,exports:false,global:false,module:false,process:false,querystring:false,require:false,setInterval:false,setTimeout:false,__dirname:false,__filename:false},Bb,cc={indexOf:true,lastIndexOf:true,search:true},g,Na,m,ba,Lb,la,Fa,dc={g:true,i:true,m:true},ec={defineClass:false,deserialize:false,gc:false,help:false,load:false,loadClass:false,
print:false,quit:false,readFile:false,readUrl:false,runCommand:false,seal:false,serialize:false,spawn:false,sync:false,toint32:false,version:false},E,Tb={";":true,'"':true,"'":true,")":true},Cb,Q,Ub={Array:false,Boolean:false,Date:false,decodeURI:false,decodeURIComponent:false,encodeURI:false,encodeURIComponent:false,Error:false,eval:false,EvalError:false,Function:false,isFinite:false,isNaN:false,JSON:false,Math:false,Number:false,Object:false,parseInt:false,parseFloat:false,RangeError:false,ReferenceError:false,
RegExp:false,String:false,SyntaxError:false,TypeError:false,URIError:false},Ga={E:true,LN2:true,LN10:true,LOG2E:true,LOG10E:true,MAX_VALUE:true,MIN_VALUE:true,NEGATIVE_INFINITY:true,PI:true,POSITIVE_INFINITY:true,SQRT1_2:true,SQRT2:true},xa,ma={},sb,p,ca,Ha,Db,U={alert:true,animator:true,appleScript:true,beep:true,bytesToUIString:true,Canvas:true,chooseColor:true,chooseFile:true,chooseFolder:true,closeWidget:true,COM:true,convertPathToHFS:true,convertPathToPlatform:true,CustomAnimation:true,escape:true,
FadeAnimation:true,filesystem:true,Flash:true,focusWidget:true,form:true,FormField:true,Frame:true,HotKey:true,Image:true,include:true,isApplicationRunning:true,iTunes:true,konfabulatorVersion:true,log:true,md5:true,MenuItem:true,MoveAnimation:true,openURL:true,play:true,Point:true,popupMenu:true,preferenceGroups:true,preferences:true,print:true,prompt:true,random:true,Rectangle:true,reloadWidget:true,ResizeAnimation:true,resolvePath:true,resumeUpdates:true,RotateAnimation:true,runCommand:true,runCommandInBg:true,
saveAs:true,savePreferences:true,screen:true,ScrollBar:true,showWidgetPreferences:true,sleep:true,speak:true,Style:true,suppressUpdates:true,system:true,tellWidget:true,Text:true,TextArea:true,Timer:true,unescape:true,updateNow:true,URL:true,Web:true,widget:true,Window:true,XMLDOM:true,XMLHttpRequest:true,yahooCheckLogin:true,yahooLogin:true,yahooLogout:true},Vb={ActiveXObject:false,CScript:false,Debug:false,Enumerator:false,System:false,VBArray:false,WScript:false},v,da,ya=/@cc|<\/?|script|\]\s*\]|<\s*!|&lt/i,
Oa=/\r/g,Y=/\r\n/g,Za=/[\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/,fc=/[\[\]\/\\"'*<>.&:(){}+=#]/,Wb=/^\s*(['"=>\/&#]|<(?:\/|\!(?:--)?)?|[a-zA-Z][a-zA-Z0-9_\-:]*|[0-9]+|--)/,$a=/^([a-zA-Z_$][a-zA-Z0-9_$]*)$/,gb=/^(?:javascript|jscript|ecmascript|vbscript|mocha|livescript)\s*:/i,gc=/\*\/|\/\*/,Mb=/[\u0000-\u001f'\\\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
Xb=/[>&]|<[\/!]?|--/,hc=/[^a-zA-Z0-9+\-_\/ ]/,Yb=/^\s*([(){}\[.,:;'"~\?\]#@]|==?=?|\/(\*(jslint|properties|property|members?|globals?)?|=|\/)?|\*[\/=]?|\+(?:=|\++)?|-(?:=|-+)?|%=?|&[&=]?|\|[|=]?|>>?>?=?|<([\/=!]|\!(\[|--)?|<=?)?|\^=?|\!=?=?|[a-zA-Z_$][a-zA-Z0-9_$]*|[0-9]+([xX][0-9a-fA-F]+|\.[0-9]*)?([eE][+\-]?[0-9]+)?)/,Nb=/&|\+|\u00AD|\.\.|\/\*|%[^;]|base64|url|expression|data|mailto/i,Ob={outer:Wb,html:Wb,style:/^\s*([{:#%.=,>+\[\]@()"';]|\*=?|\$=|\|=|\^=|~=|[a-zA-Z_][a-zA-Z0-9_\-]*|[0-9]+|<\/|\/\*)/,
styleproperty:/^\s*([@#!"'};:\-%.=,+\[\]()*_]|[a-zA-Z][a-zA-Z0-9._\-]*|\/\*?|\d+(?:\.\d+)?|<\/)/};if(typeof Array.prototype.filter!=="function")Array.prototype.filter=function(a){var b,c=this.length,d=[],e;for(b=0;b<c;b=b+1)try{e=this[b];a(e)&&d.push(e)}catch(f){}return d};if(typeof Array.prototype.forEach!=="function")Array.prototype.forEach=function(a){var b,c=this.length;for(b=0;b<c;b=b+1)try{a(this[b])}catch(d){}return[]};if(typeof Array.isArray!=="function")Array.isArray=function(a){return Object.prototype.toString.apply(a)===
"[object Array]"};if(!Object.prototype.hasOwnProperty.call(Object,"create"))Object.create=function(a){b.prototype=a;return new b};if(typeof Object.keys!=="function")Object.keys=function(a){var b=[],c;for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b};if(typeof String.prototype.entityify!=="function")String.prototype.entityify=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};if(typeof String.prototype.isAlpha!=="function")String.prototype.isAlpha=
function(){return this>="a"&&this<="z\uffff"||this>="A"&&this<="Z\uffff"};if(typeof String.prototype.isDigit!=="function")String.prototype.isDigit=function(){return this>="0"&&this<="9"};if(typeof String.prototype.supplant!=="function")String.prototype.supplant=function(a){return this.replace(/\{([^{}]*)\}/g,function(b,c){var d=a[c];return typeof d==="string"||typeof d==="number"?d:b})};fb=function(){function a(b,c,d,e){c={comment:b,quote:c,at:e,line:d};Ca||Cb||v&&v!=="script"&&v!=="style"&&v!=="styleproperty"?
j("unexpected_comment",d,f):v==="script"&&/<\//i.test(o)?j("unexpected_a",d,f,"</"):m.safe&&ya.test(b)&&j("dangerous_comment",d,e);Na.comments?Na.comments.push(c):Na.comments=[c];JAYLINT.comments.push(c)}function b(){var a;if(k>=qb.length)return false;f=1;o=qb[k];k=k+1;a=o.search(/ \t/);a>=0&&j("mixed",k,a+1);o=o.replace(/\t/g,sb);a=o.search(Za);a>=0&&j("unsafe",k,a);m.maxlen&&m.maxlen<o.length&&j("too_long",k,o.length);return true}function c(a,b,d){var e;(a==="(string)"||a==="(range)")&&gb.test(b)&&
j("url",k,g);e=Object.create(ma[a==="(punctuator)"||a==="(identifier)"&&Object.prototype.hasOwnProperty.call(ma,b)?b:a]||ma["(error)"]);if(a==="(identifier)"){e.identifier=true;b==="__iterator__"||b==="__proto__"?u("reserved_a",k,g,b):!m.nomen&&(b.charAt(0)==="_"||b.charAt(b.length-1)==="_")&&j("dangling_a",k,g,b)}if(b!==void 0)e.value=b;if(d)e.quote=d;e.line=k;e.from=g;e.thru=f;e.prev=Na;Lb=(a=e.id)&&("(,=:[!&|?{};".indexOf(a.charAt(a.length-1))>=0||a==="return");return Na=Na.next=e}function d(a){function e(a){var b=
parseInt(o.substr(h+1,a),16);h=h+a;b>=32&&b<=126&&b!==34&&b!==92&&b!==39&&j("unexpected_a",k,f,"\\");f=f+a;i=String.fromCharCode(b)}var i,h,n="";Da&&a!=='"'&&j("expected_a",k,f,'"');if(da===a||v==="scriptstring"&&!da)return c("(punctuator)",a);for(h=0;;){for(;h>=o.length;){h=0;(v!=="html"||!b())&&u("unclosed",k,g)}i=o.charAt(h);if(i===a){f=f+1;o=o.slice(h+1);return c("(string)",n,a)}if(i<" "){if(i==="\n"||i==="\r")break;j("control_a",k,f+q,o.slice(0,q))}else if(i===da)j("bad_html",k,f+h);else if(i===
"<")m.safe&&v==="html"?j("adsafe_a",k,f+q,i):o.charAt(q+1)==="/"&&(v||m.safe)?j("expected_a_b",k,f,"<\\/","</"):o.charAt(q+1)==="!"&&(v||m.safe)&&j("unexpected_a",k,f,"<!");else if(i==="\\")if(v==="html")m.safe&&j("adsafe_a",k,f+q,i);else if(v==="styleproperty"){h=h+1;f=f+1;i=o.charAt(h);i!==a&&j("unexpected_a",k,f,"\\")}else{h=h+1;f=f+1;i=o.charAt(h);switch(i){case "":m.es5||j("es5",k,f);b();h=-1;break;case da:j("bad_html",k,f+h);break;case "'":Da&&j("unexpected_a",k,f,"\\'");break;case "u":e(4);
break;case "v":Da&&j("unexpected_a",k,f,"\\v");i="\v";break;case "x":Da&&j("unexpected_a",k,f,"\\x");e(2);break;default:i=$b[i];typeof i!=="string"&&j("unexpected_a",k,f,"\\")}}n=n+i;f=f+1;h=h+1}}function e(){for(var a,b,d=0,i=0;;){a=true;h=o.charAt(i);i=i+1;switch(h){case "":u("unclosed_regexp",k,g);return;case "/":d>0&&j("unescaped_a",k,g+i,"/");h=o.slice(0,i-1);for(d=Object.create(dc);d[o.charAt(i)]===true;){d[o.charAt(i)]=false;i=i+1}o.charAt(i).isAlpha()&&u("unexpected_a",k,g,o.charAt(i));f=
f+i;o=o.slice(i);i=o.charAt(0);(i==="/"||i==="*")&&u("confusing_regexp",k,g);return c("(regexp)",h);case "\\":h=o.charAt(i);h<" "?j("control_a",k,g+i,""+h):h==="<"&&j(G.unexpected_a,k,g+i,"\\");i=i+1;break;case "(":d=d+1;a=false;if(o.charAt(i)==="?"){i=i+1;switch(o.charAt(i)){case ":":case "=":case "!":i=i+1;break;default:j(G.expected_a_b,k,g+i,":",o.charAt(i))}}break;case "|":a=false;break;case ")":d===0?j("unescaped_a",k,g+i,")"):d=d-1;break;case " ":for(q=1;o.charAt(i)===" ";){i=i+1;q=q+1}q>1&&
j("use_braces",k,g+i,q);break;case "[":h=o.charAt(i);if(h==="^"){i=i+1;m.regexp?o.charAt(i)==="]"&&u("unescaped_a",k,g+i,"^"):j("insecure_a",k,g+i,h)}b=false;if(h==="]"){j("empty_class",k,g+i-1);b=true}a:do{h=o.charAt(i);i=i+1;switch(h){case "[":case "^":j("unescaped_a",k,g+i,h);b=true;break;case "-":if(b)b=false;else{j("unescaped_a",k,g+i,"-");b=true}break;case "]":b||j("unescaped_a",k,g+i-1,"-");break a;case "\\":h=o.charAt(i);h<" "?j(G.control_a,k,g+i,""+h):h==="<"&&j(G.unexpected_a,k,g+i,"\\");
i=i+1;b=true;break;case "/":j("unescaped_a",k,g+i-1,"/");b=true;break;case "<":if(v==="script"){h=o.charAt(i);(h==="!"||h==="/")&&j(G.html_confusion_a,k,g+i,h)}b=true;break;default:b=true}}while(h);break;case ".":m.regexp||j("insecure_a",k,g+i,h);break;case "]":case "?":case "{":case "}":case "+":case "*":j("unescaped_a",k,g+i,h);break;case "<":if(v==="script"){h=o.charAt(i);(h==="!"||h==="/")&&j(G.html_confusion_a,k,g+i,h)}}if(a)switch(o.charAt(i)){case "?":case "+":case "*":i=i+1;o.charAt(i)===
"?"&&(i=i+1);break;case "{":i=i+1;h=o.charAt(i);(h<"0"||h>"9")&&j(G.expected_number_a,k,g+i,h);i=i+1;for(b=+h;;){h=o.charAt(i);if(h<"0"||h>"9")break;i=i+1;b=+h+b*10}a=b;if(h===","){i=i+1;a=Infinity;h=o.charAt(i);if(h>="0"&&h<="9"){i=i+1;for(a=+h;;){h=o.charAt(i);if(h<"0"||h>"9")break;i=i+1;a=+h+a*10}}}o.charAt(i)!=="}"?j(G.expected_a_b,k,g+i,"}",h):i=i+1;o.charAt(i)==="?"&&(i=i+1);b>a&&j(G.not_greater,k,g+i,b,a)}}h=o.slice(0,i-1);f=f+i;o=o.slice(i);return c("(regexp)",h)}var f,h,g,n,k,q,o;return{init:function(a){qb=
typeof a==="string"?a.replace(Y,"\n").replace(Oa,"\n").split("\n"):a;k=0;b();g=1},range:function(a,b){var d,e="";g=f;for(o.charAt(0)!==a&&u("expected_a_b",k,f,a,o.charAt(0));;){o=o.slice(1);f=f+1;d=o.charAt(0);switch(d){case "":u("missing_a",k,f,d);break;case b:o=o.slice(1);f=f+1;return c("(range)",e);case da:case "\\":j("unexpected_a",k,f,d)}e=e+d}},token:function(){for(var m,q,s;;){for(;!o;)if(!b())return c("(end)");for(;v==="outer";){q=o.search(Xb);if(q===0)break;else if(q>0){f=f+1;o=o.slice(q);
break}else if(!b())return c("(end)","")}m=(Ob[v]||Yb).exec(o);s=void 0;if(m){n=m[0].length;s=m[1];h=s.charAt(0);o=o.slice(n);g=f+n-s.length;f=f+n}else s=void 0;if(s){m=s.charAt(0);if(m.isAlpha()||m==="_"||m==="$")return c("(identifier)",s);if(m.isDigit()){q=s;m=void 0;v!=="style"&&v!=="styleproperty"&&o.charAt(0).isAlpha()&&j("expected_space_a_b",k,f,h,o.charAt(0));if(h==="0"){m=q.charAt(1);m.isDigit()?p.id!=="."&&v!=="styleproperty"&&j("unexpected_a",k,f,q):Da&&(m==="x"||m==="X")&&j("unexpected_a",
k,f,"0x")}q.slice(q.length-1)==="."&&j("trailing_decimal_a",k,f,q);if(v!=="style"){m=+q;isFinite(m)||j("bad_number",k,f,q);q=m}return c("(number)",q)}switch(s){case '"':case "'":return d(s);case "//":a(o,"//",k,f);o="";break;case "/*":for(m="/*";;){q=o.search(gc);if(q>=0)break;a(o,m,k,f);m="";b()||u("unclosed_comment",k,f)}a(o.slice(0,q),m,f,k);f=f+(q+2);o.charAt(q)==="/"&&u("nested_comment",k,f);o=o.slice(q+2);break;case "":break;case "/":p.id==="/="&&u(G.slash_equal,k,g);return Lb?e():c("(punctuator)",
s);case "<\!--":for(n=k;;){q=o.indexOf("--");if(q>=0)break;q=o.indexOf("<!");q>=0&&u("nested_comment",k,f+q);b()||u("unclosed_comment",n,m)}n=o.indexOf("<!");n>=0&&n<q&&u("nested_comment",k,f+n);f=f+q;o.charAt(q+2)!==">"&&u("expected_a",k,f,"--\>");f=f+3;o=o.slice(q+3);break;case "#":if(v==="html"||v==="styleproperty"){for(;;){m=o.charAt(0);if((m<"0"||m>"9")&&(m<"a"||m>"f")&&(m<"A"||m>"F"))break;f=f+1;o=o.slice(1);s=s+m}s.length!==4&&s.length!==7&&j("bad_color_a",k,g+n,s);return c("(color)",s)}return c("(punctuator)",
s);default:if(v==="outer"&&m==="&"){f=f+1;for(o=o.slice(1);;){m=o.charAt(0);f=f+1;o=o.slice(1);if(m===";")break;m>="0"&&m<="9"||m>="a"&&m<="z"||m==="#"||u("bad_entity",k,g+n,f)}break}return c("(punctuator)",s)}}else{for(;o&&o<"!";)o=o.slice(1);if(o){if(v==="html")return c("(error)",o.charAt(0));u("unexpected_a",k,f,o.charAt(0))}}}}}}();ma["(identifier)"]={lbp:0,identifier:true,nud:function(){var a=this.value,b=E[a];if(typeof b!=="object"){b=ba[a];if(typeof b==="boolean"){ob[a]=b={value:a,writeable:b,
funct:pa};pa[a]="var"}else{m.undef||f("used_before_a",p);E[a]=b={value:a,writeable:true,funct:r};r[a]="undef"}}b=b.funct;if(r===b)switch(r[a]){case "becoming":f("unexpected_a",p);r[a]="var";break;case "unused":r[a]="var";break;case "unparam":r[a]="parameter";break;case "unction":r[a]="function";break;case "label":f("a_label",p,a)}else switch(r[a]){case "closure":case "function":case "var":case "unused":f("a_scope",p,a);break;case "label":f("a_label",p,a);break;case "outer":case "global":break;default:switch(b[a]){case "function":case "unction":case "var":case "unused":case "becoming":case "closure":case "parameter":b[a]=
"closure";r[a]=b===pa?"global":"outer";break;case "unparam":b[a]="parameter";r[a]="outer";break;case "undef":r[a]="undef";break;case "label":f("a_label",p,a)}}return this},led:function(){n("expected_operator_a")}};Aa("(array)","array");Aa("(color)","color");Aa("(function)","function");Aa("(number)","number",a);Aa("(object)","object");Aa("(string)","string",a);Aa("(boolean)","boolean",a);Aa("(range)","range");Aa("(regexp)","regexp",a);Eb("(begin)");Eb("(end)");Eb("(error)");Ra(R("</"));R("<!");R("<\!--");
R("--\>");Ra(R("}"));R(")");R("]");Ra(R('"'));Ra(R("'"));R(";");R(":");R(",");R("#");R("@");R("*/");Ra(x("case"));x("catch");Ra(x("default"));x("else");x("finally");jb("arguments",function(a){xa&&r===pa?f("strict",a):m.safe&&f("adsafe",a)});jb("eval",function(a){m.safe&&f("adsafe",a)});Ta("false","boolean",false);Ta("Infinity","number",Infinity);Ta("NaN","number",NaN);Ta("null","",null);jb("this",function(a){xa&&(r["(statement)"]&&r["(name)"].charAt(0)>"Z"||r===pa)?f("strict",a):m.safe&&f("adsafe",
a)});Ta("true","boolean",true);Ta("undefined","",void 0);P("?",30,function(a,b){b.first=qa(wa(a));b.second=t(0);J();var c=g;k(":");o();J();b.third=t(10);b.arity="ternary";b.type=N(b.second,b.third);ea(b.second,b.third)?f("weird_ternary",c):ea(b.first,b.second)&&f("use_or",b);return b});P("||",40,function(a,b){function c(a){a.id==="&&"&&!a.paren&&f("and",a);return a}b.first=c(qa(wa(a)));b.second=c(wa(t(40)));ea(b.first,b.second)&&f("weird_condition",b);return b});P("&&",50,function(a,b){b.first=qa(wa(a));
b.second=wa(t(50));ea(b.first,b.second)&&f("weird_condition",b);return b});V("void",function(){this.first=t(0);if(this.first.id!=="(number)"||this.first.value){f("unexpected_a",this);return this}this.type="undefined";return this});Va("|",70);Va("^",80);Va("&",90);ra("==","===");ra("===");ra("!=","!==");ra("!==");ra("<");ra(">");ra("<=");ra(">=");Va("<<",120);Va(">>",120);Va(">>>",120);P("in",120,function(a,b){f("infix_in",b);b.left=a;b.right=t(130);return b},"boolean");P("instanceof",120,null,"boolean");
P("+",130,function(a,b){a.value||(a.id==="(number)"?f("unexpected_a",a):a.id==="(string)"&&f("expected_a_b",a,"String","''"));var c=t(130);c.value||(c.id==="(number)"?f("unexpected_a",c):c.id==="(string)"&&f("expected_a_b",c,"String","''"));if(a.id===c.id&&(a.id==="(string)"||a.id==="(number)")){a.value=a.value+c.value;a.thru=c.thru;a.id==="(string)"&&gb.test(a.value)&&f("url",a);o(c);o(b);return a}b.first=a;b.second=c;b.type=N(a,c,b);return b});V("+","num");V("+++",function(){f("confusing_a",p);
this.first=t(150);this.arity="prefix";return this});P("+++",130,function(a){f("confusing_a",p);this.first=a;this.second=t(130);return this});P("-",130,function(a,b){(a.id==="(number)"&&a.value===0||a.id==="(string)")&&f("unexpected_a",a);var c=t(130);(c.id==="(number)"&&c.value===0||c.id==="(string)")&&f("unexpected_a",a);if(a.id===c.id&&a.id==="(number)"){a.value=a.value-c.value;a.thru=c.thru;o(c);o(b);return a}b.first=a;b.second=c;return b},"number");V("-");V("---",function(){f("confusing_a",p);
this.first=t(150);this.arity="prefix";return this});P("---",130,function(a){f("confusing_a",p);this.first=a;this.second=t(130);return this});P("*",140,function(a,b){(a.id==="(number)"&&(a.value===0||a.value===1)||a.id==="(string)")&&f("unexpected_a",a);var c=t(140);(c.id==="(number)"&&(c.value===0||c.value===1)||c.id==="(string)")&&f("unexpected_a",c);if(a.id===c.id&&a.id==="(number)"){a.value=a.value*c.value;a.thru=c.thru;o(c);o(b);return a}b.first=a;b.second=c;return b},"number");P("/",140,function(a,
b){(a.id==="(number)"&&a.value===0||a.id==="(string)")&&f("unexpected_a",a);var c=t(140);(c.id==="(number)"&&(c.value===0||c.value===1)||c.id==="(string)")&&f("unexpected_a",c);if(a.id===c.id&&a.id==="(number)"){a.value=a.value/c.value;a.thru=c.thru;o(c);o(b);return a}b.first=a;b.second=c;return b},"number");P("%",140,function(a,b){(a.id==="(number)"&&(a.value===0||a.value===1)||a.id==="(string)")&&f("unexpected_a",a);var c=t(140);(c.id==="(number)"&&c.value===0||c.id==="(string)")&&f("unexpected_a",
c);if(a.id===c.id&&a.id==="(number)"){a.value=a.value%c.value;a.thru=c.thru;o(c);o(b);return a}b.first=a;b.second=c;return b},"number");Fb("++");V("++");Fb("--");V("--");V("delete",function(){w();var a=t(0);(!a||a.id!=="."&&a.id!=="[")&&f("deleted");this.first=a;return this});V("~",function(){H();m.bitwise||f("unexpected_a",this);t(150);return this},"number");V("!",function(){H();this.first=qa(t(150));this.arity="prefix";Qb[this.first.id]===true&&f("confusing_a",this);return this},"boolean");V("typeof",
null,"string");V("new",function(){w();var a=t(160),b;this.first=a;if(a.id!=="function")if(a.identifier)switch(a.value){case "Object":f("use_object",p);break;case "Array":if(g.id==="("){b=g;b.first=this;k("(");if(g.id!==")"){b.second=t(0);if(b.second.id!=="(string)"||!b.second.value){qa(b.second,G.use_array);a=false}else a=true;for(;g.id!==")"&&g.id!=="(end)";){if(a){f("use_array",b);a=false}k()}}else f("use_array",p);k(")",b);o();return b}f("use_array",p);break;case "Number":case "String":case "Boolean":case "Math":case "JSON":f("not_a_constructor",
a);break;case "Function":m.evil||f("function_eval");break;case "Date":case "RegExp":break;default:if(a.id!=="function"){a=a.value.charAt(0);!m.newcap&&(a<"A"||a>"Z")&&f("constructor_name_a",p)}}else a.id!=="."&&a.id!=="["&&a.id!=="("&&f("bad_constructor",p);else f("weird_new",this);g.id!=="("&&f("missing_a",g,"()");return this});P("(",160,function(a,b){y&&y.mode==="expression"?B(la,p):H(la,p);!a.immed&&a.id==="function"&&f("wrap_immediate");var c=[];if(a){N("function",a);a.identifier?a.value.match(/^[A-Z]([A-Z0-9_$]*[a-z][A-Za-z0-9_$]*)?$/)&&
a.value!=="Number"&&a.value!=="String"&&a.value!=="Boolean"&&a.value!=="Date"&&(a.value==="Math"||a.value==="JSON"?f("not_a_function",a):a.value==="Object"?f("use_object",p):(a.value==="Array"||!m.newcap)&&f("missing_a",a,"new")):a.id==="."&&(m.safe&&a.first.value==="Math"&&a.second==="random"?f("adsafe",a):a.second.value==="split"&&a.first.id==="(string)"&&f("use_array",a.second))}O();if(g.id!==")")for(B();;){C();c.push(t(10));if(g.id!==",")break;K()}B();F(")",b);if(typeof a==="object"){a.value===
"parseInt"&&c.length===1&&f("radix",a);m.evil||(a.value==="eval"||a.value==="Function"||a.value==="execScript"?f("evil",a):c[0]&&c[0].id==="(string)"&&(a.value==="setTimeout"||a.value==="setInterval")&&f("implied_evil",a));!a.identifier&&a.id!=="."&&a.id!=="["&&a.id!=="("&&a.id!=="&&"&&a.id!=="||"&&a.id!=="?"&&f("bad_invocation",a)}b.first=a;b.second=c;if(!m.type)if(a.id===".")if(a.second.value==="charAt"||a.second.value==="substring"){N("string",b);N("string",a.first);c.forEach(function(a){N("number",
a)})}else(a.second.value==="toString"||a.second.value==="stringify")&&N("string",b);else a.identifier&&a.value==="String"&&N("string",b);return b},"",true);V("(",function(){O("expression");o();B();C();if(g.id==="function")g.immed=true;var a=t(0);a.paren=true;B();F(")",this);o();a.id==="function"&&(g.id==="("?f("move_invocation"):f("bad_wrap",this));return a});P(".",170,function(a,b){B(la,p);B();var c=Ja();typeof c==="string"&&Ba(c);b.first=a;b.second=p;if(a&&a.value==="arguments"&&(c==="callee"||
c==="caller"))f("avoid_a",a,"arguments."+c);else if(!m.evil&&a&&a.value==="document"&&(c==="write"||c==="writeln"))f("write_is_wrong",a);else if(m.adsafe){if(!La&&a.value==="ADSAFE")if(c==="id"||c==="lib")f("adsafe",b);else if(c==="go"){v!=="script"?f("adsafe",b):(S||g.id!=="("||s(0).id!=="(string)"||s(0).value!==ka||s(1).id!==",")&&n("adsafe_a",b,"go");S=true;eb=false}La=false}if(!m.evil&&(c==="eval"||c==="execScript"))f("evil");else if(m.safe)for(;;){mb[c]===true&&f("adsafe_a",p,c);if(typeof ba[a.value]!==
"boolean"||g.id==="(")break;if(Ga[c]===true){g.id==="."&&f("adsafe",b);break}if(g.id!=="."){f("adsafe",b);break}k(".");p.first=b;p.second=c;b=p;c=Ja();typeof c==="string"&&Ba(c)}c==="length"&&N("number",b);return b},"",true);P("[",170,function(a,b){var c=ib(a),d;H(la,p);B();O();C();d=t(0);switch(ib(d)){case "number":d.id==="(number)"&&a.id==="arguments"&&f("use_param",a);c||N("array",a);break;case "string":if(d.id==="(string)"){if(m.safe&&(mb[d.value]||d.value.charAt(0)==="_"||d.value.slice(-1)===
"_"))f("adsafe_subscript_a",d);else if(!m.evil&&(d.value==="eval"||d.value==="execScript"))f("evil",d);else if(!m.sub&&$a.test(d.value)){c=ma[d.value];(!c||!c.reserved)&&f("subscript",d)}Ba(d.value)}else m.safe&&d.id!=="typeof"&&f("adsafe_subscript_a",d);N("object",a);break;case void 0:switch(ib(a)){case "array":N("number",d);break;case "object":N("string",d);break;case "string":m.type||f("use_charAt",b);b.type="string"}m.safe&&f("adsafe_subscript_a",d);break;default:m.safe?f("adsafe_subscript_a",
d):f("bad_type")}F("]",b);o();B(la,p);b.first=a;b.second=d;return b},"",true);V("[",function(){this.arity="prefix";this.first=[];this.type="array";for(O("array");g.id!=="(end)";){for(;g.id===",";){f("unexpected_a",g);k(",");o()}if(g.id==="]")break;y.wrap=false;C();this.first.push(t(10));if(g.id===","){K();if(g.id==="]"&&!m.es5){f("unexpected_a",p);break}}else break}F("]",this);o();return this},170);ia("=");ia("+=","+");ia("-=","-");ia("*=","*");ia("/=","/").nud=function(){n("slash_equal")};ia("%=",
"%");ia("&=","&");ia("|=","|");ia("^=","^");ia("<<=","<<");ia(">>=",">>");ia(">>>=",">>>");V("{",function(){var a,b,c,d,e,h={};this.arity="prefix";this.first=[];this.type="object";for(O();g.id!=="}";){y.wrap=false;C();if(g.value==="get"&&s().id!==":"){m.es5||f("es5");a=g;k("get");bb();d=g;(b=fa())||n("missing_property");a.value="";X(a);r["(loopage)"]&&f("function_loop",a);(c=a.first)&&f("parameter_a_get_b",c[0],c[0].value,b);K();e=g;e.value="";J();C();k("set");bb();c=fa();b!==c&&n("expected_a_b",
p,b,c||g.value);X(e);c=e.first;!c||c.length!==1?n("parameter_set_a",e,"value"):c[0].value!=="value"&&n("expected_a_b",c[0],"value",c[0].value);d.first=[a,e]}else{d=g;b=fa();typeof b!=="string"&&n("missing_property");k(":");o();J();d.first=t(10)}this.first.push(d);h[b]===true&&f("duplicate_a",g,b);h[b]=true;Ba(b);if(g.id!==",")break;for(;;){K();if(g.id!==",")break;f("unexpected_a",g)}g.id==="}"&&!m.es5&&f("unexpected_a",p)}F("}",this);o();return this});Z("{",function(){o();f("statement_block");this.arity=
"statement";this.block=Ka();this.disrupt=this.block.disrupt;k("}",this);o();return this});Z("/*global",va);Z("/*globals",va);Z("/*jslint",va);Z("/*member",va);Z("/*members",va);Z("/*property",va);Z("/*properties",va);Z("var",function(){var a,b,c;r["(vars)"]&&!m.vars?f("combine_var"):r!==pa&&(r["(vars)"]=true);this.arity="statement";this.first=[];for(O("var");;){c=g;b=Ja();A(c,"becoming");if(g.id==="="){a=g;a.first=c;J();k("=");J();g.id==="undefined"&&f("unnecessary_initialize",p,b);s(0).id==="="&&
g.identifier&&n("var_a_not");a.second=t(0);a.arity="infix";this.first.push(a);if(a.second.type)c.type=a.second.type}else this.first.push(c);r[b]==="becoming"&&(r[b]="unused");if(g.id!==",")break;K();y.wrap=false;if(Ha&&g.line===p.line&&this.first.length===1){Ha=null;y.open=false;y.at=y.at-m.indent}J();C()}Ha=null;F();return this});Z("function",function(){w();Ya&&f("function_block",p);var a=g,b=Ja();A(a,"unction");B();X(this,b);g.id==="("&&g.line===p.line&&n("function_statement");this.arity="statement";
return this});V("function",function(){w();var a=Ja();a?B():a="";X(this,a);r["(loopage)"]&&f("function_loop");this.arity="function";return this});Z("if",function(){var a=g;w();k("(");O("control");o();B();C();this.arity="statement";this.first=qa(wa(t(0)));B();F(")",a);o();w();this.block=na(true);if(g.id==="else"){w();k("else");o();w();this["else"]=g.id==="if"||g.id==="switch"?sa(true):na(true);if(this["else"].disrupt&&this.block.disrupt)this.disrupt=true}return this});Z("try",function(){var a,b,c;m.adsafe&&
f("adsafe_a",this);w();this.arity="statement";this.block=na(false);if(g.id==="catch"){w();k("catch");o();w();c=g;k("(");O("control");o();B();C();b=E;E=Object.create(b);this.first=a=g.value;g.identifier?A(g,"exception"):f("expected_identifier_a",g);k();B();F(")",c);o();w();this.second=na(false);E=b}if(g.id==="finally"){o();w();k("finally");o();w();this.third=na(false)}else this.second||n("expected_a_b",g,"catch",g.value);return this});ha("while",function(){w();var a=g;r["(breakage)"]=r["(breakage)"]+
1;r["(loopage)"]=r["(loopage)"]+1;k("(");O("control");o();B();C();this.arity="statement";this.first=wa(t(0));this.first.id!=="true"&&qa(this.first,G.unexpected_a);B();F(")",a);o();w();this.block=na(true);this.block.disrupt&&f("strange_loop",la);r["(breakage)"]=r["(breakage)"]-1;r["(loopage)"]=r["(loopage)"]-1;return this});x("with");ha("switch",function(){var a,b=g,c=true;r["(breakage)"]=r["(breakage)"]+1;w();k("(");o();B();O();this.arity="statement";this.first=qa(wa(t(0)));B();F(")",b);o();w();k("{");
O();for(this.second=[];g.id==="case";){b=g;b.first=[];b.arity="case";J();C("case");for(k("case");;){w();a=t(0);b.first.push(a);a.id==="NaN"&&f("unexpected_a",a);H();k(":");o();if(g.id!=="case")break;J();C("case");k("case");o()}J();b.second=Ka();if(b.second&&b.second.length>0){a=b.second[b.second.length-1];a.disrupt?a.id==="break"&&(c=false):f("missing_a_after_b",g,"break","case")}else f("empty_case");this.second.push(b)}this.second.length===0&&f("missing_a",g,"case");if(g.id==="default"){J();b=g;
b.arity="case";C("case");k("default");o();H();k(":");o();J();b.second=Ka();if(b.second&&b.second.length>0){a=b.second[b.second.length-1];if(c&&a.disrupt&&a.id!=="break")this.disrupt=true}this.second.push(b)}r["(breakage)"]=r["(breakage)"]-1;J();F("}",this);return this});Z("debugger",function(){m.debug||f("unexpected_a",this);this.arity="statement";return this});ha("do",function(){r["(breakage)"]=r["(breakage)"]+1;r["(loopage)"]=r["(loopage)"]+1;w();this.arity="statement";this.block=na(true);this.block.disrupt&&
f("strange_loop",la);w();k("while");o();var a=g;w();k("(");O();o();B();C();this.first=qa(wa(t(0)),G.unexpected_a);B();F(")",a);o();r["(breakage)"]=r["(breakage)"]-1;r["(loopage)"]=r["(loopage)"]-1;return this});ha("for",function(){var a,b,c=false;a=g;var d;this.arity="statement";r["(breakage)"]=r["(breakage)"]+1;r["(loopage)"]=r["(loopage)"]+1;k("(");O("control");o();J(this,a);B();g.id==="var"&&n("move_var");C();if(s(0).id==="in"){b=g;switch(r[b.value]){case "unused":r[b.value]="var";break;case "closure":case "var":break;
default:f("bad_in_a",b)}N("string",b);k();d=g;k("in");d.first=b;d.second=t(20);N("object",d.second);F(")",a);o();this.first=d;a=na(true);if(!m.forin){if(a.length===1&&typeof a[0]==="object"&&a[0].value==="if"&&!a[0]["else"]){for(b=a[0].first;b.id==="&&";)b=b.first;switch(b.id){case "===":case "!==":c=b.first.id==="["?b.first.first.value===d.second.value&&b.first.second.value===d.first.value:b.first.id==="typeof"&&b.first.first.id==="["&&b.first.first.first.value===d.second.value&&b.first.first.second.value===
d.first.value;break;case "(":c=b.first.id==="."&&(b.first.first.value===d.second.value&&b.first.second.value==="hasOwnProperty"&&b.second[0].value===d.first.value||b.first.first.value==="ADSAFE"&&b.first.second.value==="has"&&b.second[0].value===d.second.value&&b.second[1].value===d.first.value||b.first.first.id==="."&&b.first.first.first.id==="."&&b.first.first.first.first.value==="Object"&&b.first.first.first.second.value==="prototype"&&b.first.first.second.value==="hasOwnProperty"&&b.first.second.value===
"call"&&b.second[0].value===d.second.value&&b.second[1].value===d.first.value)}}c||f("for_if",this)}}else{if(g.id!==";"){C();for(this.first=[];;){this.first.push(t(0,"for"));if(g.id!==",")break;K()}}ga();if(g.id!==";"){C();this.second=wa(t(0));this.second.id!=="true"&&qa(this.second,G.unexpected_a)}ga(p);g.id===";"&&n("expected_a_b",g,")",";");if(g.id!==")"){this.third=[];for(C();;){this.third.push(t(0,"for"));if(g.id!==",")break;K()}}B();F(")",a);o();w();a=na(true)}a.disrupt&&f("strange_loop",la);
this.block=a;r["(breakage)"]=r["(breakage)"]-1;r["(loopage)"]=r["(loopage)"]-1;return this});za("break",function(){var a=g.value;this.arity="statement";r["(breakage)"]===0&&f("unexpected_a",this);if(g.identifier&&p.line===g.line){bb();r[a]!=="label"?f("not_a_label",g):E[a].funct!==r&&f("not_a_scope",g);this.first=g;k()}return this});za("continue",function(){m["continue"]||f("unexpected_a",this);var a=g.value;this.arity="statement";r["(breakage)"]===0&&f("unexpected_a",this);if(g.identifier&&p.line===
g.line){bb();r[a]!=="label"?f("not_a_label",g):E[a].funct!==r&&f("not_a_scope",g);this.first=g;k()}return this});za("return",function(){this.arity="statement";if(g.id!==";"&&g.line===p.line){bb();(g.id==="/"||g.id==="(regexp)")&&f("wrap_regexp");this.first=t(20)}return this});za("throw",function(){this.arity="statement";bb();this.first=t(20);return this});x("class");x("const");x("enum");x("export");x("extends");x("import");x("super");x("let");x("yield");x("implements");x("interface");x("package");
x("private");x("protected");x("public");x("static");xb=[Wa,function(){for(;;)if(g.identifier)switch(g.value.toLowerCase()){case "url":Wa();break;case "expression":f("unexpected_a");k();break;default:k()}else{if(g.id===";"||g.id==="!"||g.id==="(end)"||g.id==="}")return true;k()}}];Xa=["none","dashed","dotted","double","groove","hidden","inset","outset","ridge","solid"];yb=["auto","always","avoid","left","right"];Sb={all:true,braille:true,embossed:true,handheld:true,print:true,projection:true,screen:true,
speech:true,tty:true,tv:true};lb=["auto","hidden","scroll","visible"];Ma={background:[true,"background-attachment","background-color","background-image","background-position","background-repeat"],"background-attachment":["scroll","fixed"],"background-color":["transparent",oa],"background-image":["none",Wa],"background-position":[2,[D,"top","bottom","left","right","center"]],"background-repeat":["repeat","repeat-x","repeat-y","no-repeat"],border:[true,"border-color","border-style","border-width"],
"border-bottom":[true,"border-bottom-color","border-bottom-style","border-bottom-width"],"border-bottom-color":oa,"border-bottom-style":Xa,"border-bottom-width":W,"border-collapse":["collapse","separate"],"border-color":["transparent",4,oa],"border-left":[true,"border-left-color","border-left-style","border-left-width"],"border-left-color":oa,"border-left-style":Xa,"border-left-width":W,"border-right":[true,"border-right-color","border-right-style","border-right-width"],"border-right-color":oa,"border-right-style":Xa,
"border-right-width":W,"border-spacing":[2,D],"border-style":[4,Xa],"border-top":[true,"border-top-color","border-top-style","border-top-width"],"border-top-color":oa,"border-top-style":Xa,"border-top-width":W,"border-width":[4,W],bottom:[D,"auto"],"caption-side":["bottom","left","right","top"],clear:["both","left","none","right"],clip:[function(){var a;if(g.identifier&&g.value==="rect"){k();k("(");for(a=0;a<4;a=a+1)if(!D()){f("expected_number_a");break}k(")");return true}return false},"auto"],color:oa,
content:["open-quote","close-quote","no-open-quote","no-close-quote",ta,Wa,function(){if(g.identifier&&g.value==="counter"){k();k("(");k();if(g.id===","){K();g.id!=="(string)"&&f("expected_string_a");k()}k(")");return true}if(g.identifier&&g.value==="counters"){k();k("(");g.identifier||f("expected_name_a");k();if(g.id===","){K();g.id!=="(string)"&&f("expected_string_a");k()}if(g.id===","){K();g.id!=="(string)"&&f("expected_string_a");k()}k(")");return true}return false},function(){if(g.identifier&&
g.value==="attr"){k();k("(");g.identifier||f("expected_name_a");k();k(")");return true}return false}],"counter-increment":[tb,"none"],"counter-reset":[tb,"none"],cursor:[Wa,"auto","crosshair","default","e-resize","help","move","n-resize","ne-resize","nw-resize","pointer","s-resize","se-resize","sw-resize","w-resize","text","wait"],direction:["ltr","rtl"],display:["block","compact","inline","inline-block","inline-table","list-item","marker","none","run-in","table","table-caption","table-cell","table-column",
"table-column-group","table-footer-group","table-header-group","table-row","table-row-group"],"empty-cells":["show","hide"],"float":["left","none","right"],font:["caption","icon","menu","message-box","small-caption","status-bar",true,"font-size","font-style","font-weight","font-family"],"font-family":function(){for(;g.id!==";";){!tb()&&!ta()&&f("expected_name_a");if(g.id!==",")return true;K()}},"font-size":["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller",D],"font-size-adjust":["none",
aa],"font-stretch":["normal","wider","narrower","ultra-condensed","extra-condensed","condensed","semi-condensed","semi-expanded","expanded","extra-expanded"],"font-style":["normal","italic","oblique"],"font-variant":["normal","small-caps"],"font-weight":["normal","bold","bolder","lighter",aa],height:[D,"auto"],left:[D,"auto"],"letter-spacing":["normal",D],"line-height":["normal",function(){if(g.id==="-"){k("-");H()}if(g.id==="(number)"){k();if(g.id!=="(string)"&&zb[g.value]===true){H();k()}return true}return false}],
"list-style":[true,"list-style-image","list-style-position","list-style-type"],"list-style-image":["none",Wa],"list-style-position":["inside","outside"],"list-style-type":["circle","disc","square","decimal","decimal-leading-zero","lower-roman","upper-roman","lower-greek","lower-alpha","lower-latin","upper-alpha","upper-latin","hebrew","katakana","hiragana-iroha","katakana-oroha","none"],margin:[4,ja],"margin-bottom":ja,"margin-left":ja,"margin-right":ja,"margin-top":ja,"marker-offset":[D,"auto"],
"max-height":[D,"none"],"max-width":[D,"none"],"min-height":D,"min-width":D,opacity:aa,outline:[true,"outline-color","outline-style","outline-width"],"outline-color":["invert",oa],"outline-style":["dashed","dotted","double","groove","inset","none","outset","ridge","solid"],"outline-width":W,overflow:lb,"overflow-x":lb,"overflow-y":lb,padding:[4,D],"padding-bottom":D,"padding-left":D,"padding-right":D,"padding-top":D,"page-break-after":yb,"page-break-before":yb,position:["absolute","fixed","relative",
"static"],quotes:[8,ta],right:[D,"auto"],"table-layout":["auto","fixed"],"text-align":["center","justify","left","right"],"text-decoration":["none","underline","overline","line-through","blink"],"text-indent":D,"text-shadow":["none",4,[oa,D]],"text-transform":["capitalize","uppercase","lowercase","none"],top:[D,"auto"],"unicode-bidi":["normal","embed","bidi-override"],"vertical-align":["baseline","bottom","sub","super","top","text-top","middle","text-bottom",D],visibility:["visible","hidden","collapse"],
"white-space":["normal","nowrap","pre","pre-line","pre-wrap","inherit"],width:[D,"auto"],"word-spacing":["normal",D],"word-wrap":["break-word","normal"],"z-index":["auto",aa]};L=function(a,b){var c,h,j;JAYLINT.comments=[];JAYLINT.errors=[];JAYLINT.tree="";Jb=Na=la=p=g=Object.create(ma["(begin)"]);ba={};d(Ub);if(b){m=Object.create(b);if(h=m.predef)if(Array.isArray(h))for(c=0;c<h.length;c=c+1)ba[h[c]]=true;else typeof h==="object"&&d(h);Ia()}else m={};m.indent=+m.indent||0;m.maxerr=m.maxerr||50;ka=
"";eb=La=S=false;kb={};if(m.approved)for(c=0;c<m.approved.length;c=c+1)kb[m.approved[c]]=m.approved[c];else kb.test="test";sb="";for(c=0;c<m.indent;c=c+1)sb=sb+" ";ob=E={};pa=r={"(scope)":E,"(breakage)":0,"(loopage)":0};wb=[r];Ca=false;pb={};Ya=false;y=null;Da=false;rb=[];Ea={};Bb=false;Fa=null;Lb=true;Cb=false;Q=null;xa=false;ca=[];Ha=null;Db=0;v="";fb.init(a);e();try{k();if(g.id==="(number)")n("unexpected_a");else if(g.value.charAt(0)==="<"){a:{var u,o,q,s,A=m.white,t,w,B,F;v="html";da="";for(Q=
null;;){switch(g.value){case "<":v="html";k("<");o={};w=g;w.identifier||f("bad_name_a",w);s=w.value;m.cap&&(s=s.toLowerCase());w.name=s;k();if(!Q){Q=[];c=s;c!=="html"&&!m.fragment&&(c==="div"&&m.adsafe?n("adsafe_fragment"):n("expected_a_b",p,"html",c));if(m.adsafe){c==="html"&&n("adsafe_html",p);m.fragment?c!=="div"&&n("adsafe_div",p):n("adsafe_fragment",p)}m.browser=true}B=Ab[s];typeof B!=="object"&&n("unrecognized_tag_a",w,s);q=B.empty;for(w.type=s;;){if(g.id==="/"){k("/");g.id!==">"&&f("expected_a_b",
g,">",g.value);break}if(g.id&&g.id.charAt(0)===">")break;if(!g.identifier){(g.id==="(end)"||g.id==="(error)")&&f("expected_a_b",g,">",g.value);f("bad_name_a")}m.white=false;J();u=g.value;m.white=A;k();!m.cap&&u!==u.toLowerCase()&&f("attribute_case_a",p);u=u.toLowerCase();da="";Object.prototype.hasOwnProperty.call(o,u)&&f("duplicate_a",p,u);if(u.slice(0,2)==="on"){m.on||f("html_handlers");v="scriptstring";k("=");t=g.id;t!=='"'&&t!=="'"&&n("expected_a_b",g,'"',g.value);da=t;F=m.white;m.white=true;k(t);
Pa();Ka();m.white=F;g.id!==t&&n("expected_a_b",g,t,g.value);v="html";da="";k(t);B=false}else if(u==="style"){v="scriptstring";k("=");t=g.id;t!=='"'&&t!=="'"&&n("expected_a_b",g,'"',g.value);v="styleproperty";da=t;k(t);Gb();v="html";da="";k(t);B=false}else if(g.id==="="){k("=");B=g.value;!g.identifier&&g.id!=='"'&&g.id!=="'"&&g.id!=="(string)"&&g.id!=="(string)"&&g.id!=="(color)"&&f("expected_attribute_value_a",p,u);k()}else B=true;o[u]=B;c=u;h=B;var x=j=void 0;if(c==="id"){j=typeof h==="string"?h.toUpperCase():
"";pb[j]===true&&f("duplicate_a",g,h);if(/^[A-Za-z][A-Za-z0-9._:\-]*$/.test(h)){if(m.adsafe)if(ka)h.slice(0,ka.length)!==ka?f("adsafe_prefix_a",g,ka):/^[A-Z]+_[A-Z]+$/.test(h)||f("adsafe_bad_id");else{ka=h;/^[A-Z]+_$/.test(h)||f("adsafe_bad_id")}}else f("bad_id_a",g,h);x=h.search(fc);x>=0&&f("unexpected_char_a_b",p,h.charAt(x),c);pb[j]=true}else if(c==="class"||c==="type"||c==="name"){x=h.search(hc);x>=0&&f("unexpected_char_a_b",p,h.charAt(x),c);pb[j]=true}else if(c==="href"||c==="background"||c===
"content"||c==="data"||c.indexOf("src")>=0||c.indexOf("url")>=0){m.safe&&Nb.test(h)&&n("bad_url",g,h);ca.push(h)}else c==="for"?m.adsafe&&(ka?h.slice(0,ka.length)!==ka?f("adsafe_prefix_a",g,ka):/^[A-Z]+_[A-Z]+$/.test(h)||f("adsafe_bad_id"):f("adsafe_bad_id")):c==="name"&&m.adsafe&&h.indexOf("_")>=0&&f("adsafe_name_a",g,h)}c=s;h=o;j=void 0;var D=Ab[c],I=x=void 0;Cb=false;D||n(G.unrecognized_tag_a,g,c===c.toLowerCase()?c:c+" (capitalization error)");if(Q.length>0){c==="html"&&n("unexpected_a",p,c);
if(I=D.parent)I.indexOf(" "+Q[Q.length-1].name+" ")<0&&n("tag_a_in_b",p,c,I);else if(!m.adsafe&&!m.fragment){j=Q.length;do{j<=0&&n("tag_a_in_b",p,c,"body");j=j-1}while(Q[j].name!=="body")}}switch(c){case "div":m.adsafe&&Q.length===1&&!ka&&f("adsafe_missing_id");break;case "script":v="script";k(">");h.lang&&f("lang",p);m.adsafe&&Q.length!==1&&f("adsafe_placement",p);if(h.src){m.adsafe&&(!eb||!kb[h.src])&&f("adsafe_source",p);h.type&&f("type",p)}else{O(g.from);C();Pa();La=true;x=Ka();if(m.adsafe){S&&
n("adsafe_script",p);(x.length!==1||M(x[0],"id","(")||M(x[0].first,"id",".")||M(x[0].first.first,"value","ADSAFE")||M(x[0].second[0],"value",ka))&&n("adsafe_id_go");switch(x[0].first.second.value){case "id":(eb||S||x[0].second.length!==1)&&n("adsafe_id",g);eb=true;break;case "go":S&&n("adsafe_go");(x[0].second.length!==2||M(x[0].second[1],"id","function")||!x[0].second[1].first||x[0].second[1].first.length!==2||M(x[0].second[1].first[0],"value","dom")||M(x[0].second[1].first[1],"value","lib"))&&n("adsafe_go",
g);S=true;break;default:n("adsafe_id_go")}}y=null}v="html";k("</");!g.identifier&&g.value!=="script"&&f("expected_a_b",g,"script",g.value);k();v="outer";break;case "style":v="style";k(">");db();v="html";k("</");!g.identifier&&g.value!=="style"&&f("expected_a_b",g,"style",g.value);k();v="outer";break;case "input":switch(h.type){case "radio":case "checkbox":case "button":case "reset":case "submit":break;case "text":case "file":case "password":case "file":case "hidden":case "image":m.adsafe&&h.autocomplete!==
"off"&&f("adsafe_autocomplete");break;default:f("bad_type")}break;case "applet":case "body":case "embed":case "frame":case "frameset":case "head":case "iframe":case "noembed":case "noframes":case "object":case "param":m.adsafe&&f("adsafe_tag",g,c)}q||Q.push(w);v="outer";k(">");break;case "</":v="html";k("</");g.identifier||f("bad_name_a");s=g.value;m.cap&&(s=s.toLowerCase());k();Q||n("unexpected_a",g,"</"+s+">");(w=Q.pop())||n("unexpected_a",g,"</"+s+">");w.name!==s&&n("expected_a_b",g,"</"+w.name+
">","</"+s+">");g.id!==">"&&n("expected_a_b",g,">",g.value);v="outer";k(">");break;case "<!":m.safe&&f("adsafe_a");for(v="html";;){k();if(g.id===">"||g.id==="(end)")break;g.value.indexOf("--")>=0&&n("unexpected_a",g,"--");g.value.indexOf("<")>=0&&n("unexpected_a",g,"<");g.value.indexOf(">")>=0&&n("unexpected_a",g,">")}v="outer";k(">");break;case "(end)":break a;default:g.id==="(end)"?n("missing_a",g,"</"+Q[Q.length-1].value+">"):k()}if(Q&&Q.length===0&&(m.adsafe||!m.fragment||g.id==="(end)"))break}g.id!==
"(end)"&&n("unexpected_a")}m.adsafe&&!S&&f("adsafe_go",this)}else switch(g.id){case "{":case "[":Da=true;ub();break;case "@":case "*":case "#":case ".":case ":":v="style";k();(p.id!=="@"||!g.identifier||g.value!=="charset"||p.line!==1||p.from!==1)&&n("css");k();g.id!=="(string)"&&g.value!=="UTF-8"&&n("css");k();ga();db();break;default:m.adsafe&&m.fragment&&n("expected_a_b",g,"<div>",g.value);O(1);g.id===";"&&!Bb&&ga();La=true;j=Ka();Jb.first=j;JAYLINT.tree=Jb;m.adsafe&&(j.length!==1||M(j[0],"id",
"(")||M(j[0].first,"id",".")||M(j[0].first.first,"value","ADSAFE")||M(j[0].first.second,"value","lib")||j[0].second.length!==2||j[0].second[0].id!=="(string)"||M(j[0].second[1],"id","function"))&&n("adsafe_lib");j.disrupt&&f("weird_program",la)}y=null;k("(end)")}catch(H){H&&JAYLINT.errors.push({reason:H.message,line:H.line||g.line,character:H.character||g.from},null)}return JAYLINT.errors.length===0};L.data=function(){var a={functions:[]},b,c,d,e,f,h=[],g=[];if(L.errors.length)a.errors=L.errors;if(Da)a.json=
true;if(ca.length>0)a.urls=ca;b=Object.keys(ob).filter(function(a){return a.charAt(0)!=="("?a:void 0});if(b.length>0)a.globals=b;for(c=1;c<wb.length;c=c+1){f=wb[c];b={};for(d=0;d<nb.length;d=d+1)b[nb[d]]=[];for(e in f)if(Object.prototype.hasOwnProperty.call(f,e)&&e.charAt(0)!=="("){d=f[e];if(d==="unction"||d==="unparam")d="unused";if(Array.isArray(b[d])){b[d].push(e);d==="unused"?g.push({name:e,line:f["(line)"],"function":f["(name)"]}):d==="undef"&&h.push({name:e,line:f["(line)"],"function":f["(name)"]})}}for(d=
0;d<nb.length;d=d+1)b[nb[d]].length===0&&delete b[nb[d]];b.name=f["(name)"];b.param=f["(params)"];b.line=f["(line)"];b["(complexity)"]=f["(complexity)"];a.functions.push(b)}if(g.length>0)a.unused=g;if(h.length>0)a.undef=h;for(e in Ea)if(typeof Ea[e]==="number"){a.member=Ea;break}return a};L.report=function(a){function b(a,c){var d,e;if(Array.isArray(c)){n.push("<div><i>"+a+"</i> ");c=c.sort().forEach(function(a){if(a!==e){e=a;n.push((d?", ":"")+e);d=true}});n.push("</div>")}else c&&n.push("<div><i>"+
a+"</i> "+c+"</div>")}var d=L.data(),e,f,h,g;f="";var j,n=[];if(d.errors||d.unused||d.undef){e=true;n.push("<div id=errors><i>Error:</i>");if(d.errors)for(h=0;h<d.errors.length;h=h+1)if(g=d.errors[h]){f=g.evidence||"";n.push("<p>Problem"+(isFinite(g.line)?" at line "+g.line+" character "+g.character:"")+": "+g.reason.entityify()+"</p><p class=evidence>"+(f&&(f.length>80?f.slice(0,77)+"...":f).entityify())+"</p>")}if(d.undef){f=[];for(h=0;h<d.undef.length;h=h+1)f[h]="<code><u>"+d.undef[h].name+"</u></code>&nbsp;<i>"+
d.undef[h].line+" </i> <small>"+d.undef[h]["function"]+"</small>";n.push("<p><i>Undefined variable:</i> "+f.join(", ")+"</p>")}if(d.unused){f=[];for(h=0;h<d.unused.length;h=h+1)f[h]="<code><u>"+d.unused[h].name+"</u></code>&nbsp;<i>"+d.unused[h].line+" </i> <small>"+d.unused[h]["function"]+"</small>";n.push("<p><i>Unused variable:</i> "+f.join(", ")+"</p>")}d.json&&n.push("<p>JSON: bad.</p>");n.push("</div>")}if(!a){n.push("<br><div id=functions>");d.urls&&b("URLs<br>",d.urls,"<br>");v==="style"?
n.push("<p>CSS.</p>"):d.json&&!e?n.push("<p>JSON: good.</p>"):d.globals?n.push("<div><i>Global</i> "+d.globals.sort().join(", ")+"</div>"):n.push("<div><i>No new global variables introduced.</i></div>");for(h=0;h<d.functions.length;h=h+1){e=d.functions[h];a=[];if(e.param)for(f=0;f<e.param.length;f=f+1)a[f]=e.param[f].value;n.push("<br><div class=function><i>"+e.line+"</i> "+e.name.entityify()+"("+a.join(", ")+")</div>");b("<big><b>Undefined</b></big>",e.undef);b("<big><b>Unused</b></big>",e.unused);
b("Closure",e.closure);b("Variable",e["var"]);b("Exception",e.exception);b("Outer",e.outer);b("Global",e.global);b("Label",e.label);b("Complexity",e["(complexity)"])}if(d.member){e=Object.keys(d.member);if(e.length){e=e.sort();f="<br><pre id=properties>/*properties ";g=13;for(h=0;h<e.length;h=h+1){a=e[h];j=$a.test(a)?a:"'"+a.entityify().replace(Mb,c)+"'";if(g+j.length>72){n.push(f+"<br>");f="    ";g=1}g=g+(j.length+2);d.member[a]===1&&(j="<i>"+j+"</i>");h<e.length-1&&(j=j+", ");f=f+j}n.push(f+"<br>*/</pre>")}n.push("</div>")}}return n.join("")};
L.jslint=L;L.edition="2012-05-01";return L}();
(function(a,b){function c(a,b){this.kind=h.property;Object.defineProperty(this,"definedBy",{value:b,enumerable:false,configurable:false,writable:false});if(a){if(typeof a==="function"){this.method=a;this.kind=h.method}else{this.configurable=this.enumerable=true;if(typeof a==="number"){this.value=a;this.dataType="integer"}else if(typeof a==="string"){this.value=a;this.dataType=typeof a}else for(var c in a)a.hasOwnProperty(c)&&(this[c]=a[c])}this.type!==void 0?this.dataType=this.dataType||this.type:
this.type=this.dataType}}function d(){}function e(){this.classNames={}}function h(){}function f(a,b){this.definedBy=a;this.initfunc=b}c.prototype.createPropertyDescriptor=function(a,b){var c=this,d={enumerable:this.enumerable==void 0?true:this.enumerable,configurable:this.configurable==void 0?true:this.configurable};if(this.set&&this.get){d.set=this.set;d.get=this.get}else if("value"in this||b){d.value=b||this.value;d.writable=true}else{d.set=function(a){this.storeProperty(c,a)};d.get=function(){return this.retrieveProperty(c)}}return d};
c.prototype.createStorePropertyDescriptor=function(a){return{enumerable:false,writable:true,configurable:this.configurable,value:a}};c.prototype.createGetMethod=function(){var a=this;return{enumerable:false,writable:false,configurable:false,value:function(b){return this.getProperty(a,b)}}};c.prototype.createSetMethod=function(){var a=this;return{enumerable:false,writable:false,configurable:false,value:function(b,c){return this.setProperty(a,b,c)}}};c.prototype.toJSON=function(){var a={},b;for(b in this)b!==
"defineBy"&&b!=="storageModel"&&(a[b]=this[b]);return a};a.MemberDefinition=window.MemberDefinition=c;d.prototype={clearCache:function(){this.propByTypeCache=this.keyPropsCache=this.pubMapPropsCache=this.arrayCache=void 0},asArray:function(){if(!this.arrayCache){this.arrayCache=[];for(var a in this)a.indexOf("$")===0&&this.arrayCache.push(this[a])}return this.arrayCache},getPublicMappedProperties:function(){if(!this.pubMapPropsCache){this.pubMapPropsCache=[];for(var a in this)a.indexOf("$")===0&&
this[a].kind=="property"&&!this[a].notMapped&&this[a].enumerable&&this.pubMapPropsCache.push(this[a])}return this.pubMapPropsCache},getKeyProperties:function(){if(!this.keyPropsCache){this.keyPropsCache=[];for(var a in this)a.indexOf("$")===0&&this[a].kind=="property"&&this[a].key&&this.keyPropsCache.push(this[a])}return this.keyPropsCache},getPropertyByType:function(a){if(!this.propByTypeCache){this.propByTypeCache=[];for(var b in this)b.indexOf("$")===0&&this[b].dataType==a&&this.propByTypeCache.push(this[b])}return this.propByTypeCache},
getMember:function(a){return this["$"+a]},setMember:function(a){this["$"+a.name]=a}};d.prototype.constructor=d;a.MemberDefinitionCollection=window.MemberDefinitionCollection=d;eval("function Base() { };");a.Base=Base;a.Base.fullName="$data.Base";if(!a.Base.name)a.Base.name="Base";a.Base.prototype.storeProperty=function(a,b){var c="_"+a.name;this[c]?this[c]=b:Object.defineProperty(this,c,a.createStorePropertyDescriptor(b))};a.Base.prototype.retrieveProperty=function(a){return this["_"+a.name]};a.Base.prototype.setProperty=
function(a,b,c){this[a.name]=b;c()};a.Base.prototype.getProperty=function(a,b){b.apply(this,[this[a.name]])};a.Base.extend=function(b,c,d){return a.Class.define(b,null,null,c,d)};h.__enum=true;h.method="method";h.property="property";h.navProperty="navProperty";h.complexProperty="complexProperty";h.field="field";a.MemberTypes=h;f.constructor="constructor";f.classConstructor="classConstructor";f.mixin="mixin";f.propagation="propagation";e.prototype={getClass:function(){},getProperties:function(a){return a.propertyDefinitions},
define:function(a,b,c,d,e){return this.defineEx(a,[{type:b}],c,d,e)},defineEx:function(b,c,d,e,f){if(c.length==0)c.push({type:a.Base});else if(c.length>0&&!c[0].type)c[0].type=a.Base;var d=b.split("."),h=d.splice(d.length-1,1)[0],s=window;d.forEach(function(a){s[a]||(s[a]={__namespace:true});s=s[a]});var o=null,o=this.classFunctionBuilder(h,c,f,e);o.fullName=b;o.namespace=d.join(".");this.buildType(o,c,e,f);o.name=h;Container.registerType(b,o);typeof intellisense!=="undefined"&&e&&e.constructor&&
intellisense.annotate(o,e.constructor);return s[h]=this.classNames[b]=o},classFunctionBuilder:function(a,b,c,d){return(new Function("base","classDefinition","instanceDefinition","return function "+a+" (){ "+this.bodyBuilder(b,c,d)+" \n}; "))(b,c,d)},bodyBuilder:function(a,b,c){for(var d=b="",e="",f=0,h=a.length;f<h;f++){var o=a[f],k=f;if(k==0){if(o&&o.type){d=d+("    var baseArguments = $data.typeSystem.createCtorParams(arguments, base["+k+"].params, this); \n");d=d+("    "+o.type.fullName+".apply(this, baseArguments); \n")}}else if(o&&
o.type&&o.propagateTo){e=e+("    "+(!e?"var ":"")+"propagationArguments = $data.typeSystem.createCtorParams(arguments, base["+k+"].params, this); \n");e=e+('    this["'+o.propagateTo+'"] =  Object.create('+o.type.fullName+".prototype); \n    "+o.type.fullName+'.apply(this["'+o.propagateTo+'"], propagationArguments); \n')}else o&&o.type&&o.type.memberDefinitions&&o.type.memberDefinitions.$constructor&&!o.propagateTo&&(b=b+("    "+o.type.fullName+".memberDefinitions.$constructor.method.apply(this); \n"))}c&&
c.constructor!=Object&&(d=d+"    instanceDefinition.constructor.apply(this, arguments); \n");return"\n    //mixins \n"+b+"\n    //construction \n"+d+"\n    //propagations \n"+e},buildType:function(b,c,e,f){var h=c[0].type;if(b.inheritsFrom=h){b.prototype=Object.create(h.prototype);b.memberDefinitions=Object.create(h.memberDefinitions||new d);b.memberDefinitions.clearCache();var A=h.staticDefinitions;if(A)if(A=A.asArray())for(var s=0;s<A.length;s++)this.buildMember(b,A[s],void 0,"staticDefinitions");
b.baseTypes=(h.baseTypes||[]).concat(c.map(function(a){return a.type}));b.isAssignableTo||Object.defineProperty(b,"isAssignableTo",{value:function(a){return this===a||this.baseTypes.indexOf(a)>=0},writable:false,enumerable:false,configurable:false})}if(f){this.buildStaticMembers(b,f);if(f.constructor)b.classConstructor=f.constructor}e&&this.buildInstanceMembers(b,e);c=[].concat(c);c.shift();Object.keys(c).length>0&&this.buildInstanceMixins(b,c);b.__class=true;b.prototype.constructor=b;Object.defineProperty(b.prototype,
"getType",{value:function(){return b},writable:false,enumerable:false,configurable:false});b.extend=function(c,d,e){return a.Class.define(c,b,null,d,e)};Object.defineProperty(b,"getMemberDefinition",{value:function(a){return b.memberDefinitions.getMember(a)}})},addMethod:function(a,b,c,d){a[b]=!d||typeof intellisense!=="undefined"?c:function(){return c.apply(this[d],arguments)}},addProperty:function(a,b,c,d){if(d){c.configurable=true;if(c.get){var e=c.get;c.get=function(){this[d]||Guard.raise(new Exception("not inicialized"));
return e.apply(this[d],arguments)}}if(c.set){var f=c.set;c.set=function(){this[d]||Guard.raise(new Exception("not inicialized"));f.apply(this[d],arguments)}}}Object.defineProperty(a,b,c)},addField:function(){Guard.raise("not implemented")},buildMethod:function(a,b,c){this.addMethod(b.classMember?a:a.prototype,b.name,b.method,c)},buildProperty:function(a,b,c){var d=b.classMember?a:a.prototype,e=b.createPropertyDescriptor(a);this.addProperty(d,b.name,e,c);if(!b.classMember&&a.__setPropertyfunctions==
true){a=b.createGetMethod();this.addProperty(d,"get_"+b.name,a,c);a=b.createSetMethod();this.addProperty(d,"set_"+b.name,a,c)}},buildMember:function(a,b,c,e){e=e||"memberDefinitions";a[e]=a[e]||new d;a[e].setMember(b);switch(b.kind){case h.method:this.buildMethod(a,b,c);break;case h.navProperty:case h.complexProperty:case h.property:this.buildProperty(a,b,c);break;default:Guard.raise("Unknown member type: "+b.kind+","+b.name)}},buildStaticMembers:function(a,b){for(var d in b)if(b.hasOwnProperty(d)){var e=
new c(b[d],a);e.name=d;e.classMember=true;this.buildMember(a,e,void 0,"staticDefinitions")}},buildInstanceMembers:function(a,b){for(var d in b)if(b.hasOwnProperty(d)){var e=new c(b[d],a);e.name=d;this.buildMember(a,e)}},copyMembers:function(a,b){Object.keys(a.prototype).forEach(function(c){if(c!=="constructor"&&c!=="toString"){typeof intellisense!=="undefined"&&intellisense.logMessage("copying item:"+c);b.prototype[c]=a[c]}})},buildInstanceMixins:function(a,b){a.mixins=a.mixins||[];a.propagations=
a.propagations||[];for(var c=0;c<b.length;c++){var d=b[c];if(d.propagateTo){this.buildInstancePropagation(a,d);a.propagations.push(d);a.propagations[d.type.name]=true}else{this.buildInstanceMixin(a,d);a.mixins.push(d);a.mixins[d.type.name]=true}}},buildInstanceMixin:function(a,b){for(var c=b.type.memberDefinitions.asArray(),d=0,e=c.length;d<e;d++){var f=c[d].name;f!=="constructor"&&!a.memberDefinitions.getMember(f)&&this.buildMember(a,c[d])}},buildInstancePropagation:function(a,b){for(var c=b.type.memberDefinitions.asArray(),
d=0,e=c.length;d<e;d++){var f=c[d].name;f!=="constructor"&&!a.memberDefinitions.getMember(f)&&this.buildMember(a,c[d],b.propagateTo)}}};a.Class=Class=new e;(function(b){a.Number=typeof Number!=="undefined"?Number:function(){};a.Integer=typeof Integer!=="undefined"?Integer:function(){};a.Date=typeof Date!=="undefined"?Date:function(){};a.String=typeof String!=="undefined"?String:function(){};a.Boolean=typeof Boolean!=="undefined"?Boolean:function(){};a.Blob=function(){};a.Array=typeof Array!=="undefined"?
Array:function(){};a.Object=typeof Object!=="undefined"?Object:function(){};a.Function=Function;b.Container=a.Container=b=b.C$=new function(){var b={},c=[],d=[];this.classNames=b;this.consolidatedClassNames=c;this.classTypes=d;var e=[];this.mappedTo=e;var f=this;this.holder=null;this.mapType=function(a,b){Guard.requireValue("aliasType",a);Guard.requireValue("realType",b);var c=this.getType(a),f=this.getType(b),c=d.indexOf(c),f=d.indexOf(f);e[c]=f};this.resolve=function(a,b){return new (this.resolveType(a,
b))(b)};this.resolveName=function(a){a=this.resolveType(a);a=d.indexOf(a);return c[a]};this.isPrimitiveType=function(b){b=this.resolveType(b);return b===Number||b===String||b===Date||b===String||b===Boolean||b===Array||b===Object||b===a.Number||b===a.String||b===a.Date||b===a.String||b===a.Boolean||b===a.Array||b===a.Object};this.resolveType=function(a){var a=this.getType(a),b=d.indexOf(a);return typeof e[b]==="undefined"?a:d[e[b]]};this.getTypes=function(){return Object.keys(b).map(function(a){return{name:a,
type:d[b[a]],toString:function(){return this.name}}})};this.getTypeName=function(a){switch(typeof a){case "object":if(a==null)return"$data.Object";if(a instanceof Array)return"$data.Array";if(a.getType)return a.getType().fullName;if(a instanceof Date)return"$data.Date";default:return typeof a}};this.isTypeRegistered=function(a){return typeof a==="function"?d.indexOf(a)>-1:a in b};this.unregisterType=function(){Guard.raise("Unimplemented")};this.getType=function(a){Guard.requireValue("typeOrName",
a);if(typeof a==="function")return a;a in b||Guard.raise(new Exception("Unable to resolve type:"+a));return d[b[a]]};this.getName=function(a){var b=this.getType(a),b=d.indexOf(b);b==-1&&Guard.raise("unknown type to request name for: "+a);return c[b]};this.getDefault=function(b){switch(this.resolveType(b)){case a.Number:return 0;case a.Integer:return 0;case a.String:return"";case a.Boolean:return false;default:return null}};this.registerType=function(a,e,h){if(a){typeof e==="string"&&(e=f.resolveType(e));
if(typeof a==="string"){var j=[];j.push(a);a=j}for(j=0;j<a.length;j++){var M=a[j].split("."),C={};C.shortName=M[M.length-1];C.fullName=a[j];a[j]=C}M=function(){var a=arguments,b=f.resolveType(e),c=Object.create(b.prototype);b.apply(c,a);return c};typeof intellisense!=="undefined"&&intellisense.annotate(M,e);for(var j=0,O=a.length;j<O;j++){C=a[j];"create"+C.shortName in f?console&&console.warn("warning: short names overlap:"+C.shortName+", Container.create"+C.shortName+" has not been updated"):f["create"+
C.shortName]=typeof h==="function"?h:M;var F=d.indexOf(e);if(F==-1){F=d.push(e)-1;c[F]=C.fullName}C.fullName in b&&console.warn("warning:!!! This typename has already been registered:"+C.fullName);b[C.fullName]=F}if(!e.name)e.name=a[0].shortName}}};b.registerType(["$data.Number","number","float","real","decimal"],a.Number);b.registerType(["$data.Integer","int","integer","int16","int32","int64"],a.Integer);b.registerType(["$data.String","string","text","character"],a.String);b.registerType(["$data.Array",
"array","Array","[]"],a.Array,function(){return a.Array.apply(void 0,arguments)});b.registerType(["$data.Date","datetime","date"],a.Date);b.registerType(["$data.Boolean","bool","boolean"],a.Boolean);b.registerType(["$data.Blob","blob"],a.Blob);b.registerType(["$data.Object","Object","object"],a.Object);b.registerType(["$data.Function","Function","function"],a.Function)})(window);b.$C=function(){Class.define.apply(Class,arguments)};a.Class.ConstructorParameter=ConstructorParameter=a.Class.define("ConstructorParameter",
null,null,{constructor:function(a){this.paramIndex=a},paramIndex:{}})})($data,window);$data.defaultErrorCallback=function(){Guard.raise(new Exception("DEFAULT ERROR CALLBACK!","DefaultError",arguments))};$data.defaultSuccessCallback=function(){console.log("DEFAULT SUCCES CALLBACK")};$data.defaultNotifyCallback=function(){console.log("DEFAULT NOTIFY CALLBACK")};
$data.typeSystem={__namespace:!0,extend:function(a){typeof a!=="object"&&Guard.raise("Target must be object");for(var b=1;b<arguments.length;b++){var c=arguments[b];if(!(c===null||typeof c==="undefined"))for(key in c)a[key]=c[key]}return a},createCallbackSetting:function(a,b){var c={success:$data.defaultSuccessCallback,error:$data.defaultErrorCallback,notify:$data.defaultNotifyCallback};b!=void 0&&b!=null&&(c=b);return a==null||a==void 0?c:typeof a=="function"?this.extend(c,{success:a}):this.extend(c,
a)},createCtorParams:function(a,b,c){if(b){for(var d=[],e=0,h=b.length;e<h;e++){var f=e;b[f]instanceof ConstructorParameter?d.push(a[b[f].paramIndex]):typeof b[f]==="function"?d.push(b[f].apply(c)):d.push(b[f])}return d}return a},writePropertyValues:function(a){a&&a.getType&&a.getType().memberDefinitions&&this.writeProperties(a,a.getType().memberDefinitions.asArray().filter(function(a){return(a.kind=="property"||a.kind=="navProperty"||a.kind=="complexProperty")&&!a.prototypeProperty}))},writeProperties:function(a,
b){for(var c={},d=0,e=b.length;d<e;d++){var h=b[d];c[h.name]=h.createPropertyDescriptor(null,h.value)}Object.defineProperties(a,c)},writeProperty:function(a,b,c){if(b=typeof b==="string"?a.getType().memberDefinitions.getMember(b):b){c=b.createPropertyDescriptor(null,c);Object.defineProperty(a,b.name,c)}}};function ASTNode(){}function FunctionASTNode(){}FunctionASTNode.prototype=new ASTNode;function ParameterASTNode(){}function MemberAccessASTNode(){}MemberAccessASTNode.prototype=new ASTNode;
function ConstantASTNode(){}function ASTParserResult(a,b,c){this.success=b!="";this.result=a;this.tree=b;this.errors=c}function ASTParser(){}ASTParser.parseCode=function(a){var b;if(!a||(b=a.toString())==="")return new ASTParserResult(false,null,null);typeof JAYLINT==="undefined"&&Guard.raise(new Exception("JAYLINT is required","Not Found!"));a=JAYLINT(b);return new ASTParserResult(a,JAYLINT.tree,JAYLINT.errors)};$data.Class.define("$data.Expressions.ExpressionType",null,null,{},{});
var ExpressionType=$data.Expressions.ExpressionType;ExpressionType.Constant="constant";ExpressionType.Variable="variable";ExpressionType.MemberAccess="memberAccess";ExpressionType.Call="call";ExpressionType.Equal="equal";ExpressionType.NotEqual="notEqual";ExpressionType.EqualTyped="equalTyped";ExpressionType.NotEqualTyped="notEqualTyped";ExpressionType.GreaterThen="greaterThan";ExpressionType.LessThen="lessThan";ExpressionType.GreaterThenOrEqual="greaterThanOrEqual";
ExpressionType.LessThenOrEqual="lessThenOrEqual";ExpressionType.Or="or";ExpressionType.OrBitwise="orBitwise";ExpressionType.And="and";ExpressionType.AndBitwise="andBitwise";ExpressionType.In="in";ExpressionType.Add="add";ExpressionType.Divide="divide";ExpressionType.Multiply="multiply";ExpressionType.Subtract="subtract";ExpressionType.Modulo="modulo";ExpressionType.ArrayIndex="arrayIndex";ExpressionType.New="new";ExpressionType.Positive="positive";ExpressionType.Negative="negative";
ExpressionType.Increment="increment";ExpressionType.Decrement="decrement";ExpressionType.Not="not";ExpressionType.This="this";ExpressionType.LambdaParameterReference="lambdaParameterReference";ExpressionType.LambdaParameter="lambdaParameter";ExpressionType.Parameter="parameter";ExpressionType.ArrayLiteral="arrayLiteral";ExpressionType.ObjectLiteral="objectLiteral";ExpressionType.ObjectField="objectField";ExpressionType.Function="Function";ExpressionType.Unknown="UNKNOWN";
ExpressionType.EntitySet="EntitySet";ExpressionType.ServiceOperation="ServiceOperation";ExpressionType.EntityField="EntityField";ExpressionType.EntityContext="EntityContext";ExpressionType.Entity="Entity";ExpressionType.Filter="Filter";ExpressionType.First="First";ExpressionType.Count="Count";ExpressionType.Single="Single";ExpressionType.Some="Some";ExpressionType.Every="Every";ExpressionType.ToArray="ToArray";ExpressionType.ForEach="ForEach";ExpressionType.Projection="Projection";
ExpressionType.EntityMember="EntityMember";ExpressionType.EntityFieldOperation="EntityFieldOperation";ExpressionType.FrameOperation="FrameOperation";ExpressionType.EntityBinary="EntityBinary";ExpressionType.Code="Code";ExpressionType.ParametricQuery="ParametricQuery";ExpressionType.MemberInfo="MemberInfo";ExpressionType.QueryParameter="QueryParameter";ExpressionType.ComplexEntityField="ComplexEntityField";ExpressionType.Take="Take";ExpressionType.Skip="Skip";ExpressionType.OrderBy="OrderBy";
ExpressionType.OrderByDescending="OrderByDescending";ExpressionType.Include="Include";ExpressionType.Count="Count";$data.Expressions.ExpressionType=ExpressionType;function BinaryOperator(){}
var binaryOperators=[{operator:"==",expressionType:ExpressionType.Equal,type:"boolean",implementation:function(a,b){return a==b}},{operator:"===",expressionType:ExpressionType.EqualTyped,type:"boolean",implementation:function(a,b){return a===b}},{operator:"!=",expressionType:ExpressionType.NotEqual,type:"boolean",implementation:function(a,b){return a!=b}},{operator:"!==",expressionType:ExpressionType.NotEqualTyped,type:"boolean",implementation:function(a,b){return a!==b}},{operator:">",expressionType:ExpressionType.GreaterThen,
type:"boolean",implementation:function(a,b){return a>b}},{operator:">=",expressionType:ExpressionType.GreaterThenOrEqual,type:"boolean",implementation:function(a,b){return a>=b}},{operator:"<=",expressionType:ExpressionType.LessThenOrEqual,type:"boolean",implementation:function(a,b){return a<=b}},{operator:"<",expressionType:ExpressionType.LessThen,type:"boolean",implementation:function(a,b){return a<b}},{operator:"&&",expressionType:ExpressionType.And,type:"boolean",implementation:function(a,b){return a&&
b}},{operator:"||",expressionType:ExpressionType.Or,type:"boolean",implementation:function(a,b){return a||b}},{operator:"&",expressionType:ExpressionType.AndBitwise,type:"number",implementation:function(a,b){return a&b}},{operator:"|",expressionType:ExpressionType.OrBitwise,type:"number",implementation:function(a,b){return a|b}},{operator:"+",expressionType:ExpressionType.Add,type:"number",implementation:function(a,b){return a+b}},{operator:"-",expressionType:ExpressionType.Subtract,type:"number",
implementation:function(a,b){return a-b}},{operator:"/",expressionType:ExpressionType.Divide,type:"number",implementation:function(a,b){return a/b}},{operator:"%",expressionType:ExpressionType.Modulo,type:"number",implementation:function(a,b){return a%b}},{operator:"*",expressionType:ExpressionType.Multiply,type:"number",implementation:function(a,b){return a*b}},{operator:"[",expressionType:ExpressionType.ArrayIndex,type:"number",implementation:function(a,b){return a[b]}},{operator:"in",expressionType:ExpressionType.In,
type:"boolean",implementation:function(a,b){return a in b}}];binaryOperators.resolve=function(a){if(binaryOperators.filter(function(b){return b.operator==a}).length>0)return a};binaryOperators.contains=function(a){return binaryOperators.some(function(b){return b.operator==a})};binaryOperators.getOperator=function(a){var b=binaryOperators.filter(function(b){return b.operator==a});b.length<1&&Guard.raise("Unknown operator: "+a);return b[0]};
var unaryOperators=[{operator:"+",arity:"prefix",expressionType:ExpressionType.Positive,type:"number",implementation:function(a){return+a}},{operator:"-",arity:"prefix",expressionType:ExpressionType.Negative,type:"number",implementation:function(a){return-a}},{operator:"++",arity:"prefix",expressionType:ExpressionType.Increment,type:"number",implementation:function(a){return++a}},{operator:"--",arity:"prefix",expressionType:ExpressionType.Decrement,type:"number",implementation:function(a){return--a}},
{operator:"++",arity:"suffix",expressionType:ExpressionType.Increment,type:"number",implementation:function(a){return a++}},{operator:"!",arity:"prefix",expressionType:ExpressionType.Not,type:"boolean",implementation:function(a){return!a}},{operator:"--",arity:"suffix",expressionType:ExpressionType.Decrement,type:"number",implementation:function(a){return a--}}];unaryOperators.resolve=function(a){if(unaryOperators.filter(function(b){return b.operator==a}).length>0)return a};
unaryOperators.contains=function(a){return unaryOperators.some(function(b){return b.operator==a})};unaryOperators.getOperator=function(a,b){var c=unaryOperators.filter(function(c){return c.operator==a&&(!b||c.arity==b)});c.length<1&&Guard.raise("Unknown operator: "+a);return c[0]};function timeIt(a,b){b=b||1;console.time("!");for(var c=0;c<b;c++)a();console.timeEnd("!")}
var UNARY="UNARY",INCDEC="INCDEC",DECISION="DECISION",METHODCALL="METHODCALL",NEW="NEW",JSONASSIGN="JSONASSIGN",ARRAYACCESS="ARRAYACCESS",UNKNOWN="UNKNOWN",executable=!0;function jsonify(a){return JSON.stringify(a,null,"\t")}
$C("$data.Expressions.ExpressionNode",$data.Entity,null,{constructor:function(){this.expressionType=this.constructor},getJSON:function(){return jsonify(this)},expressionType:{value:void 0,set:function(a){var b;Object.defineProperty(this,"expressionType",{set:function(a){typeof a==="string"&&(a=Container.resolveType(a));b=a},get:function(a){return arguments.callee.caller==jsonify||arguments.callee.caller==JSON.stringify?Container.resolveName(b):b},enumerable:true});this.expressionType=a},get:function(){},
enumerable:!0},nodeType:{value:ExpressionType.Unknown,writable:!1},type:{},isTerminated:{value:!1},toString:function(){return this.value}},null);$C("$data.Expressions.UnaryExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b,c,d){this.operand=a;this.operator=b;this.nodeType=c;this.resolution=d},operator:{value:void 0,writable:!0},operand:{value:void 0,writable:!0},nodeType:{value:void 0,writable:!0}});
$C("$data.Expressions.ArrayLiteralExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a){this.items=a||[]},nodeType:{value:ExpressionType.ArrayLiteral,writable:!0},items:{value:void 0,dataType:Array,elementType:$data.Expressions.ExpressionNode},toString:function(){return"["+this.items.map(function(a){return a.toString()}).join(",")+"]"}},null);
$C("$data.Expressions.CallExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b,c){this.expression=a;this.member=b;this.args=c},nodeType:{value:ExpressionType.Call},expression:{value:void 0,dataType:$data.Expressions.ExpressionNode,writable:!0},member:{value:void 0,dataType:$data.MemberDefinition,writable:!0},type:{value:void 0,writable:!0},implementation:{get:function(){return function(a,b,c){typeof b!=="function"&&(b=a[b]);Guard.requireType("method",b,Function);return b.apply(a,
c)}},set:function(){Guard.raise("Property can not be set")}},toString:function(){return this.object.toString()+"."+this.member.toString()+"()"}});
$C("$data.Expressions.CodeParser",null,null,{constructor:function(a){this.scopeContext=a;this.lambdaParams=[]},log:function(a){this.scopeContext&&this.scopeContext.log(a)},parseExpression:function(a){typeof a==="object"&&(a="");var b={success:true,errorMessage:"",errorDetails:""},a=ASTParser.parseCode(a);this.log({event:"AST",data:a});if(!a.success)return{success:false,error:"ASTParser error",errorMessage:a.errors?JSON.stringify(a.errors):"could not get code"};return b={success:true,expression:this.Build2(a.tree.first[0]),
errors:a.errors}},createExpression:function(a,b){var c=this.parseExpression(a,b);c.success||Guard.raise("ExpressionParserError: "+c.errorMessage);return c.expression},Build2:function(a){var b;switch(a.arity){case "number":case "string":b=this.BuildConstant(a);break;case "prefix":switch(a.value){case "{":b=this.BuildObjectLiteral(a);break;case "[":b=this.BuildArrayLiteral(a);break;case unaryOperators.resolve(a.value):b=this.BuildUnary(a)}break;case "suffix":switch(a.value){case unaryOperators.resolve(a.value):b=
this.BuildUnary(a);break;default:Guard.raise("Unknown suffix: "+a.value)}break;case "infix":switch(a.value){case "[":b=this.BuildArray(a);break;case binaryOperators.resolve(a.value):b=this.BuildSimpleBinary(a);break;case "function":Guard.raise("Unexpected function arity");case "(":b=this.BuildCall(a);break;case ".":b=this.BuildProperty(a);break;default:debugger}break;case "statement":switch(a.value){case "function":b=this.BuildFunction(a)}break;default:switch(a.value){case "function":b=this.BuildFunction(a);
break;case "true":case "false":case "null":b=this.BuildConstant(a);break;case "this":b=this.BuildThis(a);break;default:b=this.BuildParameter(a)}}return b},BuildThis:function(){return Container.createThisExpression()},BuildConstant:function(a){var b=a.value,c=a.type;if(a.reserved===true)switch(a.value){case "true":b=true;c="boolean";break;case "false":b=false;c="boolean";break;case "null":b=null;c="object"}return new $data.Expressions.ConstantExpression(b,c)},BuildFunctionParameter:function(){},BuildArray:function(a){switch(a.second.type){case "string":return this.BuildProperty(a);
default:return this.BuildSimpleBinary(a)}},BuildParameter:function(a){var b=a.funct?ExpressionType.LambdaParameter:this.lambdaParams.indexOf(a.value)>-1?ExpressionType.LambdaParameterReference:ExpressionType.Parameter,c=new $data.Expressions.ParameterExpression(a.value,null,b);if(b==ExpressionType.LambdaParameterReference)c.paramIndex=this.lambdaParams.indexOf(a.value);return c},BuildArrayLiteral:function(a){var b=this,a=a.first.map(function(a){return b.Build2(a)});return new $data.Expressions.ArrayLiteralExpression(a)},
BuildObjectLiteral:function(a){var b=this,a=a.first.map(function(a){var d=b.Build2(a.first);return new $data.Expressions.ObjectFieldExpression(a.value,d)});return new $data.Expressions.ObjectLiteralExpression(a)},BuildFunction:function(a){var b=this,c=a.first&&a.first.map(function(a){this.lambdaParams.push(a.value);return b.BuildParameter(a)},this),c=c||[],d=a.block.length==0?false:a.block[0].value==="return"?true:false,d=a.block.length>0?this.Build2(d?a.block[0].first:a.block[0]):null;[].forEach(function(){this.lambdaParams.pop()},
this);var e=new $data.Expressions.FunctionExpression(a.value,c,d);c.forEach(function(a){Object.defineProperty(a,"owningFunction",{value:e,enumerable:false})});e.name=a.name;return e},BuildCall:function(a){var b=this,c=b.Build2(a.first),a=a.second.map(function(a){return b.Build2(a)}),d,e;switch(true){case c instanceof $data.Expressions.PropertyExpression:e=c.expression;d=c.member;break;case c instanceof $data.Expressions.ParameterExpression:e=Container.createConstantExpression(null,"object");d=c}return Container.createCallExpression(e,
d,a)},BuildProperty:function(a){var b=this.Build2(a.first),a=a.second.identifier?new $data.Expressions.ConstantExpression(a.second.value,"string"):this.Build2(a.second);return new $data.Expressions.PropertyExpression(b,a)},BuildUnary:function(a){var b=unaryOperators.getOperator(a.value,a.arity),c=b.expressionType,a=this.Build2(a.first);return new $data.Expressions.UnaryExpression(a,b,c)},BuildSimpleBinary:function(a){var b=binaryOperators.getOperator(a.value),c=b.expressionType,d=this.Build2(a.first||
a.left),e=this.Build2(a.second||a.right);return new $data.Expressions.SimpleBinaryExpression(d,e,c,a.value,b.type)}});$C("$data.Expressions.ConstantExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b,c){this.value=a;this.type=Container.getTypeName(a);this.name=c},nodeType:{value:ExpressionType.Constant,enumerable:!0},type:{value:Object,writable:!0},value:{value:void 0,writable:!0},toString:function(){return this.value.toString()}});
$C("$data.Expressions.FunctionExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b,c){this.parameters=b||[];this.name=a;this.body=c},toString:function(a){var b=this.parameters.map(function(a){return a.toString()}),b=b.join(","),a=this.body?this.body.toString(a):"";return"function "+this.name+"("+b+") { "+a+"}"},nodeType:{value:ExpressionType.Function,writable:!0},parameters:{value:void 0,dataType:Array,elementType:$data.Expressions.ParameterExpression},body:{value:void 0,dataType:$data.Expressions.ExpressionNode},
type:{}},null);$C("$data.Expressions.ObjectFieldExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b){this.fieldName=a;this.expression=b},nodeType:{value:ExpressionType.ObjectField,writable:!0},toString:function(){return"unimplemented"}},null);
$C("$data.Expressions.ObjectLiteralExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a){this.members=a},nodeType:{value:ExpressionType.ObjectLiteral,writable:!0},toString:function(){return"unimplemented"},implementation:{get:function(){return function(a){var b={};a.forEach(function(a){b[a.name]=a.value});return b}},set:function(){}}},null);
$C("$data.Expressions.PagingExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b,c){this.source=a;this.amount=b;this.nodeType=c},nodeType:{value:ExpressionType.Unknown,writable:!0},toString:function(){return"unimplemented"}},null);
$C("$data.Expressions.ParameterExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b,c){this.nodeType=c||ExpressionType.Parameter;this.name=a;this.type=b||"unknown"},owningFunction:{value:void 0,enumerable:!1},nodeType:{value:ExpressionType.Parameter,writable:!0},name:{value:void 0,dataType:String,writable:!0},type:{value:void 0,dataType:"object",writable:!0},toString:function(a){a=a?this.type+" ":"";return a=a+this.name}},null);
$C("$data.Expressions.PropertyExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b){Object.defineProperty(this,"expression",{value:a,enumerable:true});Object.defineProperty(this,"member",{value:b,enumerable:true});this.type=b.dataType},nodeType:{value:ExpressionType.MemberAccess},expression:{value:void 0,dataType:$data.Expressions.ExpressionNode,writable:!0},implementation:{get:function(){return function(a,b){a[b]===void 0&&Guard.raise(new Exception("Parameter '"+b+"' not found in context",
"Property not found!"));return a[b]}},set:function(){}},member:{value:void 0,dataType:$data.MemberDefinition,writable:!0},type:{value:void 0,writable:!0},toString:function(){return this.expression.toString()+"."+this.member.toString()}});
$C("$data.Expressions.SimpleBinaryExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b,c,d,e,h){this.left=a;this.right=b;this.nodeType=c;this.operator=d;this.type=e;this.resolution=h},implementation:{get:function(){return binaryOperators.getOperator(this.operator).implementation},set:function(){}},type:{value:"number",writable:!0}});$C("$data.Expressions.ThisExpression",$data.Expressions.ExpressionNode,null,{nodeType:{value:ExpressionType.This}});
$C("$data.Expressions.ExpressionVisitor",null,null,{constructor:function(){this._deep=0},Visit:function(a,b){if(!a)return a;var c=null;switch(a.expressionType){case $data.Expressions.ParameterExpression:c=this.VisitParameter(a,b);break;case $data.Expressions.ConstantExpression:c=this.VisitConstant(a,b);break;case $data.Expressions.FunctionExpression:c=this.VisitFunction(a,b);break;case $data.Expressions.CallExpression:c=this.VisitCall(a,b);break;case $data.Expressions.SimpleBinaryExpression:c=this.VisitBinary(a,
b);break;case $data.Expressions.PropertyExpression:c=this.VisitProperty(a,b);break;case $data.Expressions.ThisExpression:c=this.VisitThis(a,b);break;case $data.Expressions.ObjectLiteralExpression:c=this.VisitObjectLiteral(a,b);break;case $data.Expressions.ObjectFieldExpression:c=this.VisitObjectField(a,b);break;case $data.Expressions.ArrayLiteralExpression:c=this.VisitArrayLiteral(a,b);break;case $data.Expressions.UnaryExpression:c=this.VisitUnary(a,b);break;default:debugger}this._deep=this._deep-
1;return c},VisitArrayLiteral:function(a,b){var c=this,d=a.items.map(function(a){return c.Visit(a,b)});return Container.createArrayLiteralExpression(d)},VisitObjectLiteral:function(a,b){var c=this,d=a.members.map(function(a){return c.Visit(a,b)});return Container.createObjectLiteralExpression(d)},VisitObjectField:function(a,b){var c=this.Visit(a.expression,b);return Container.createObjectFieldExpression(a.fieldName,c)},VisitThis:function(a){return a},VisitCall:function(a,b){var c=a.args.map(function(a){return this.Visit(a,
b)},this),d=this.Visit(a.expression,b),e=this.Visit(a.member,b);return new $data.Expressions.CallExpression(d,e,c)},VisitParameter:function(a){return a},VisitConstant:function(a){return a},VisitFunction:function(a,b){var c=this,d=a.parameters.map(function(a){return c.Visit(a,b)}),e=c.Visit(a.body,b);return new $data.Expressions.FunctionExpression(a.name,d,e)},VisitBinary:function(a,b){var c=this.Visit(a.left,b),d=this.Visit(a.right,b);return new $data.Expressions.SimpleBinaryExpression(c,d,a.nodeType,
a.operator,a.type)},VisitProperty:function(a,b){var c=this.Visit(a.expression,b),d=this.Visit(a.member,b);return new $data.Expressions.PropertyExpression(c,d)},VisitUnary:function(a,b){var c=this.Visit(a.operand,b);return c===a.operand?a:new $data.Expressions.UnaryExpression(c,a.operator,a.nodeType)},VisitDecision:function(a,b){var c=this.Visit(a.expression,b),d=this.Visit(a.left,b),e=this.Visit(a.right,b);return c===a.expression&&d===a.left&&e===a.right?a:$data.Expressions.ExpressionNodeTypes.DecisionExpressionNode.create(a.executable,
c,d,e)},VisitNew:function(a,b){var c=this.VisitArray(a.values,b);return c===a.values?a:$data.Expressions.ExpressionNodeTypes.NewExpressionNode.create(true,c)},VisitArrayAccess:function(a,b){var c=this.Visit(a.array,b),d=this.Visit(a.index,b);return c===a.array&&d===a.index?a:$data.Expressions.ExpressionNodeTypes.ArrayAccessExpressionNode.create(true,c,d)},VisitArray:function(a,b){for(var c=[],d=true,e=0;e<a.length;e++){c[e]=this.Visit(a[e],b);d=d&&c[e]===a[e]}return d?a:c},GetMemberChain:function(a,
b){if(a.expression.type==MEMBERACCESS){var c=this.GetMemberChain(a.expression,b);c.push(a.member);return c}return[a.expression,a.member]}},{});
$C("$data.Expressions.ParameterProcessor",$data.Expressions.ExpressionVisitor,null,{constructor:function(){},Visit:function(a,b){if((a instanceof $data.Expressions.ParameterExpression||a instanceof $data.Expressions.ThisExpression)&&this.canResolve(a)){var c=this.resolve(a,b);if(c!==a)c.resolvedBy=this.constructor.name;return c}return a},canResolve:function(){Guard.raise("Pure method")},resolve:function(){Guard.raise("Pure method")}});
$C("$data.Expressions.GlobalContextProcessor",$data.Expressions.ParameterProcessor,null,{constructor:function(a){this.global=a},canResolve:function(a){return a.nodeType==$data.Expressions.ExpressionType.Parameter&&a.name in this.global},resolve:function(a){var b=this.global[a.name];return Container.createConstantExpression(b,typeof b,a.name)}});
$C("$data.Expressions.ConstantValueResolver",$data.Expressions.ParameterProcessor,null,{constructor:function(a,b){this.globalResolver=Container.createGlobalContextProcessor(b);this.paramsObject=a},canResolve:function(a){return a.nodeType==$data.Expressions.ExpressionType.This&&this.paramsObject?true:this.globalResolver.canResolve(a)},resolve:function(a){return a.nodeType==$data.Expressions.ExpressionType.This?Container.createConstantExpression(this.paramsObject,typeof this.paramsObject,"this"):this.globalResolver.resolve(a)}});
$C("$data.Expressions.LocalContextProcessor",$data.Expressions.GlobalContextProcessor,null,{constructor:function(a){this.canResolve=function(b){return b.nodeType==$data.Expressions.ExpressionType.Parameter&&a("typeof "+b.name)!=="undefined"};this.resolve=function(b){b=a(b.name);return Container.createConstantExpression(b,typeof b)}}});
$C("$data.Expressions.LambdaParameterProcessor",$data.Expressions.ParameterProcessor,null,{constructor:function(a){var b={};this.canResolve=function(c){if(c.nodeType==$data.Expressions.ExpressionType.LambdaParameter){var d=c.owningFunction.parameters;if(d.length==1&&c.name==d[0].name){b[c.name]=a[0];return true}for(var e=0;e<d.length;e++)if(d[e].name==c.name){b[c.name]=a[e];return true}}return false};this.resolve=function(a){var d=Container.createParameterExpression(a.name,b[a.name],$data.Expressions.ExpressionType.LambdaParameter);
Object.defineProperty(d,"owningFunction",{value:a.owningFunction,enumerable:false});return d}}});
$C("$data.Expressions.ParameterResolverVisitor",$data.Expressions.ExpressionVisitor,null,{constructor:function(){this.lambdaParamCache={}},Visit:function(a,b){return $data.Expressions.ExpressionVisitor.prototype.Visit.call(this,a,b)},VisitArrayLiteral:function(a,b){var c=this,d=a.items.map(function(a){return c.Visit(a,b)});if(d.every(function(a){return a instanceof $data.Expressions.ConstantExpression})){d=d.map(function(a){return a.value});return Container.createConstantExpression(d,"array")}return Container.createArrayLiteralExpression(d)},
VisitObjectLiteral:function(a,b){var c=this,d=a.members.map(function(a){return c.Visit(a,b)});if(d.every(function(a){return a.expression instanceof $data.Expressions.ConstantExpression})){d=d.map(function(a){return{name:a.fieldName,value:a.expression.value}});return Container.createConstantExpression(a.implementation(d))}return Container.createObjectLiteralExpression(d)},VisitThis:function(a,b){return b.Visit(a,b)},VisitParameter:function(a,b){var c;switch(a.nodeType){case $data.Expressions.ExpressionType.Parameter:case $data.Expressions.ExpressionType.LambdaParameter:c=
b.Visit(a,b);c.nodeType==$data.Expressions.ExpressionType.LambdaParameter&&(this.lambdaParamCache[c.name]=c);return c;case $data.Expressions.ExpressionType.LambdaParameterReference:if(c=this.lambdaParamCache[a.name]){c=Container.createParameterExpression(a.name,c.type,$data.Expressions.ExpressionType.LambdaParameterReference);c.paramIndex=a.paramIndex;return c}}return a},VisitConstant:function(a){return a},VisitFunction:function(a,b){var c=this,d=a.parameters.map(function(a){return c.Visit(a,b)}),
e=c.Visit(a.body,b);return new $data.Expressions.FunctionExpression(a.name,d,e)},VisitBinary:function(a,b){var c=this.Visit(a.left,b),d=this.Visit(a.right,b),e=$data.Expressions;if(c instanceof e.ConstantExpression&&d instanceof e.ConstantExpression){c=a.implementation(c.value,d.value);return Container.createConstantExpression(c)}return new Container.createSimpleBinaryExpression(c,d,a.nodeType,a.operator,a.type)},VisitUnary:function(a,b){var c=this.Visit(a.operand,b);if(c instanceof $data.Expressions.ConstantExpression){c=
a.operator.implementation(c.value);return Container.createConstantExpression(c)}return new Container.createUnaryExpression(c,a.operator,a.nodeType)},VisitProperty:function(a,b){var c=this.Visit(a.expression,b),d=this.Visit(a.member,b),e;if(c instanceof $data.Expressions.ConstantExpression&&d instanceof $data.Expressions.ConstantExpression){e=a.implementation(c.value,d.value);return Container.createConstantExpression(e,typeof e,c.name+"$"+d.value)}if(c===a.expression&&d===a.member)return a;return e=
Container.createPropertyExpression(c,d)},VisitCall:function(a,b){var c=$data.Expressions.ExpressionVisitor.prototype.VisitCall.apply(this,arguments),d=c.expression,e=c.member,h=c.args;if(function(a,b,c){return b instanceof $data.Expressions.ConstantExpression&&(!c||c instanceof $data.Expressions.ConstantExpression)&&a.every(function(a){return a instanceof $data.Expressions.ConstantExpression})}(h,e,d)){c=e.value;typeof c==="string"&&d.value&&(c=d.value[c]);typeof c!=="function"&&Guard.raise("Constant expression is not a method...");
d=a.implementation(d.value,c,h);return new $data.Expressions.ConstantExpression(d)}return c}},{});$C("$data.Expressions.AggregatedVisitor",$data.Expressions.ExpressionVisitor,null,{constructor:function(a){this.Visit=function(b,c){for(var d=0;d<a.length;d++){var e=a[d].Visit(b,c);if(e!==b)return e}return b}}});
$C("$data.Expressions.LogicalSchemaBinderVisitor",$data.Expressions.ExpressionVisitor,null,{constructor:function(){},VisitProperty:function(a,b){var c=this.Visit(a.expression,b),d=this.Visit(a.member,b),e=b.memberResolver.resolve(c.type,d.value);d.type=e;return Container.createPropertyExpression(c,d)}},{});
$data.Class.define("$data.Expressions.ExpTreeVisitor",null,null,{constructor:function(){this._deep=0},Visit:function(a,b){this._deep=this._deep+1;var c=null;switch(a.type){case LITERAL:c=this.VisitLiteral(a,b);break;case VARIABLE:c=this.VisitVariable(a,b);break;case MEMBERACCESS:c=this.VisitMember(a,b);break;case BINARY:c=this.VisitBinary(a,b);break;case UNARY:c=this.VisitUnary(a,b);break;case INCDEC:c=this.VisitIncDec(a,b);break;case EQUALITY:c=this.VisitEquality(a,b);break;case DECISION:c=this.VisitDecision(a,
b);break;case METHODCALL:c=this.VisitMethodCall(a,b);break;case NEW:c=this.VisitNew(a,b);break;case JSONASSIGN:c=this.VisitJsonAssign(a,b);break;case ARRAYACCESS:c=this.VisitArrayAccess(a,b);break;default:Guard.raise("Type isn't implemented: "+a.type)}this._deep=this._deep-1;return c},VisitLiteral:function(a){return a},VisitVariable:function(a){return a},VisitMember:function(a,b){var c=this.Visit(a.expression,b),d=this.Visit(a.member,b);return c===a.expression&&d===a.member?a:$data.Expressions.ExpressionNodeTypes.MemberAccessExpressionNode.create(a.executable,
c,d)},VisitBinary:function(a,b){var c=this.Visit(a.left,b),d=this.Visit(a.right,b);return c===a.left&&d===a.right?a:$data.Expressions.ExpressionNodeTypes.BinaryExpressionNode.create(a.executable,a.operator,c,d)},VisitUnary:function(a,b){var c=this.Visit(a.operand,b);return c===a.operand?a:$data.Expressions.ExpressionNodeTypes.UnaryExpressionNode.create(a.executable,a.operator,c)},VisitIncDec:function(a,b){var c=this.Visit(a.operand,b);return c===a.operand?a:$data.Expressions.ExpressionNodeTypes.IncDecExpressionNode.create(a.executable,
a.operator,c,a.suffix)},VisitEquality:function(a,b){var c=this.Visit(a.left,b),d=this.Visit(a.right,b);return c===a.left&&d===a.right?a:$data.Expressions.ExpressionNodeTypes.EqualityExpressionNode.create(a.executable,a.operator,c,d)},VisitDecision:function(a,b){var c=this.Visit(a.expression,b),d=this.Visit(a.left,b),e=this.Visit(a.right,b);return c===a.expression&&d===a.left&&e===a.right?a:$data.Expressions.ExpressionNodeTypes.DecisionExpressionNode.create(a.executable,c,d,e)},VisitMethodCall:function(a,
b){var c=a.object?this.Visit(a.object,b):null,d=this.VisitArray(a.args,b);return c===a.object&&d===a.args?a:$data.Expressions.ExpressionNodeTypes.MethodcallExpressionNode.create(a.executable,c,a.method,d)},VisitNew:function(a,b){var c=this.VisitArray(a.values,b);return c===a.values?a:$data.Expressions.ExpressionNodeTypes.NewExpressionNode.create(true,c)},VisitJsonAssign:function(a,b){var c=this.Visit(a.left,b),d=this.Visit(a.right,b);if(c===a.left&&d===a.right)return a;c.JSONASSIGN=true;d.JSONASSIGN=
true;return $data.Expressions.ExpressionNodeTypes.JsonAssignExpressionNode.create(true,c,d)},VisitArrayAccess:function(a,b){var c=this.Visit(a.array,b),d=this.Visit(a.index,b);return c===a.array&&d===a.index?a:$data.Expressions.ExpressionNodeTypes.ArrayAccessExpressionNode.create(true,c,d)},VisitArray:function(a,b){for(var c=[],d=true,e=0;e<a.length;e++){c[e]=this.Visit(a[e],b);d=d&&c[e]===a[e]}return d?a:c},GetMemberChain:function(a,b){if(a.expression.type==MEMBERACCESS){var c=this.GetMemberChain(a.expression,
b);c.push(a.member);return c}return[a.expression,a.member]}},{});
$data.Class.define("$data.Expressions.SetExecutableVisitor",$data.Expressions.ExpTreeVisitor,null,{Visit:function(a,b){switch(a.type){case LITERAL:return this.VisitLiteral(a,b);case VARIABLE:return this.VisitVariable(a,b);case MEMBERACCESS:return this.VisitMember(a,b);case BINARY:return this.VisitBinary(a,b);case UNARY:return this.VisitUnary(a,b);case INCDEC:return this.VisitIncDec(a,b);case EQUALITY:return this.VisitEquality(a,b);case DECISION:return this.VisitDecision(a,b);case METHODCALL:return this.VisitMethodCall(a,
b);case NEW:return this.VisitNew(a,b);case JSONASSIGN:return this.VisitJsonAssign(a,b);case ARRAYACCESS:return this.VisitArrayAccess(a,b);default:Guard.raise("Type isn't implemented: "+a.type)}},VisitBinary:function(a,b){var c=this.Visit(a.left,b),d=this.Visit(a.right,b);return c===a.left&&d===a.right&&c.executable&&d.executable==a.executable?a:$data.Expressions.ExpressionNodeTypes.BinaryExpressionNode.create(c.executable&&d.executable,a.operator,c,d)},VisitUnary:function(a,b){var c=this.Visit(a.operand,
b);return c===a.operand?a:$data.Expressions.ExpressionNodeTypes.UnaryExpressionNode.create(c.executable,a.operator,c)},VisitIncDec:function(a,b){var c=this.Visit(a.operand,b);return c===a.operand?a:$data.Expressions.ExpressionNodeTypes.IncDecExpressionNode.create(c.executable,a.operator,c,a.suffix)},VisitEquality:function(a,b){var c=this.Visit(a.left,b),d=this.Visit(a.right,b);return c===a.left&&d===a.right&&c.executable&&d.executable==a.executable?a:$data.Expressions.ExpressionNodeTypes.EqualityExpressionNode.create(c.executable&&
d.executable,a.operator,c,d)},VisitDecision:function(a,b){var c=this.Visit(a.expression,b),d=this.Visit(a.left,b),e=this.Visit(a.right,b);return c===a.expression&&d===a.left&&e===a.right&&d.executable&&e.executable&&c.executable==a.executable?a:$data.Expressions.ExpressionNodeTypes.DecisionExpressionNode.create(d.executable&&e.executable&&c.executable,c,d,e)},VisitMethodCall:function(a,b){var c=a.object?this.Visit(a.object,b):null,d=this.VisitArray(a.args,b);return c===a.object&&d===a.args&&(c==null?
true:c.executable)==a.executable?a:$data.Expressions.ExpressionNodeTypes.MethodcallExpressionNode.create(c==null?true:c.executable,c,a.method,d)},VisitNew:function(a,b){var c=this.VisitArray(a.values,b);return c===a.values?a:$data.Expressions.ExpressionNodeTypes.NewExpressionNode.create(true,c)},VisitJsonAssign:function(a,b){var c=this.Visit(a.left,b),d=this.Visit(a.right,b);if(c===a.left&&d===a.right)return a;c.JSONASSIGN=true;d.JSONASSIGN=true;return $data.Expressions.ExpressionNodeTypes.JsonAssignExpressionNode.create(true,
c,d)},VisitArrayAccess:function(a,b){var c=this.Visit(a.array,b),d=this.Visit(a.index,b);return c===a.array&&d===a.index?a:$data.Expressions.ExpressionNodeTypes.ArrayAccessExpressionNode.create(true,c,d)},VisitArray:function(a,b){for(var c=[],d=true,e=0;e<a.length;e++){c[e]=this.Visit(a[e],b);d=d&&c[e]===a[e]}return d?a:c},VisitLiteral:function(a){return{type:a.type,executable:true,value:a.value,valueType:a.valueType}},VisitVariable:function(a,b){typeof b.paramContext[a.name]==void 0&&Guard.raise("Variable is not defined in the paramContext: "+
a.name);return $data.Expressions.ExpressionNodeTypes.VariableExpressionNode.create(true,"Math","GLOBALOBJECT")},VisitMember:function(a,b){var c=this.GetMemberChain(a)[0].name,d=b.lambdaParams.indexOf(c)>=0,e=c==b.paramsName;!e&&!d&&Guard.raise("Variable is not defined in the paramContext or the lambda parameters: "+c);return $data.Expressions.ExpressionNodeTypes.MemberAccessExpressionNode.create(e,a.expression,a.member)}},null);
$data.Class.define("$data.Expressions.ExecutorVisitor",$data.Expressions.ExpTreeVisitor,null,{VisitVariable:function(a,b){if(!a.executable)return a;var c=a.name==b.paramsName?b.paramContext:window[a.name];typeof c=="undefined"&&Guard.raise(new Exception("Unknown variable in '"+b.operation+"' operation. The variable isn't referenced in the parameter context and it's not a global variable: '"+a.name+"'.","InvalidOperation",{operationName:b.operation,missingParameterName:a.name}));return $data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(true,
typeof c,c)},VisitMember:function(a,b){if(!a.executable)return a;for(var c=this.GetMemberChain(a),d,e=0;e<c.length;e++)d=e==0?b.paramContext:d[c[e].name];return $data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(true,typeof d,d)},VisitUnary:function(a,b){var c=this.Visit(a.operand,b);c!==a.operand&&(a=$data.Expressions.ExpressionNodeTypes.UnaryExpressionNode.create(a.executable,a.operator,c));if(!a.executable)return a;eval("value = "+a.operator+" "+(c.valueType=="string"?"'"+c.value+
"'":c.value));return $data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(true,"undefined",void 0)},VisitIncDec:function(a,b){var c=this.Visit(a.operand,b);c!==a.operand&&(a=$data.Expressions.ExpressionNodeTypes.IncDecExpressionNode.create(a.executable,a.operator,c,a.suffix));if(!a.executable)return a;c=a.suffix?a.operator=="++"?c.value++:c.value--:a.operator=="++"?++c.value:--c.value;return $data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(true,typeof c,c)},VisitBinary:function(a,
b){var c=this.Visit(a.left,b),d=this.Visit(a.right,b);if(c!==a.left||d!==a.right)a=$data.Expressions.ExpressionNodeTypes.BinaryExpressionNode.create(a.executable,a.operator,c,d);if(!a.executable)return a;eval("value = "+(c.valueType=="string"?"'"+c.value+"'":c.value)+" "+a.operator+" "+(d.valueType=="string"?"'"+d.value+"'":d.value));return $data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(true,"undefined",void 0)},VisitEquality:function(a,b){var c=this.Visit(a.left,b),d=this.Visit(a.right,
b);if(c!==a.left||d!==a.right)a=$data.Expressions.ExpressionNodeTypes.EqualityExpressionNode.create(a.executable,a.operator,c,d);if(!a.executable)return a;eval("value = "+(c.valueType=="string"?"'"+c.value+"'":c.value)+" "+a.operator+" "+(d.valueType=="string"?"'"+d.value+"'":d.value));return $data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(true,"undefined",void 0)},VisitDecision:function(a,b){var c=this.Visit(a.expression,b),d=this.Visit(a.left,b),e=this.Visit(a.right,b);if(c!==
a.expression||d!==a.left||e!==a.right)a=$data.Expressions.ExpressionNodeTypes.DecisionExpressionNode.create(a.executable,c,d,e);if(!a.executable)return a;c=c.value?d.value:e.value;return $data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(true,typeof c,c)},VisitMethodCall:function(a,b){var c=a.object?this.Visit(a.object,b):null,d=this.VisitArray(a.args,b);if(c!==a.object||d!=a.args)a=$data.Expressions.ExpressionNodeTypes.MethodcallExpressionNode.create(a.executable,c,a.method,d);if(!a.executable)return a;
for(var e=[],h=0;h<d.length;h++){var f=d[h];e.push(typeof f.value=="string"?"'"+f.value+"'":f.value)}c=c?"value = object.value[eNode.method]("+e.join(",")+");":"value = "+a.method+"("+e.join(",")+");";eval(c);return $data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(true,"undefined",void 0)},VisitArrayAccess:function(a,b){var c=this.Visit(a.array,b),d=this.Visit(a.index,b),c=c.value[d.value];return $data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(true,typeof c,c)}},
null);
$data.Class.define("$data.Expressions.ExpressionBuilder",null,null,{constructor:function(a){this.context=a},_isLambdaParam:function(a){for(var b=this.context.lambdaParams,c=0;c<b.length;c++)if(b[c]==a)return true;return false},_isParam:function(a){return this.context.paramContext[a]!=void 0},_isParamRoot:function(a){return this.context.paramsName==a},Build:function(a,b){var c;switch(a.arity){case "infix":"("==a.value?c=this.BuildMethodCall(a,b):"."==a.value?c=this.BuildMember(a,b):["===","==","!==",
"!=",">","<",">=","<="].indexOf(a.value)>=0?c=this.BuildEquality(a,b):["&&","||"].indexOf(a.value)>=0?c=this.BuildBinary(a,b):["+","-","*","/","%"].indexOf(a.value)>=0?c=this.BuildBinary(a,b):"["==a.value?c=this.BuildArrayAccess(a,b):Guard.raise("Value of infix node isn't implemented: "+a.value);break;case "prefix":["+","-","!"].indexOf(a.value)>=0?c=this.BuildUnary(a,b):["++","--"].indexOf(a.value)>=0?c=this.BuildIncDec(a,b):"{"==a.value?c=this.BuildNewExpression(a,b):Guard.raise("Value of prefix node isn't implemented: "+
a.value);break;case "suffix":["++","--"].indexOf(a.value)>=0?c=this.BuildIncDec(a,b):Guard.raise("Value of suffix node isn't implemented: "+a.value);break;case "string":case "number":c=this.BuildLiteral(a,b);break;case "ternary":a.value=="?"?c=this.BuildDecision(a,b):Guard.raise("Value of ternary node isn't implemented: "+a.value);break;case null:case void 0:c=a.type=="boolean"&&(a.value=="true"||a.value=="false")?this.BuildBoolLiteral(a,b):this.BuildVariable(a,b);break;default:Guard.raise("Arity isn't implemented: "+
a.arity)}return c},BuildNewExpression:function(a){for(var b=$data.Expressions.ExpressionNodeTypes.NewExpressionNode.create(true,[]),a=a.first,c=0;c<a.length;c++)b.values.push(this.Build(a[c],b));return b},BuildLiteral:function(a){return $data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(true,a.arity,a.value)},BuildBoolLiteral:function(a){return $data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(true,a.type,a.value=="true"?true:false)},BuildVariable:function(a,b){if(!a.first){if(b.type==
MEMBERACCESS){var c;c=this._isLambdaParam(a.value)?"LAMBDAPARAM":this._isParamRoot(a.value)?"PARAMETERROOT":this._isParam(a.value)?"PARAMETER":"PROPERTY"}else this._isLambdaParam(a.value)?c="LAMBDAPARAM":this._isParamRoot(a.value)?c="PARAMETERROOT":this._isParam(a.value)?c="PARAMETER":window[a.value]!=void 0?c="GLOBALOBJECT":Guard.raise(new Exception("Unknown variable in '"+this.context.operation+"' operation. The variable isn't referenced in the parameter context and it's not a global variable: '"+
a.value+"'.","InvalidOperation",{operationName:this.context.operation,missingParameterName:a.value}));return $data.Expressions.ExpressionNodeTypes.VariableExpressionNode.create(true,a.value,c)}c=$data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(true,"name",a.value);var d=$data.Expressions.ExpressionNodeTypes.JsonAssignExpressionNode.create(true),e=this.Build(a.first,d);d.left=c;d.right=e;c.JSONASSIGN=true;e.JSONASSIGN=true;return d},BuildMember:function(a){if(a.value!="."||a.arity!=
"infix")return a.type=="string"?$data.Expressions.ExpressionNodeTypes.LiteralExpressionNode.create(true,a.arity,a.value):$data.Expressions.ExpressionNodeTypes.MemberAccessExpressionNode.create(true,null,a.value);var b=$data.Expressions.ExpressionNodeTypes.MemberAccessExpressionNode.create(true),c=this.Build(a.first,b),a=this.Build(a.second,b);b.expression=c;b.member=a;return b},BuildUnary:function(a){var b=$data.Expressions.ExpressionNodeTypes.UnaryExpressionNode.create(true,a.value);b.operand=this.Build(a.first,
b);return b},BuildIncDec:function(a){var b=$data.Expressions.ExpressionNodeTypes.IncDecExpressionNode.create(true,a.value,null,a.arity=="suffix");b.operand=this.Build(a.first,b);return b},BuildBinary:function(a){a.first||Guard.raise("Cannot build binary: node.first is null");a.second||Guard.raise("Cannot build binary: node.second is null");var b=$data.Expressions.ExpressionNodeTypes.BinaryExpressionNode.create(true,a.value);b.left=this.Build(a.first,b);b.right=this.Build(a.second,b);return b},BuildEquality:function(a){var b=
$data.Expressions.ExpressionNodeTypes.EqualityExpressionNode.create(true,a.value);b.left=this.Build(a.first,b);b.right=this.Build(a.second,b);return b},BuildDecision:function(a){var b=$data.Expressions.ExpressionNodeTypes.DecisionExpressionNode.create(true);b.expression=this.Build(a.first,b);b.left=this.Build(a.second,b);b.right=this.Build(a.third,b);return b},BuildMethodCall:function(a){var b=$data.Expressions.ExpressionNodeTypes.MethodcallExpressionNode.create(true);if(a.first.type=="function"){b.object=
this.Build(a.first.first,b);b.method=a.first.second.value}else{a.first.type!=null&&Guard.raise("Cannot build MethodCall because type is "+type);b.object=null;b.method=a.first.value}for(var a=a.second,c=[],d=0;d<a.length;d++)c[d]=this.Build(a[d],b);b.args=c;return b},BuildArrayAccess:function(a){var b=$data.Expressions.ExpressionNodeTypes.ArrayAccessExpressionNode.create(true);b.array=this.Build(a.first,b);b.index=this.Build(a.second,b);return b}},null);
$C("$data.Expressions.AssociationInfoExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a){this.associationInfo=a},nodeType:{value:$data.Expressions.ExpressionType.AssociationInfo,enumerable:!0}});
$C("$data.Expressions.CodeExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b){Container.resolveType(Container.getTypeName(a))==$data.String&&a.replace(/^[\s\xA0]+/,"").match("^function")!="function"&&(a="function (it) { return "+a+"; }");this.source=a;this.parameters=b},nodeType:{value:$data.Expressions.ExpressionType.Code,enumerable:!0}});
$C("$data.Expressions.CodeToEntityConverter",$data.Expressions.ExpressionVisitor,null,{constructor:function(a){this.scopeContext=a;this.parameters=[]},VisitBinary:function(a,b){var c=this.Visit(a.left,b),d=this.Visit(a.right,b),e=this.scopeContext.resolveBinaryOperator(a.nodeType,a,b.frameType);return Container.createSimpleBinaryExpression(c,d,a.nodeType,a.operator,a.type,e)},VisitUnary:function(a,b){var c=this.Visit(a.operand,b),d=this.scopeContext.resolveUnaryOperator(a.nodeType,a,b.frameType);
return Container.createUnaryExpression(c,a.operator,a.nodeType,d)},VisitParameter:function(a,b){Guard.requireValue("context",b);var c=$data.Expressions.ExpressionType;switch(a.nodeType){case c.LambdaParameterReference:return Container.createEntityExpression(b.lambdaParameters[a.paramIndex],{lambda:a.name});case c.LambdaParameter:break;default:Guard.raise("Global parameter "+a.name+" not found. For query parameters use 'this.field' notation")}},VisitThis:function(a,b){var c=this.parameters.push({name:"",
value:void 0})-1;return Container.createQueryParameterExpression("",c,b.queryParameters,void 0)},VisitFunction:function(a,b){return $data.Expressions.ExpressionVisitor.prototype.VisitFunction.apply(this,arguments).body},VisitCall:function(a,b){var c=this,d=this.Visit(a.expression,b),e=this.Visit(a.member,b),h=a.args.map(function(a){return c.Visit(a,b)});switch(true){case d instanceof $data.Expressions.QueryParameterExpression:h=h.map(function(a){return a.value});h=a.implementation(d.value,e.value,
h);return Container.createQueryParameterExpression(d.name+"$"+e.value,d.index,h,typeof h);case d instanceof $data.Expressions.EntityFieldExpression:case d instanceof $data.Expressions.EntityFieldOperationExpression:var f=this.scopeContext.resolveFieldOperation(e.value,d,b.frameType);f||Guard.raise("Unknown entity field operation: "+e.getJSON());e=Container.createMemberInfoExpression(f);return h=Container.createEntityFieldOperationExpression(d,e,h);case d instanceof $data.Expressions.EntitySetExpression:(f=
this.scopeContext.resolveSetOperations(e.value,d,b.frameType))||Guard.raise("Unknown entity field operation: "+e.getJSON());e=Container.createMemberInfoExpression(f);return h=Container.createFrameOperationExpression(d,e,h);default:Guard.raise("VisitCall: Only fields can have operations: "+a.getType().name)}},VisitProperty:function(a,b){var c=this.Visit(a.expression,b),d=this.Visit(a.member,b);Guard.requireType("member",d,$data.Expressions.ConstantExpression);switch(c.expressionType){case $data.Expressions.EntityExpression:var e=
c.getMemberDefinition(d.value);e||Guard.raise(new Exception("Unknown member: "+d.value,"MemberNotFound"));switch(e.storageModel.PhysicalType.memberDefinitions.getMember(e.name).kind){case "property":d=Container.createMemberInfoExpression(e);return c=Container.createEntityFieldExpression(c,d);case "navProperty":d=e.storageModel.Associations[e.name];c=Container.createEntitySetExpression(c,Container.createAssociationInfoExpression(d));return d.ToMultiplicity!=="*"?Container.createEntityExpression(c,
{}):c;case "complexProperty":d=Container.createMemberInfoExpression(e);return c=Container.createComplexTypeExpression(c,d)}case $data.Expressions.ComplexTypeExpression:(e=c.getMemberDefinition(d.value))||Guard.raise("Unknown member "+d.value+" on "+c.entityType.name);d=Container.createMemberInfoExpression(e);if(Container.isPrimitiveType(Container.resolveType(e.dataType)))return c=Container.createEntityFieldExpression(c,d);return c=Container.createComplexTypeExpression(c,d);case $data.Expressions.QueryParameterExpression:e=
a.implementation(c.value,d.value);this.parameters[c.index].name=this.parameters[c.index].name+("$"+d.value);this.parameters[c.index].value=e;return Container.createQueryParameterExpression(c.name+"$"+d.value,c.index,e,Container.getTypeName(e));case $data.Expressions.EntityFieldExpression:case $data.Expressions.EntityFieldOperationExpression:(e=this.scopeContext.resolveFieldOperation(d.value,c,b.frameType))||Guard.raise("Unknown entity field operation: "+d.getJSON());d=Container.createMemberInfoExpression(e);
return c=Container.createEntityFieldOperationExpression(c,d,[]);default:Guard.raise("Unknown expression type to handle: "+c.expressionType.name)}}});
$C("$data.Expressions.ComplexTypeExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b){Guard.requireType("source",a,[$data.Expressions.EntityExpression,$data.Expressions.ComplexTypeExpression]);Guard.requireType("selector",b,[$data.Expressions.EntityExpression,$data.Expressions.MemberInfoExpression]);this.source=a;this.selector=b;var c=a.entityType.getMemberDefinition(b.memberName).dataType;this.entityType=Container.resolveType(c)},getMemberDefinition:function(a){return this.entityType.getMemberDefinition(a)},
nodeType:{value:$data.Expressions.ExpressionType.Com}});$C("$data.Expressions.EntityContextExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a){Object.defineProperty(this,"instance",{value:a,enumerable:false})},nodeType:{value:$data.Expressions.ExpressionType.EntityContext,enumerable:!0}});
$C("$data.Expressions.EntityExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b){Guard.requireValue("source",a);Guard.requireValue("selector",b);!(a instanceof $data.Expressions.EntitySetExpression)&&!(a instanceof $data.Expressions.ServiceOperationExpression)&&Guard.raise("Only EntitySetExpressions can be the source for an EntityExpression");this.source=a;this.selector=b;this.entityType=this.source.elementType;this.storageModel=this.source.storageModel;Guard.requireValue("entityType",
this.entityType);Guard.requireValue("storageModel",this.storageModel)},getMemberDefinition:function(a){var b=this.entityType.getMemberDefinition(a);b||Guard.raise(new Exception("Unknown member "+a+" on type "+this.entityType.name,"MemberNotFound"));b.storageModel=this.storageModel;return b},nodeType:{value:$data.Expressions.ExpressionType.Entity}});
$C("$data.Expressions.EntityExpressionVisitor",null,null,{constructor:function(){this.lambdaTypes=[]},canVisit:function(a){return a instanceof $data.Expressions.ExpressionNode},Visit:function(a,b){if(!this.canVisit(a))return a;var c="Visit"+a.getType().name;if(c in this){c=this[c].call(this,a,b);return typeof c==="undefined"?a:c}return a},VisitToArrayExpression:function(a,b){var c=this.Visit(a.source,b);return c!==a.source?Container.createToArrayExpression(c):a},VisitForEachExpression:function(a,
b){var c=this.Visit(a.source,b);return c!==a.source?Container.createForEachExpression(c):a},VisitMemberInfoExpression:function(a){return a},VisitSingleExpression:function(a,b){var c=this.Visit(a.source,b);return c!==a.source?Container.createSingleExpression(c):a},VisitFirstExpression:function(a,b){var c=this.Visit(a.source,b);return c!==a.source?Container.createFirstExpression(c):a},VisitSomeExpression:function(a,b){var c=this.Visit(a.source,b);return c!==a.source?Container.createSomeExpression(c):
a},VisitEveryExpression:function(a,b){var c=this.Visit(a.source,b);return c!==a.source?Container.createEveryExpression(c):a},VisitCountExpression:function(a,b){var c=this.Visit(a.source,b);return c!==a.source?Container.createCountExpression(c):a},VisitObjectLiteralExpression:function(a,b){for(var c=a.members.map(function(a){return this.Visit(a,b)},this),d=true,e=0;e<a.members.length;e++)d=d&&a.members[e]===c[e];return!d?Container.createObjectLiteralExpression(c):a},VisitObjectFieldExpression:function(a,
b){var c=this.Visit(a.expression,b);return a.expression!==c?Container.createObjectFieldExpression(a.fieldName,c):a},VisitIncludeExpression:function(a,b){var c=this.Visit(a.source,b);return c!==a.source?Container.createIncludeExpression(c,a.selector):a},VisitUnaryExpression:function(a,b){var c=this.Visit(a.operand,b);return a.operand!==c?Container.createUnaryExpression(c,a.operator,a.nodeType,a.resolution):a},VisitSimpleBinaryExpression:function(a,b){var c=this.Visit(a.left,b),d=this.Visit(a.right,
b);return c!==a.left||d!==a.right?new $data.Expressions.SimpleBinaryExpression(c,d,a.nodeType,a.operator,a.type,a.resolution):a},VisitEntityContextExpression:function(a){return a},VisitCodeExpression:function(a){return a},VisitComplexTypeExpression:function(a,b){var c=this.Visit(a.source,b),d=this.Visit(a.selector,b);return c!==a.source||d!==a.selector?Container.createComplexTypeExpression(c,d):a},VisitEntityExpression:function(a,b){var c=this.Visit(a.source,b),d=this.Visit(a.selector,b);return c!==
a.source||d!==a.selector?Container.createEntityExpression(c,d):a},VisitEntityFieldExpression:function(a,b){var c=this.Visit(a.source,b),d=this.Visit(a.selector,b);return c!==a.source||d!==a.selector?Container.createEntityFieldExpression(c,d):a},VisitEntityFieldOperationExpression:function(a,b){var c=this.Visit(a.source,b),d=this.Visit(a.operation,b),e=a.parameters.map(function(a){return this.Visit(a)},this);return Container.createEntityFieldOperationExpression(c,d,e)},VisitParametricQueryExpression:function(a,
b){var c=this.Visit(a.expression,b),d=a.parameters.map(function(a){return this.Visit(a)},this);return Container.createParametricQueryExpression(c,d)},VisitEntitySetExpression:function(a,b){var c=this.Visit(a.source,b),d=this.Visit(a.selector,b);return c!==a.source||d!==a.selector?Container.createEntitySetExpression(c,d,a.params,a.instance):a},VisitFilterExpression:function(a,b){var c=this.Visit(a.source,b),d=this.Visit(a.selector,b);return c!==a.source||d!==a.selector?Container.createFilterExpression(c,
d,a.params,a.instance):a},VisitProjectionExpression:function(a,b){var c=this.Visit(a.source,b),d=this.Visit(a.selector,b);return c!==a.source||d!==a.selector?Container.createProjectionExpression(c,d,a.params,a.instance):a},VisitOrderExpression:function(a,b){var c=this.Visit(a.source,b),d=this.Visit(a.selector,b);return c!==a.source||d!==a.selector?Container.createOrderExpression(c,d,a.nodeType):a},VisitPagingExpression:function(a,b){var c=this.Visit(a.source,b),d=this.Visit(a.amount,b);return c!==
a.source||d!==a.amount?Container.createPagingExpression(c,d,a.nodeType):a}});$C("$data.Expressions.EntityFieldExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b){this.selector=b;this.source=a;if(this.selector instanceof $data.Expressions.MemberInfoExpression||this.selector.name)this.memberName=this.selector.name},nodeType:{value:$data.Expressions.ExpressionType.EntityField}});
$C("$data.Expressions.EntityFieldOperationExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b,c){this.source=a;this.operation=b;this.parameters=c},nodeType:{value:$data.Expressions.ExpressionType.EntityFieldOperation}});$C("$data.Expressions.FrameOperationExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b,c){this.source=a;this.operation=b;this.parameters=c},nodeType:{value:$data.Expressions.ExpressionType.FrameOperation}});
$C("$data.Expressions.EntitySetExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b,c,d){Guard.requireType("source",a,[$data.Expressions.EntityContextExpression,$data.Expressions.EntitySetExpression]);Guard.requireType("selector",a,[$data.Expressions.MemberInfoExpression,$data.Expressions.CodeExpression,$data.Expressions.ParametricQueryExpression]);Object.defineProperty(this,"source",{value:a,enumerable:true,writable:true});Object.defineProperty(this,"selector",{value:b,enumerable:true,
writable:true});Object.defineProperty(this,"params",{value:c,enumerable:true,writable:true});Object.defineProperty(this,"instance",{value:d,enumerable:false,writable:true});this.storage_type={};a:{for(;a;){if(a instanceof $data.Expressions.EntityContextExpression)break a;a=a.source}a=void 0}switch(true){case this.source instanceof $data.Expressions.EntityContextExpression:Guard.requireType("selector",b,$data.Expressions.MemberInfoExpression);this.elementType=b.memberDefinition.elementType;this.storageModel=
a.instance._storageModel.getStorageModel(this.elementType);break;case this.source instanceof $data.Expressions.EntityExpression:Guard.requireType("selector",b,$data.Expressions.AssociationInfoExpression);this.elementType=b.associationInfo.ToType;this.storageModel=a.instance._storageModel.getStorageModel(this.elementType);break;case this.source instanceof $data.Expressions.EntitySetExpression:this.elementType=this.source.elementType;this.storageModel=this.source.storageModel;break;case this.source instanceof
$data.Expressions.ServiceOperationExpression:this.elementType=this.source.elementType;this.storageModel=this.source.storageModel;break;default:Guard.raise("Unknown source type for EntitySetExpression: "+this.source.getType().name)}},nodeType:{value:$data.Expressions.ExpressionType.EntitySet,enumerable:!0}});
$C("$data.Expressions.FilterExpression",$data.Expressions.EntitySetExpression,null,{constructor:function(){this.resultType=$data.Array},nodeType:{value:$data.Expressions.ExpressionType.Filter,enumerable:!0}});$C("$data.Expressions.FrameOperator",$data.Expressions.ExpressionNode,null,{constructor:function(){this.isTerminated=true}});
$C("$data.Expressions.CountExpression",$data.Expressions.FrameOperator,null,{constructor:function(a){this.source=a;this.resultType=$data.Integer},nodeType:{value:$data.Expressions.ExpressionType.Count,enumerable:!0}});$C("$data.Expressions.SingleExpression",$data.Expressions.FrameOperator,null,{constructor:function(a){this.source=a;this.resultType=$data.Object},nodeType:{value:$data.Expressions.ExpressionType.Single,enumerable:!0}});
$C("$data.Expressions.FirstExpression",$data.Expressions.FrameOperator,null,{constructor:function(a){this.source=a;this.resultType=$data.Object},nodeType:{value:$data.Expressions.ExpressionType.First,enumerable:!0}});$C("$data.Expressions.ForEachExpression",$data.Expressions.FrameOperator,null,{constructor:function(a){this.source=a;this.resultType=$data.Array},nodeType:{value:$data.Expressions.ExpressionType.ForEach,enumerable:!0}});
$C("$data.Expressions.ToArrayExpression",$data.Expressions.FrameOperator,null,{constructor:function(a){this.source=a;this.resultType=$data.Array},nodeType:{value:$data.Expressions.ExpressionType.ToArray,enumerable:!0}});$C("$data.Expressions.SomeExpression",$data.Expressions.FrameOperator,null,{constructor:function(a){this.source=a;this.resultType=$data.Object},nodeType:{value:$data.Expressions.ExpressionType.Some,enumerable:!0}});
$C("$data.Expressions.EveryExpression",$data.Expressions.FrameOperator,null,{constructor:function(a){this.source=a;this.resultType=$data.Object},nodeType:{value:$data.Expressions.ExpressionType.Every,enumerable:!0}});$C("$data.Expressions.IncludeExpression",$data.Expressions.EntitySetExpression,null,{constructor:function(){},nodeType:{value:ExpressionType.Include,writable:!0},toString:function(){return"unimplemented"}},null);
$C("$data.Expressions.MemberInfoExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a){this.memberDefinition=a;this.memberName=a.name},nodeType:{value:$data.Expressions.ExpressionType.MemberInfo,enumerable:!0}});$C("$data.Expressions.OrderExpression",$data.Expressions.EntitySetExpression,null,{constructor:function(a,b,c){this.nodeType=c},nodeType:{value:ExpressionType.OrderBy,writable:!0},toString:function(){return"unimplemented"}},null);
$C("$data.Expressions.ParametricQueryExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b){this.expression=a;this.parameters=b},nodeType:{value:$data.Expressions.ExpressionType.ParametricQuery,enumerable:!0}});$C("$data.Expressions.ProjectionExpression",$data.Expressions.EntitySetExpression,null,{constructor:function(){},nodeType:{value:$data.Expressions.ExpressionType.Projection,enumerable:!0}});
$C("$data.Expressions.QueryExpressionCreator",$data.Expressions.EntityExpressionVisitor,null,{constructor:function(a){Guard.requireValue("scopeContext",a);this.scopeContext=a},VisitEntitySetExpression:function(a){a.source instanceof $data.Expressions.EntityContextExpression&&this.lambdaTypes.push(a);return a},VisitServiceOperationExpression:function(a){a.source instanceof $data.Expressions.EntityContextExpression&&this.lambdaTypes.push(a);return a},VisitCodeExpression:function(a,b){var c=a.source.toString(),
c=Container.createCodeParser(this.scopeContext).createExpression(c);this.scopeContext.log({event:"JSCodeExpression",data:c});var d=Container.createConstantValueResolver(a.parameters,window),c=Container.createParameterResolverVisitor().Visit(c,d);this.scopeContext.log({event:"JSCodeExpressionResolved",data:c});d=Container.createCodeToEntityConverter(this.scopeContext);c=d.Visit(c,{queryParameters:a.parameters,lambdaParameters:this.lambdaTypes,frameType:b.frameType});d=Container.createParametricQueryExpression(c,
d.parameters);this.scopeContext.log({event:"EntityExpression",data:c});return d},VisitFilterExpression:function(a,b){var c=this.Visit(a.source,b),b=b||{};b.frameType=a.getType();var d=this.Visit(a.selector,b);return c!==a.source||d!==a.selector?Container.createFilterExpression(c,d,a.params,a.instance):a},VisitProjectionExpression:function(a,b){var c=this.Visit(a.source,b),b=b||{};b.frameType=a.getType();var d=this.Visit(a.selector,b);return c!==a.source||d!==a.selector?Container.createProjectionExpression(c,
d,a.params,a.instance):a},VisitOrderExpression:function(a,b){var c=this.Visit(a.source,b),b=b||{};b.frameType=a.getType();var d=this.Visit(a.selector,b);return c!==a.source||d!==a.selector?Container.createOrderExpression(c,d,a.nodeType):a}});$C("$data.Expressions.QueryParameterExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b,c){this.name=a;this.index=b;this.value=c;this.type=Container.getTypeName(c)},nodeType:{value:$data.Expressions.ExpressionType.QueryParameter,writable:!1}});
$C("$data.Expressions.RepresentationExpression",$data.Expressions.ExpressionNode,null,{constructor:function(){},getMemberDefinition:function(a){return this.entityType.getMemberDefinition(a)},nodeType:{value:$data.Expressions.ExpressionType.Entity}});
$C("$data.Expressions.ServiceOperationExpression",$data.Expressions.ExpressionNode,null,{constructor:function(a,b,c,d){Guard.requireType("source",a,[$data.Expressions.EntityContextExpression]);Guard.requireType("selector",a,[$data.Expressions.MemberInfoExpression]);Object.defineProperty(this,"source",{value:a,enumerable:true,writable:true});Object.defineProperty(this,"selector",{value:b,enumerable:true,writable:true});Object.defineProperty(this,"params",{value:c,enumerable:true,writable:true});Object.defineProperty(this,
"cfg",{value:d,enumerable:false,writable:true});a:{for(;a;){if(a instanceof $data.Expressions.EntityContextExpression)break a;a=a.source}a=void 0}switch(true){case this.source instanceof $data.Expressions.EntityContextExpression:this.elementType=d.elementType?Container.resolveType(d.elementType):Container.resolveType(d.returnType);this.storageModel=d.elementType?a.instance._storageModel.getStorageModel(Container.resolveType(d.elementType)):null;break;default:Guard.raise("Unknown source type for EntitySetExpression: "+
this.source.getType().name)}},nodeType:{value:$data.Expressions.ExpressionType.ServiceOperation,enumerable:!0}});$data.Class.define("$data.Validation.ValidationError",null,null,{constructor:function(a,b,c){this.Message=a;this.PropertyDefinition=b;this.Type=c},Type:{dataType:"string"},Message:{dataType:"string"},PropertyDefinition:{dataType:$data.MemberDefinition}},null);
$data.Class.define("$data.Validation.EntityValidationBase",null,null,{ValidateEntity:function(){return[]},ValidateEntityField:function(){return[]},getValidationValue:function(){Guard.raise("Pure class")},getValidationMessage:function(){Guard.raise("Pure class")}},null);$data.Validation=$data.Validation||{};$data.Validation.Entity=new $data.Validation.EntityValidationBase;
$data.Class.define("$data.Validation.EntityValidation",$data.Validation.EntityValidationBase,null,{ValidateEntity:function(a){var b=[];a.getType().memberDefinitions.getPublicMappedProperties().forEach(function(c){b=b.concat(this.ValidateEntityField(a,c,void 0,true))},this);return b},ValidateEntityField:function(a,b,c,d){var e=[],h=Container.resolveName(Container.resolveType(b.dataType));this.fieldValidate(a,b,!d?c:a[b.name],e,h);return e},getValidationValue:function(a,b){return a[b]&&a[b].value?a[b].value:
a[b]},getValidationMessage:function(a,b,c){if(typeof a[b]=="object"&&a[b].message)c=a[b].message;else if(a.errorMessage)c=a.errorMessage;return c},createValidationError:function(a,b,c){return new $data.Validation.ValidationError(this.getValidationMessage(a,b,c),a,b)},supportedValidations:{value:{"$data.Number":{required:function(a){return!Object.isNullOrUndefined(a)},customValidator:function(a,b){return Object.isNullOrUndefined(a)||typeof b=="function"?b(a):true},minValue:function(a,b){return Object.isNullOrUndefined(a)||
a>=b},maxValue:function(a,b){return Object.isNullOrUndefined(a)||a<=b}},"$data.Integer":{required:function(a){return!Object.isNullOrUndefined(a)},customValidator:function(a,b){return Object.isNullOrUndefined(a)||typeof b=="function"?b(a):true},minValue:function(a,b){return Object.isNullOrUndefined(a)||a>=b},maxValue:function(a,b){return Object.isNullOrUndefined(a)||a<=b}},"$data.String":{required:function(a){return!Object.isNullOrUndefined(a)},customValidator:function(a,b){return Object.isNullOrUndefined(a)||
typeof b=="function"?b(a):true},minLength:function(a,b){return Object.isNullOrUndefined(a)||a.length>=b},maxLength:function(a,b){return Object.isNullOrUndefined(a)||a.length<=b},length:function(a,b){return Object.isNullOrUndefined(a)||a.length==b},regex:function(a,b){return Object.isNullOrUndefined(a)||a.match(b)}},"$data.Date":{required:function(a){return!Object.isNullOrUndefined(a)},customValidator:function(a,b){return Object.isNullOrUndefined(a)||typeof b=="function"?b(a):true},minValue:function(a,
b){return Object.isNullOrUndefined(a)||a>=b},maxValue:function(a,b){return Object.isNullOrUndefined(a)||a<=b}},"$data.Boolean":{required:function(a){return!Object.isNullOrUndefined(a)},customValidator:function(a,b){return Object.isNullOrUndefined(a)||typeof b=="function"?b(a):true}},"$data.Array":{required:function(a){return!Object.isNullOrUndefined(a)},customValidator:function(a,b){return Object.isNullOrUndefined(a)||typeof b=="function"?b(a):true},length:function(a,b){return Object.isNullOrUndefined(a)||
a.length==b}},"$data.Object":{required:function(a){return!Object.isNullOrUndefined(a)},customValidator:function(a,b){return Object.isNullOrUndefined(a)||typeof b=="function"?b(a):true}}}},fieldValidate:function(a,b,c,d,e){if(!(a.entityState==$data.EntityState.Modified&&a[b.name]==void 0)){var h=this.supportedValidations[e];h&&Object.keys(h).forEach(function(e){b[e]&&h[e]&&!h[e].call(a,c,this.getValidationValue(b,e))&&d.push(this.createValidationError(b,e,"Validation error!"))},this)}}},null);
$data.Validation.Entity=new $data.Validation.EntityValidation;$data.Class.define("$data.Notifications.ChangeDistributorBase",null,null,{distributeData:function(){Guard.raise("Pure class")}},null);
$data.Class.define("$data.Notifications.ChangeCollectorBase",null,null,{buildData:function(){Guard.raise("Pure class")},processChangedData:function(a){this.Distrbutor&&this.Distrbutor.distributeData&&this.Distrbutor.distributeData(this.buildData(a))},Distrbutor:{enumerable:!1,dataType:$data.Notifications.ChangeDistributorBase,storeOnObject:!0}},null);
$data.Class.define("$data.Notifications.ChangeDistributor",$data.Notifications.ChangeDistributorBase,null,{constructor:function(a){this.broadcastUrl=a},distributeData:function(a){$data.ajax({url:this.broadcastUrl,type:"POST",data:"data="+JSON.stringify(a),succes:this.success,error:this.error})},broadcastUrl:{dataType:"string"},success:function(){},error:function(){}},null);
$data.Class.define("$data.Notifications.ChangeCollector",$data.Notifications.ChangeCollectorBase,null,{buildData:function(a){var b=[];a.forEach(function(a){var d={entityState:a.data.entityState,typeName:a.data.getType().name},e=[];switch(a.data.entityState){case $data.EntityState.Added:e=a.data.getType().memberDefinitions.getPublicMappedProperties();break;case $data.EntityState.Modified:e=a.data.changedProperties;break;case $data.EntityState.Deleted:e=a.data.getType().memberDefinitions.getKeyProperties()}e.forEach(function(b){d[b.name]=
a.data[b.name]});b.push(d)});return b}},null);
$data.Class.define("$data.Promise",null,null,{always:function(){Guard.raise(new Exception("$data.Promise.always","Not implemented!"))},done:function(){Guard.raise(new Exception("$data.Promise.done","Not implemented!"))},fail:function(){Guard.raise(new Exception("$data.Promise.fail","Not implemented!"))},isRejected:function(){Guard.raise(new Exception("$data.Promise.isRejected","Not implemented!"))},isResolved:function(){Guard.raise(new Exception("$data.Promise.isResolved","Not implemented!"))},pipe:function(){Guard.raise(new Exception("$data.Promise.pipe",
"Not implemented!"))},progress:function(){Guard.raise(new Exception("$data.Promise.progress","Not implemented!"))},promise:function(){Guard.raise(new Exception("$data.Promise.promise","Not implemented!"))},state:function(){Guard.raise(new Exception("$data.Promise.state","Not implemented!"))},then:function(){Guard.raise(new Exception("$data.Promise.then","Not implemented!"))}},null);
$data.Class.define("$data.PromiseHandlerBase",null,null,{constructor:function(){},createCallback:function(a){a=$data.typeSystem.createCallbackSetting(a);return cbWrapper={success:a.success,error:a.error,notify:a.notify}},getPromise:function(){return new $data.Promise}},null);$data.PromiseHandler=$data.PromiseHandlerBase;var EventSubscriber=$data.Class.define("EventSubscriber",null,null,{constructor:function(a,b,c){this.handler=a;this.state=b;this.thisArg=c},handler:{},state:{},thisArg:{}});
$data.Event=Event=$data.Class.define("$data.Event",null,null,{constructor:function(a,b){function c(a,b){a.forEach(function(c,d){c.handler==b&&a.splice(d,1)})}var d=null;this.attach=function(a,c,f){d||(d=[]);d.push(new EventSubscriber(a,c,f||b))};this.detach=function(a){c(d,a)};this.fire=function(c,h){var f=h||b||this;c.eventName=a;d&&d.forEach(function(a){a.handler.call(a.thisArg,f,c,a.state)})}}});
var eventData=$data.Class.define("EventData",null,null,{eventName:{}}),PropertyChangeEventData=$data.Class.define("PropertyChangeEventData",EventData,null,{constructor:function(a,b,c){this.propertyName=a;this.oldValue=b;this.newValue=c},propertyName:{},oldValue:{},newValue:{}}),PropertyValidationEventData=$data.Class.define("PropertyValidationEventData",EventData,null,{constructor:function(a,b,c,d){this.propertyName=a;this.oldValue=b;this.newValue=c;this.errors=d;this.cancel=false},propertyName:{},
oldValue:{},newValue:{},errors:{},cancel:{}});
$data.Entity=Entity=$data.Class.define("$data.Entity",null,null,{constructor:function(a){this.getType().__copyPropertiesToInstance&&$data.typeSystem.writePropertyValues(this);Object.defineProperty(this,"initData",{enumerable:false,configurable:true,writable:true,value:{}});var b=null;Object.defineProperty(this,"context",{enumerable:false,configurable:false,get:function(){return b},set:function(a){b=a}});if(arguments.length==1&&typeof a==="object"){var c=this.getType().memberDefinitions.getPublicMappedProperties().map(function(a){return a.name});
if(Object.keys(a).every(function(a){return c.indexOf(a)!=-1}))this.initData=a}},toString:function(){return this.getType().fullName+"("+(this.Id||this.Name||"")+")"},toJSON:function(){var a={},b=this;this.getType().memberDefinitions.getPublicMappedProperties().forEach(function(c){a[c.name]=b[c.name]});return a},equals:function(a){if(a.getType()!==this.getType())return false;for(var b=this.getType().memberDefinitions.getKeyProperties(),c=0;c<b.length;c++)if(this[b[c].name]==a[b[c].name])return true;
return false},propertyChanging:{dataType:$data.Event,storeOnObject:!0,monitorChanges:!1,notMapped:!0,enumerable:!1,prototypeProperty:!0,get:function(){var a=this.getType().memberDefinitions.getMember("propertyChanging");if(a){delete this.propertyChanging;delete a.get;delete a.set;Object.defineProperty(this,"propertyChanging",a.createPropertyDescriptor());return this.propertyChanging=new Event("propertyChanging",this)}},set:function(){}},propertyChanged:{dataType:$data.Event,storeOnObject:!0,monitorChanges:!1,
notMapped:!0,enumerable:!1,prototypeProperty:!0,get:function(){var a=this.getType().memberDefinitions.getMember("propertyChanged");if(a){delete this.propertyChanged;delete a.get;delete a.set;Object.defineProperty(this,"propertyChanged",a.createPropertyDescriptor());return this.propertyChanged=new Event("propertyChanged",this)}},set:function(){}},propertyValidationError:{dataType:$data.Event,storeOnObject:!0,monitorChanges:!1,notMapped:!0,enumerable:!1,prototypeProperty:!0,get:function(){var a=this.getType().memberDefinitions.getMember("propertyValidationError");
if(a){delete this.propertyValidationError;delete a.get;delete a.set;Object.defineProperty(this,"propertyValidationError",a.createPropertyDescriptor());return this.propertyValidationError=new Event("propertyValidationError",this)}},set:function(){}},storeProperty:function(a,b){var c=null;if(a.monitorChanges!=false&&(this._propertyChanging||this._propertyChanged||"instancePropertyChanged"in this.constructor)){var d=this[a.name],c=new PropertyChangeEventData(a.name,d,b);this._propertyChanging&&this.propertyChanging.fire(c)}if(a.monitorChanges!=
false&&(this._propertyValidationError||"instancePropertyValidationError"in this.constructor)){var e=$data.Validation.Entity.ValidateEntityField(this,a,b);if(e.length>0){d=this[a.name];d=new PropertyValidationEventData(a.name,d,b,e);this._propertyValidationError&&this.propertyValidationError.fire(d);"instancePropertyValidationError"in this.constructor&&this.constructor.instancePropertyValidationError.fire(d,this);if(d.cancel==true)return}}if(a.storeOnObject==true){d="_"+a.name;this[d]?this[d]=b:Object.defineProperty(this,
d,a.createStorePropertyDescriptor(b))}else this.initData[a.name]=b;this.isValidated=false;if(a.monitorChanges!=false&&this.entityState==$data.EntityState.Unchanged)this.entityState=$data.EntityState.Modified;if(a.monitorChanges!=false){if(!this.changedProperties)this.changedProperties=[];this.changedProperties.some(function(b){return b.name==a.name})||this.changedProperties.push(a);this._propertyChanged&&this.propertyChanged.fire(c);"instancePropertyChanged"in this.constructor&&this.constructor.instancePropertyChanged.fire(c,
this)}},retrieveProperty:function(a){return a.storeOnObject==true?this["_"+a.name]:this.initData[a.name]},getProperty:function(a,b){if(this[a.name]!=void 0)b(this[a.name]);else{this.context||Guard.raise(new Exception("Entity not in context","Invalid operation"));return this.context.loadItemProperty(this,a,b)}},setProperty:function(a,b,c){this[a.name]=b;c()},isValid:function(){if(!this.isValidated){this.ValidationErrors=$data.Validation.Entity.ValidateEntity(this);this.isValidated=true}return this.ValidationErrors.length==
0},isValidated:{dataType:"bool",storeOnObject:!0,monitorChanges:!1,notMapped:!0,enumerable:!1,value:!1},ValidationErrors:{dataType:Array,elementType:$data.Validation.ValidationError,storeOnObject:!0,monitorChanges:!1,notMapped:!0,enumerable:!1},resetChanges:function(){delete this._changedProperties},changedProperties:{dataType:Array,elementType:window.MemberDefinition,storeOnObject:!0,monitorChanges:!1,notMapped:!0,enumerable:!1},entityState:{dataType:"integer",storeOnObject:!0,monitorChanges:!1,
notMapped:!0,enumerable:!1}},{__setPropertyfunctions:{value:!0,notMapped:!0,enumerable:!1,storeOnObject:!0},__copyPropertiesToInstance:{value:!1,notMapped:!0,enumerable:!1,storeOnObject:!0}});$data.Class.define("$data.StorageModel",null,null,{constructor:function(){this.ComplexTypes=[];this.Associations=[]},LogicalType:{},LogicalTypeName:{},PhysicalType:{},PhysicalTypeName:{},TableName:{},ComplexTypes:{},Associations:{},EntitySetReference:{}},null);
$data.Class.define("$data.Assiociation",null,null,{constructor:function(a){if(a){this.From=a.From;this.FromType=a.FromType;this.FromMultiplicity=a.FromMultiplicity;this.FromPropertyName=a.FromPropertyName;this.To=a.To;this.ToType=a.ToType;this.ToMultiplicity=a.ToMultiplicity;this.ToPropertyName=a.ToPropertyName}},From:{},FromType:{},FromMultiplicity:{},FromPropertyName:{},To:{},ToType:{},ToMultiplicity:{},ToPropertyName:{},ReferentialConstraint:{}},null);
$data.Class.define("$data.ComplexType",$data.Assiociation,null,{},null);
$data.Class.define("$data.EntityContext",null,null,{constructor:function(a){this.trackChanges=this.lazyLoad=false;this._entitySetReferences={};this._storageModel=[];var b=this;this._storageModel.getStorageModel=function(a){var c=Container.resolveType(a);return b._storageModel.filter(function(a){return a.LogicalType===c})[0]};if(typeof a.name==="string")a.name=[a.name];for(var c=0,d;!(d=$data.StorageProviderBase.getProvider(a.name[c]))&&c<a.name.length;)c++;if(d){this.storageProvider=new d(a,this);
this.storageProvider.setContext(this);this.stateManager=new $data.EntityStateManager(this);if(a.name in this.getType()._storageModelCache)this._storageModel=this.getType()._storageModelCache[a.name];else{this._initializeStorageModel();this.getType()._storageModelCache[a.name]=this._storageModel}}else Guard.raise(new Exception("Provider fallback failed!","Not Found"));this._initializeEntitySets(this.constructor);this._isOK=false;a=$data.typeSystem.createCallbackSetting({success:this._successInitProvider});
this.storageProvider&&this.storageProvider.initializeStore(a)},getDataType:function(a){if(typeof a=="string"){var b=this[a];if(b===void 0||b===null)b=eval(a);return b}return a},_initializeEntitySets:function(a){a.inheritsFrom!==null&&a.inheritsFrom!==void 0&&this._initializeEntitySets(a.inheritsFrom);this._storageModel.forEach(function(a){this[a.ItemName]=new $data.EntitySet(a.LogicalType,this,a.ItemName);this[a.ItemName].name=a.ItemName;this[a.ItemName].tableName=a.TableName;this._entitySetReferences[a.LogicalType.name]=
this[a.ItemName];a.EntitySetReference=this[a.ItemName]},this)},_initializeStorageModel:function(){this.getType().memberDefinitions.asArray().forEach(function(a){if("dataType"in a){var b=Container.resolveType(a.dataType);if(b&&b.isAssignableTo&&b.isAssignableTo($data.EntitySet)){b=new $data.StorageModel;b.TableName=a.tableName||a.name;b.ItemName=a.name;b.LogicalType=Container.resolveType(a.elementType);b.LogicalTypeName=b.LogicalType.name;b.PhysicalTypeName=$data.EntityContext._convertLogicalTypeNameToPhysical(b.LogicalTypeName);
this._storageModel.push(b)}}},this);typeof intellisense==="undefined"&&this._storageModel.forEach(function(a){var b={};a.Associations=a.Associations||[];a.ComplexTypes=a.ComplexTypes||[];a.LogicalType.memberDefinitions.getPublicMappedProperties().forEach(function(c){var e=Container.resolveType(c.dataType);if(this.storageProvider.supportedDataTypes.indexOf(e)>-1&&Object.isNullOrUndefined(c.inverseProperty)){var h=JSON.parse(JSON.stringify(c));h.dataType=e;b[c.name]=h}else{this._buildDbType_navigationPropertyComplite(c,
e,a);if((e===$data.Array||e.isAssignableTo&&e.isAssignableTo($data.EntitySet))&&c.inverseProperty&&c.inverseProperty!=="$$unbound")this._buildDbType_Collection_OneManyDefinition(b,a,e,c);else if(c.inverseProperty)if(c.inverseProperty==="$$unbound")e===$data.Array?this._buildDbType_Collection_OneManyDefinition(b,a,e,c):this._buildDbType_ElementType_OneManyDefinition(b,a,e,c);else(h=e.memberDefinitions.getMember(c.inverseProperty))?h.elementType?Container.resolveType(h.elementType)===a.LogicalType?
this._buildDbType_ElementType_OneManyDefinition(b,a,e,c):typeof intellisense==="undefined"&&Guard.raise(new Exception("Inverse property not valid, refereed item element type not match: "+a.LogicalTypeName,", property: "+c.name)):this._buildDbType_ElementType_OneOneDefinition(b,a,e,c):typeof intellisense==="undefined"&&Guard.raise(new Exception("Inverse property not valid"));else this._buildDbType_addComplexTypePropertyDefinition(b,a,e,c)}},this);this._buildDbType_modifyInstanceDefinition(b,a,this);
var c={};c.convertTo=this._buildDbType_generateConvertToFunction(a,this);this._buildDbType_modifyClassDefinition(c,a,this);a.PhysicalType=$data.Class.define(a.PhysicalTypeName,$data.Entity,null,b,c)},this)},_buildDbType_navigationPropertyComplite:function(a,b,c){if(a.inverseProperty){e=null;e=b===$data.Array||b.isAssignableTo&&b.isAssignableTo($data.EntitySet)?this._storageModel.getStorageModel(Container.resolveType(a.elementType)):this._storageModel.getStorageModel(b);if(b=e.LogicalType.memberDefinitions.getMember(a.inverseProperty))b.inverseProperty?
b.inverseProperty!=a.name&&typeof intellisense==="undefined"&&Guard.raise(new Exception("Inverse property mismatch")):b.inverseProperty=a.name}else{var d=null;if(b===$data.Array||b.isAssignableTo&&b.isAssignableTo($data.EntitySet)){var e=this._storageModel.getStorageModel(Container.resolveType(a.elementType));e&&(d=e.LogicalType.memberDefinitions.getPublicMappedProperties().filter(function(b){return b.inverseProperty==a.name&&Container.resolveType(b.dataType)===Container.resolveType(c.LogicalType)}))}else(e=
this._storageModel.getStorageModel(b))&&(d=e.LogicalType.memberDefinitions.getPublicMappedProperties().filter(function(b){return b.elementType?b.inverseProperty==a.name&&Container.resolveType(b.elementType)===c.LogicalType:b.inverseProperty==a.name&&Container.resolveType(b.dataType)===c.LogicalType}));if(d){d.length>1&&typeof intellisense!=="undefined"&&Guard.raise(new Exception("More than one inverse property refer to this member definition: "+a.name+", type: "+Container.resolveName(c.LogicalType)));
if(b=d.pop())a.inverseProperty=b.name}}},_buildDbType_generateConvertToFunction:function(){return function(a){return a}},_buildDbType_modifyInstanceDefinition:function(){},_buildDbType_modifyClassDefinition:function(){},_buildDbType_addComplexTypePropertyDefinition:function(a,b,c,d){this._addNavigationPropertyDefinition(a,d,d.name,$data.MemberTypes.complexProperty);a=this._createComplexElement(b.LogicalType,"",d.name,c,"","");b.ComplexTypes[d.name]=a;b.ComplexTypes.push(a)},_buildDbType_Collection_OneManyDefinition:function(a,
b,c,d){var e=Container.resolveType(d.elementType);(e===void 0||e===null)&&typeof intellisense==="undefined"&&Guard.raise(new Exception("Element type definition error","Field definition",d));(c=this._storageModel.filter(function(a){return a.LogicalType===e})[0])||typeof intellisense==="undefined"&&Guard.raise(new Exception("No EntitySet definition for the following element type","Field definition",d));this._addNavigationPropertyDefinition(a,d,d.name);a=this._addAssociationElement(b.LogicalType,d.inverseProperty===
"$$unbound"?"$$unbound":"0..1",d.name,c.LogicalType,"*",d.inverseProperty);b.Associations[d.name]=a;b.Associations.push(a)},_buildDbType_ElementType_OneManyDefinition:function(a,b,c,d){var e=Container.resolveType(d.dataType);(e===void 0||e===null)&&typeof intellisense==="undefined"&&Guard.raise(new Exception("Element type definition error","Field definition",d));(c=this._storageModel.filter(function(a){return a.LogicalType===e})[0])||typeof intellisense==="undefined"&&Guard.raise(new Exception("No EntitySet definition for the following element type",
"Field definition",d));this._addNavigationPropertyDefinition(a,d,d.name);a=this._addAssociationElement(b.LogicalType,d.inverseProperty==="$$unbound"?"$$unbound":"*",d.name,c.LogicalType,"0..1",d.inverseProperty);b.Associations[d.name]=a;b.Associations.push(a)},_buildDbType_ElementType_OneOneDefinition:function(a,b,c,d){var e=Container.resolveType(d.dataType);(e===void 0||e===null)&&typeof intellisense==="undefined"&&Guard.raise(new Exception("Element type definition error","Field definition",d));
(c=this._storageModel.filter(function(a){return a.LogicalType===e})[0])||typeof intellisense==="undefined"&&Guard.raise(new Exception("No EntitySet definition following element type","Field definition",d));!c.LogicalType.memberDefinitions.getMember(d.inverseProperty).required&&!d.required&&typeof intellisense==="undefined"&&typeof intellisense==="undefined"&&Guard.raise(new Exception("In one to one connection, one side must required!","One to One connection",d));this._addNavigationPropertyDefinition(a,
d,d.name);association=this._addAssociationElement(b.LogicalType,d.required?"0..1":"1",d.name,c.LogicalType,d.required?"1":"0..1",d.inverseProperty);b.Associations[d.name]=association;b.Associations.push(association)},_addNavigationPropertyDefinition:function(a,b,c,d){var e=JSON.parse(JSON.stringify(b));e.dataType=$data.EntitySet;e.notMapped=true;e.kind=d?d:$data.MemberTypes.navProperty;e.association=c;a[b.name]=e},_addAssociationElement:function(a,b,c,d,e,h){return new $data.Assiociation({From:a.name,
FromType:a,FromMultiplicity:b,FromPropertyName:c,To:d.name,ToType:d,ToMultiplicity:e,ReferentialConstraint:[],ToPropertyName:h})},_createComplexElement:function(a,b,c,d,e,h){return new $data.ComplexType({From:a.name,FromType:a,FromMultiplicity:b,FromPropertyName:c,To:d.name,ToType:d,ToMultiplicity:e,ReferentialConstraint:[],ToPropertyName:h})},_successInitProvider:function(a){if(a!=void 0&&a._isOK!=void 0){a._isOK=true;if(a.onReadyFunction)a.onReadyFunction(a)}},onReady:function(a){var b=new $data.PromiseHandler,
a=b.createCallback(a);this.onReadyFunction=a.success;this._isOK&&a.success(this);return b.getPromise()},getEntitySetFromElementType:function(a){var b=this._entitySetReferences[a];if(!b)try{b=this._entitySetReferences[eval(a).name]}catch(c){}return b},executeQuery:function(a,b){var c=new $data.Query(a.expression,a.defaultType,this),b=$data.typeSystem.createCallbackSetting(b),d=this,e={success:function(a){a.buildResultSet(d);a.expression.nodeType===$data.Expressions.ExpressionType.Single||a.expression.nodeType===
$data.Expressions.ExpressionType.Count||a.expression.nodeType===$data.Expressions.ExpressionType.Some||a.expression.nodeType===$data.Expressions.ExpressionType.Every?a.result.length!==1?b.error(new Exception("result count failed")):b.success(a.result[0]):a.expression.nodeType===$data.Expressions.ExpressionType.First?a.result.length===0?b.error(new Exception("result count failed")):b.success(a.result[0]):b.success(a.result)}};e.error=b.error;this.storageProvider.executeQuery(c,e)},saveChanges:function(a){for(var b=
[],c=this.stateManager.trackedEntities,d=new $data.PromiseHandler,e=d.createCallback(a),a=d.getPromise(),h=[];c.length>0;){var f=[];c.forEach(function(a){var b=this._storageModel.getStorageModel(a.data.getType());if(a.data.entityState==$data.EntityState.Unchanged){a.skipSave=true;h.push(a.data)}else if(a.data.entityState==$data.EntityState.Modified&&a.data.changedProperties&&!a.data.changedProperties.some(function(a){a=b.PhysicalType.memberDefinitions.getMember(a.name);if(a.kind==$data.MemberTypes.navProperty){a=
b.Associations[a.association];a=a.FromMultiplicity+a.ToMultiplicity;return a=="*0..1"||a=="0..11"}return true})){a.skipSave=true;h.push(a.data)}b.PhysicalType.memberDefinitions.asArray().filter(function(a){return a.kind==$data.MemberTypes.navProperty}).forEach(function(c){var d=b.Associations[c.name],e=d.ToPropertyName;[].concat(a.data[c.name]).forEach(function(b){if(b){var c=b[e],h=d.FromMultiplicity+d.ToMultiplicity;if(d.FromMultiplicity==="$$unbound")if(b instanceof $data.Array){a.dependentOn=
a.dependentOn||[];b.forEach(function(){a.dependentOn.indexOf(b)<0&&b.skipSave!==true&&a.dependentOn.push(b)},this)}else{a.dependentOn=a.dependentOn||[];a.dependentOn.indexOf(b)<0&&b.skipSave!==true&&a.dependentOn.push(b)}else{switch(h){case "*0..1":c?c instanceof Array?c.indexOf(a.data)==-1&&c.push(a.data):typeof intellisense==="undefined"&&Guard.raise("Item must be array or subtype of array"):b[e]=[a.data];break;default:c?c!==a.data&&typeof intellisense==="undefined"&&Guard.raise("Integrity check error! Item assigned to another entity!"):
b[e]=a.data}switch(h){case "*0..1":case "0..11":a.dependentOn=a.dependentOn||[];a.dependentOn.indexOf(b)<0&&b.skipSave!==true&&a.dependentOn.push(b)}}if(!b.entityState)b.entityState=$data.EntityState.Added;f.indexOf(b)==-1&&f.push(b)}},this)},this)},this);c.forEach(function(a){a.skipSave!==true&&b.push(a)});c=[];f.forEach(function(a){h.some(function(b){return b==a})||b.some(function(b){return b.data==a})||c.push({data:a,entitySet:this.getEntitySetFromElementType(a.getType().name)})},this)}b.forEach(function(a){if(a.dependentOn){for(var b=
[],c=0;c<a.dependentOn.length;c++)h.indexOf(a.dependentOn[c])<0&&b.push(a.dependentOn[c]);a.dependentOn=b}});var h=null,j=this;if(b.length==0){e.success();return a}var n=[];b.forEach(function(a){a.data.entityState===$data.EntityState.Added&&a.data.getType().memberDefinitions.getPublicMappedProperties().forEach(function(b){b.required&&!b.computed&&!a.data[b.name]&&(a.data[b.name]=Container.getDefault(b.dataType))},this);(a.data.entityState!=$data.EntityState.Added||a.data.entityState!=$data.EntityState.Modified)&&
!a.data.isValid()&&n.push({item:a.data,errors:a.data.ValidationErrors})});if(n.length>0){e.error(n);return a}this.storageProvider.saveChanges({success:function(){j._postProcessSavedItems(e,b)},error:e.error},b);return a},prepareRequest:function(){},_postProcessSavedItems:function(a,b){this.ChangeCollector&&this.ChangeCollector instanceof $data.Notifications.ChangeCollectorBase&&this.ChangeCollector.processChangedData(b);b.forEach(function(a){a.data.entityState=$data.EntityState.Unchanged;a.data.changedProperties=
[];a.physicalData=void 0});this.trackChanges||this.stateManager.reset();a.success(b.length)},forEachEntitySet:function(a,b){for(var c in this._entitySetReferences)a.call(b,this._entitySetReferences[c])},loadItemProperty:function(a,b,c){Guard.requireType("entity",a,$data.Entity);var d=typeof b==="string"?a.getType().memberDefinitions.getMember(b):b;if(a[d.name]!=void 0){b=new $data.PromiseHandler;callBack=b.createCallback(c);c.success(a[d.name]);return b.getPromise()}var b=true,e=this._storageModel.getStorageModel(a.getType().fullName),
h=Container.resolveType(d.dataType);if(h===$data.Array||h.isAssignableTo&&h.isAssignableTo($data.EntitySet)){h=Container.resolveType(d.elementType);b=false}else{var f=e.Associations.filter(function(a){return a.FromPropertyName==d.name})[0];f&&f.FromMultiplicity==="0..1"&&f.ToMultiplicity==="1"&&(b=false)}if(b===true){var j="function (e) { return",n={};e.LogicalType.memberDefinitions.getKeyProperties().forEach(function(b,c){c>0&&(j=j+" &&");j=j+(" e."+b.name+" == this.key"+c);n["key"+c]=a[b.name]});
j=j+"; }";return e.EntitySetReference.map("function (e) { return e."+d.name+" }").single(j,n,c)}j="function (e) { return";n={};e.LogicalType.memberDefinitions.getKeyProperties().forEach(function(b,c){c>0&&(j=j+" &&");j=j+(" e."+d.inverseProperty+"."+b.name+" == this.key"+c);n["key"+c]=a[b.name]});j=j+"; }";return this.getEntitySetFromElementType(h).filter(j,n).toArray(c)},getTraceString:function(a){return this.storageProvider.getTraceString(new $data.Query(a.expression,a.defaultType,this))},log:function(){},
resolveBinaryOperator:function(a,b,c){return this.storageProvider.resolveBinaryOperator(a,b,c)},resolveUnaryOperator:function(a,b,c){return this.storageProvider.resolveUnaryOperator(a,b,c)},resolveFieldOperation:function(a,b,c){return this.storageProvider.resolveFieldOperation(a,b,c)},resolveSetOperations:function(a,b,c){return this.storageProvider.resolveSetOperations(a,b,c)},_generateServiceOperationQueryable:function(a,b,c,d){typeof console!=="undefined"&&console.log&&console.log("Obsolate: _generateServiceOperationQueryable, $data.EntityContext");
for(var e=[],h=0;h<d.length;h++){var f={};f[d[h]]=Container.resolveType(Container.getTypeName(c[h]));e.push(f)}return $data.EntityContext.generateServiceOperation({serviceName:a,returnType:$data.Queryable,elementType:this[b].elementType,params:e}).apply(this,c)},attach:function(a){a instanceof $data.EntityWrapper&&(a=a.getEntity());return this.getEntitySetFromElementType(a.getType()).attach(a)},attachOrGet:function(a){a instanceof $data.EntityWrapper&&(a=a.getEntity());return this.getEntitySetFromElementType(a.getType()).attachOrGet(a)},
add:function(a){a instanceof $data.EntityWrapper&&(a=a.getEntity());return this.getEntitySetFromElementType(a.getType()).add(a)},remove:function(a){a instanceof $data.EntityWrapper&&(a=a.getEntity());return this.getEntitySetFromElementType(a.getType()).remove(a)}},{generateServiceOperation:function(a){return function(){var b=a.elementType?this.getEntitySetFromElementType(Container.resolveType(a.elementType)):null,c=null;if(a.params)for(var c=[],d=0;d<a.params.length;d++)for(var e in a.params[d])c.push(Container.createConstantExpression(arguments[d],
Container.resolveType(a.params[d][e]),e));d=Container.createEntityContextExpression(this);e=this.getType().getMemberDefinition(a.serviceName);c=Container.createServiceOperationExpression(d,Container.createMemberInfoExpression(e),c,a);d=arguments[arguments.length-1];typeof d!=="function"&&(d=void 0);if(b){b=Container.createQueryable(b,c);if(d){c.isTerminated=true;return b._runQuery(d)}return b}e=Container.resolveType(a.returnType);b=Container.createQueryable(this,c);b.defaultType=e;if(e===$data.Queryable){b.defaultType=
Container.resolveType(a.elementType);if(d){c.isTerminated=true;return b._runQuery(d)}return b}c.isTerminated=true;return b._runQuery(d)}},_convertLogicalTypeNameToPhysical:function(a){return a+"_$db$"},_storageModelCache:{get:function(){if(!this.__storageModelCache)this.__storageModelCache={};return this.__storageModelCache},set:function(){}}});
$data.Class.define("$data.QueryProvider",null,null,{constructor:function(){this.requiresExpressions=false},executeQuery:function(){},getTraceString:function(){}},null);
$data.Class.define("$data.ModelBinder",null,null,{constructor:function(a){this.context=a;this.cache={}},call:function(a,b){if(!Object.getOwnPropertyNames(b).length)return a;if(b.$type)var c=Container.resolveName(b.$type),d=this.context.storageProvider.fieldConverter.fromDb[c],e=d?d():Container["create"+Container.resolveType(b.$type).name]();if(b.$selector){var h=b.$selector;h instanceof Array||(h=[h]);for(var d=0,f;d<h.length;){f=a;c=h[d].split(":");switch(c[0]){case "json":for(c=c[1].split(".");c.length;)if(typeof f[c[0]]===
"undefined"){if(d===h.length)return;if(c.length)break}else{f=f[c[0]];c=c.slice(1)}if(!c.length)d=h.length;break;case "css":case "xml":if(f.querySelector)f=f[b.$item?"querySelectorAll":"querySelector"](c[1]);else{f=$(f).find(c[1]);b.$item||(f=f[0])}}d++}a=f;if(!a)return a}if(b.$value)if(typeof b.$value==="function")e=b.$value();else if(b.$type){c=Container.resolveName(b.$type);e=(d=this.context.storageProvider.fieldConverter.fromDb[c])?d(b.$value):Container["create"+Container.resolveType(b.$type).name](b.$value)}else e=
b.$value;else if(b.$source)if(b.$type){c=Container.resolveName(b.$type);e=(d=this.context.storageProvider.fieldConverter.fromDb[c])?d(a[b.$source]):Container["create"+Container.resolveType(b.$type).name](a[b.$source])}else e=b.$source.split(":")[0]=="attr"&&a.getAttribute?a.getAttribute(b.$source.split(":")[1]):b.$source=="textContent"&&!a[b.$source]?$(a).text():a[b.$source];else if(b.$item)for(d=0;d<a.length;d++){var j=this.call(a[d],b.$item);e.push(j)}else{f="";if(b.$keys){for(j=0;j<b.$keys.length;j++)f=
f+(b.$type+"_"+b.$keys[j]+"#"+a[b.$keys[j]]);if(this.cache[f]){e=this.cache[f];for(j in b)j.indexOf("$")<0&&b[j].$item&&e[j].push(this.call(a,b[j].$item))}else{for(j in b)if(j.indexOf("$")<0)if(b[j].$item)e[j]=this.call(a,b[j]);else if(b[j].$type||b[j].$source)e[j]=this.call(a,b[j]);else if(b.$type){c=Container.resolveName(b.$type.memberDefinitions.getMember(j).type);d=this.context.storageProvider.fieldConverter.fromDb[c];e[j]=d?d(a[b[j]]):Container["create"+Container.resolveType(b.$type.memberDefinitions.getMember(j).type).name](a[b[j]])}else e[j]=
b[j].$source?a[b[j].$source]:a[b[j]];this.cache[f]=e}}else for(j in b)if(j.indexOf("$")<0)if(b[j].$item)e[j]=this.call(a,b[j]);else if(b[j].$type||b[j].$source)e[j]=this.call(a,b[j]);else if(b.$type){c=Container.resolveName(Container.resolveType(b.$type).memberDefinitions.getMember(j).type);d=this.context.storageProvider.fieldConverter.fromDb[c];e[j]=d?d(a[b[j]]):Container["create"+Container.resolveType(b.$type.memberDefinitions.getMember(j).type).name](a[b[j]])}else e[j]=b[j].$source?a[b[j].$source]:
a[b[j]]}return e}});
$C("$data.Query",null,null,{constructor:function(a,b,c){Object.defineProperty(this,"expression",{value:a,enumerable:true});Object.defineProperty(this,"context",{value:c,enumerable:true});this.expressions=a;this.defaultType=b;this.result=[];this.rawDataList=[];this.modelBinderConfig={};this.context=c},rawDataList:{dataType:"Array"},result:{dataType:"Array"},resultType:{},buildResultSet:function(){this.result=(new $data.ModelBinder(this.context)).call(this.rawDataList,this.modelBinderConfig)}},null);
$data.Class.define("$data.Queryable",null,null,{constructor:function(a,b){var c=a instanceof $data.EntityContext?a:a.entityContext;this.defaultType=a instanceof $data.EntityContext?null:a.defaultType;Object.defineProperty(this,"entityContext",{value:c,writable:false,enumerable:true});this.expression=b},filter:function(a,b){this._checkOperation("filter");var c=Container.createCodeExpression(a,b),d=this.expression;if(this.expression instanceof $data.Expressions.FilterExpression)var d=this.expression.source,
e=this.entityContext.storageProvider.resolveBinaryOperator("and"),c=Container.createSimpleBinaryExpression(this.expression.selector,c,"and","filter","boolean",e);c=Container.createFilterExpression(d,c);return Container.createQueryable(this,c)},where:function(a,b){return this.filter(a,b)},map:function(a,b){this._checkOperation("map");var c=Container.createCodeExpression(a,b),c=Container.createProjectionExpression(this.expression,c);return Container.createQueryable(this,c)},select:function(a,b){return this.map(a,
b)},length:function(a){this._checkOperation("length");var b=new $data.PromiseHandler,a=b.createCallback(a),c=Container.createCountExpression(this.expression),d=Container.createQueryExpressionCreator(this.entityContext);try{var e=d.Visit(c);this.entityContext.log({event:"EntityExpression",data:e});this.entityContext.executeQuery(Container.createQueryable(this,e),a)}catch(h){a.error(h)}return b.getPromise()},count:function(a){return this.length(a)},forEach:function(a){this._checkOperation("forEach");
var b=new $data.PromiseHandler,c=b.createCallback(function(b){b.forEach(a)}),d=Container.createForEachExpression(this.expression),e=Container.createQueryExpressionCreator(this.entityContext);try{var h=e.Visit(d);this.entityContext.log({event:"EntityExpression",data:h});this.entityContext.executeQuery(Container.createQueryable(this,h),c)}catch(f){c.error(f)}return b.getPromise()},toArray:function(a){if(a instanceof $data.Array)return this.toArray(function(b){a.length=0;b.forEach(function(b){a.push(b)})});
this._checkOperation("toArray");var b=new $data.PromiseHandler,c=b.createCallback(a),d=Container.createToArrayExpression(this.expression),e=Container.createQueryExpressionCreator(this.entityContext);try{var h=e.Visit(d);this.entityContext.log({event:"EntityExpression",data:h});this.entityContext.executeQuery(Container.createQueryable(this,h),c)}catch(f){c.error(f)}return b.getPromise()},single:function(a,b,c){this._checkOperation("single");var d=this;a&&(d=this.filter(a,b));var d=d.take(2),a=new $data.PromiseHandler,
c=a.createCallback(c),b=Container.createSingleExpression(d.expression),e=Container.createQueryExpressionCreator(d.entityContext);try{var h=e.Visit(b);this.entityContext.log({event:"EntityExpression",data:h});d.entityContext.executeQuery(Container.createQueryable(d,h),c)}catch(f){c.error(f)}return a.getPromise()},some:function(a,b,c){this._checkOperation("some");var d=this;a&&(d=this.filter(a,b));var d=d.take(1),a=new $data.PromiseHandler,c=a.createCallback(c),b=Container.createSomeExpression(d.expression),
e=Container.createQueryExpressionCreator(d.entityContext);try{var h=e.Visit(b);this.entityContext.log({event:"EntityExpression",data:h});d.entityContext.executeQuery(Container.createQueryable(d,h),c)}catch(f){c.error(f)}return a.getPromise()},every:function(a,b,c){this._checkOperation("every");var d=this;a&&(d=this.filter(a,b));var d=d.take(1),a=new $data.PromiseHandler,c=a.createCallback(c),b=Container.createEveryExpression(d.expression),e=Container.createQueryExpressionCreator(d.entityContext);
try{var h=e.Visit(b);this.entityContext.log({event:"EntityExpression",data:h});d.entityContext.executeQuery(Container.createQueryable(d,h),c)}catch(f){c.error(f)}return a.getPromise()},take:function(a){this._checkOperation("take");a=Container.createConstantExpression(a,"number");a=Container.createPagingExpression(this.expression,a,ExpressionType.Take);return Container.createQueryable(this,a)},skip:function(a){this._checkOperation("skip");a=Container.createConstantExpression(a,"number");a=Container.createPagingExpression(this.expression,
a,ExpressionType.Skip);return Container.createQueryable(this,a)},orderBy:function(a,b){this._checkOperation("orderBy");var c=Container.createCodeExpression(a,b),c=Container.createOrderExpression(this.expression,c,ExpressionType.OrderBy);return Container.createQueryable(this,c)},orderByDescending:function(a,b){this._checkOperation("orderByDescending");var c=Container.createCodeExpression(a,b),c=Container.createOrderExpression(this.expression,c,ExpressionType.OrderByDescending);return Container.createQueryable(this,
c)},first:function(a,b,c){this._checkOperation("first");var d=this;a&&(d=this.filter(a,b));var d=d.take(1),a=new $data.PromiseHandler,c=a.createCallback(c),b=Container.createFirstExpression(d.expression),e=Container.createQueryExpressionCreator(d.entityContext);try{var h=e.Visit(b);d.entityContext.log({event:"EntityExpression",data:h});d.entityContext.executeQuery(Container.createQueryable(d,h),c)}catch(f){c.error(f)}return a.getPromise()},include:function(a){this._checkOperation("include");a=Container.createConstantExpression(a,
"string");a=Container.createIncludeExpression(this.expression,a);return Container.createQueryable(this,a)},_runQuery:function(a){var b=new $data.PromiseHandler,a=b.createCallback(a),c=Container.createQueryExpressionCreator(this.entityContext);try{var d=c.Visit(this.expression);this.entityContext.log({event:"EntityExpression",data:d});this.entityContext.executeQuery(Container.createQueryable(this,d),a)}catch(e){a.error(e)}return b.getPromise()},toTraceString:function(a){var b=this.expression,b=a?Container["create"+
a+"Expression"](b):Container.createToArrayExpression(b),b=Container.createQueryExpressionCreator(this.entityContext).Visit(b),a=Container.createQueryable(this,b);return a.entityContext.getTraceString(a)},_checkOperation:function(a){var b=this.entityContext.resolveSetOperations(a);b.invokable!=void 0&&!b.invokable&&Guard.raise(new Exception("Operation '"+a+"' is not invokable with the provider"))},defaultType:{}},null);$data.EntitySchemaConfig=function(){this.Name=""};
$data.entitySetState={created:0,defined:1,active:2};
$data.Class.defineEx("$data.EntitySet",[{type:$data.Queryable,params:[new ConstructorParameter(1)]}],null,{constructor:function(a,b,c){this.createNew=this[a.name]=a;this.stateManager=new $data.EntityStateManager(this);Object.defineProperty(this,"elementType",{value:a,enumerable:true});Object.defineProperty(this,"collectionName",{value:c,enumerable:true});this._checkRootExpression()},executeQuery:function(a,b){var c=$data.typeSystem.createCallbackSetting(b);this.entityContext.executeQuery(a,c)},getTraceString:function(a){return this.entityContext.getTraceString(a)},
setContext:function(a){this.entitySetState=$data.entitySetState.active;this.entityContext=a;this.entityContext[this.schema.name]=this[this.schema.name]},_trackEntity:function(a){for(var b=this.entityContext.stateManager.trackedEntities,c=0;c<b.length;c++)if(b[c].data===a)return;b.push({entitySet:this,data:a})},add:function(a){var b=a;a instanceof $data.EntityWrapper?b=a.getEntity():a instanceof this.createNew||(b=new this.createNew(a));b.entityState=$data.EntityState.Added;b.changedProperties=void 0;
b.context=this.entityContext;this._trackEntity(b)},remove:function(a){var b=a;a instanceof $data.EntityWrapper?b=a.getEntity():a instanceof this.createNew||(b=new this.createNew(a));b.entityState=$data.EntityState.Deleted;b.changedProperties=void 0;this._trackEntity(b)},attach:function(a){var b=a;a instanceof $data.EntityWrapper?b=a.getEntity():a instanceof this.createNew||(b=new this.createNew(a));for(a=0;a<this.entityContext.stateManager.trackedEntities.length;a++){var c=this.entityContext.stateManager.trackedEntities[a];
if(c.data===b)break;c.data.equals(b)&&Guard.raise(new Exception("Context already contains this entity!!!"))}b.entityState=$data.EntityState.Unchanged;b.changedProperties=void 0;b.context=this.entityContext;this._trackEntity(b)},detach:function(a){var b=a;a instanceof $data.EntityWrapper?b=a.getEntity():a instanceof this.createNew||(b=new this.createNew(a));var c=this.entityContext.stateManager.trackedEntities.filter(function(a){return a.data.equals(b)}).pop();if(c){c=this.entityContext.stateManager.trackedEntities.indexOf(c);
a.entityState=$data.EntityState.Detached;this.entityContext.stateManager.trackedEntities.splice(c,1)}},attachOrGet:function(a){var b=a;a instanceof $data.EntityWrapper?b=a.getEntity():a instanceof this.createNew||(b=new this.createNew(a));if(a=this.entityContext.stateManager.trackedEntities.filter(function(a){return a.data.equals(b)}).pop())return a.data;b.entityState=$data.EntityState.Unchanged;b.changedProperties=void 0;b.context=this.entityContext;this._trackEntity(b);return b},loadItemProperty:function(a,
b,c){return this.entityContext.loadItemProperty(a,b,c)},_checkRootExpression:function(){if(!this.expression){var a=Container.createEntityContextExpression(this.entityContext),b=this.entityContext.getType().getMemberDefinition(this.collectionName);this.expression=Container.createEntitySetExpression(a,Container.createMemberInfoExpression(b),null,this);this.defaultType=this.elementType}}},null);$data.EntityState={Detached:0,Unchanged:10,Added:20,Modified:30,Deleted:40};
$data.Class.define("$data.EntityStateManager",null,null,{constructor:function(a){this.entityContext=null;this.trackedEntities=[];this.init(a)},init:function(a){this.entityContext=a},reset:function(){this.trackedEntities=[]}},null);function Exception(a,b,c){Error.call(this);Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor);this.name=b||"Exception";this.message=a;this.data=c}Exception.prototype.__proto__=Error.prototype;Exception.prototype._getStackTrace=function(){};
$data.ConcurrencyMode={Fixed:"fixed",None:"nonde"};
$data.Class.define("$data.StorageProviderBase",null,null,{constructor:function(a){this.providerConfiguration=a||{}},providers:{},supportedDataTypes:{value:[],writable:!1},initializeStore:function(){Guard.raise("Pure class")},executeQuery:function(){Guard.raise("Pure class")},buildIndependentBlocks:function(a){for(var b=[],c=[],d=0;d<a.length;d++){var e=a[d];if(e.dependentOn&&e.dependentOn.length!=0){for(var h=null,f=0;f<e.dependentOn.length;f++){var j=e.dependentOn[f];if(j.entityState!=$data.EntityState.Unchanged){for(var h=
h||{},n=-1,u=0;u<a.length;u++)if(a[u].data==j){n=u;break}n==-1&&Guard.raise(new Exception("Dependent object not found","ObjectNotFound",e.dependentOn[f]));h[n]=true;from=c[n]||{};from[d]=true;c[n]=from}}h!==null&&(b[d]=h)}}d=[];e=[];for(h=0;h<a.length;h++)b.hasOwnProperty(h)||e.push(h);for(;e.length>0;){h=[].concat(e);e=[];for(f=0;f<h.length;f++){j=c[h[f]];if(typeof j!=="undefined")for(var q in j){delete b[q][h[f]];a:{n=b[q];u=void 0;for(u in n)if(n.hasOwnProperty(u)){n=true;break a}n=false}if(!n){delete b[q];
e.push(q)}}delete c[h[f]]}f=[];for(j=0;j<h.length;j++){n=a[h[j]];n.data.entityState!=$data.EntityState.Unchanged&&f.push(n)}f.length>0&&d.push(f)}return d},getTraceString:function(){Guard.raise("Pure class")},setContext:function(a){this.context=a},supportedFieldOperations:{value:{length:{dataType:"number",allowedIn:"filter, map"},substr:{dataType:"string",allowedIn:"filter",parameters:[{name:"startFrom",dataType:"number"},{name:"length",dataType:"number"}]},toLowerCase:{dataType:"string"}},enumerable:!0,
writable:!0},resolveFieldOperation:function(a,b,c){(b=this.supportedFieldOperations[a])||Guard.raise(new Exception("Field operation '"+a+"' is not supported by the provider"));c&&b.allowedIn&&(b.allowedIn instanceof Array&&!b.allowedIn.some(function(a){return c===Container.resolveType(a)})||!(b.allowedIn instanceof Array)&&c!==Container.resolveType(b.allowedIn))&&Guard.raise(new Exception(a+" not supported in: "+c.name));b.name=a;return b},supportedBinaryOperators:{value:{equal:{mapTo:"eq",dataType:"boolean"}},
enumerable:!0,writable:!0},resolveBinaryOperator:function(a,b,c){(b=this.supportedBinaryOperators[a])||Guard.raise(new Exception("Binary operator '"+a+"' is not supported by the provider"));c&&b.allowedIn&&(b.allowedIn instanceof Array&&!b.allowedIn.some(function(a){return c===Container.resolveType(a)})||!(b.allowedIn instanceof Array)&&c!==Container.resolveType(b.allowedIn))&&Guard.raise(new Exception(a+" not supported in: "+c.name));b.name=a;return b},supportedUnaryOperators:{value:{not:{mapTo:"not"}},
enumerable:!0,writable:!0},resolveUnaryOperator:function(a,b,c){(b=this.supportedUnaryOperators[a])||Guard.raise(new Exception("Unary operator '"+a+"' is not supported by the provider"));c&&b.allowedIn&&(b.allowedIn instanceof Array&&!b.allowedIn.some(function(a){return c===Container.resolveType(a)})||!(b.allowedIn instanceof Array)&&c!==Container.resolveType(b.allowedIn))&&Guard.raise(new Exception(a+" not supported in: "+c.name));b.name=a;return b},supportedSetOperations:{value:{toArray:{invokable:!0,
allowedIn:[]}},enumerable:!0,writable:!0},resolveSetOperations:function(a,b,c){(b=this.supportedSetOperations[a])||Guard.raise(new Exception("Operation '"+a+"' is not supported by the provider"));var d=b.allowedIn||[];c&&d&&(d instanceof Array&&!d.some(function(a){return c===Container.resolveType(a)})||!(d instanceof Array)&&c!==Container.resolveType(d))&&Guard.raise(new Exception(a+" not supported in: "+c.name));return b},makePhysicalTypeDefinition:function(){}},{registerProvider:function(a,b){$data.RegistredStorageProviders=
$data.RegistredStorageProviders||[];$data.RegistredStorageProviders[a]=b},getProvider:function(a){var b=$data.RegistredStorageProviders[a];b||console.warn("Provider not found: '"+a+"'");return b},isSupported:{get:function(){return true},set:function(){}}});$data.Base.extend("$data.EntityWrapper",{getEntity:function(){Guard.raise("pure object")}});"undefined"!==typeof jQuery&&jQuery.ajax&&($data.ajax=$data.ajax||jQuery.ajax);
"undefined"!==typeof WinJS&&WinJS.xhr&&($data.ajax=$data.ajax||function(a){$data.typeSystem.extend(a,{dataType:"json",headers:{}});var b={json:{accept:"application/json, text/javascript",convert:JSON.parse},text:{accept:"text/plain",convert:function(a){return a}},html:{accept:"text/html",convert:function(a){return a}},xml:{accept:"application/xml, text/xml",convert:function(a){return a}}}[a.dataType.toLowerCase()];a.headers.Accept=b.accept;var c=a.success||$data.defaultSuccessCallback,d=a.error||
$data.defaultErrorCallback,e=a.progress;WinJS.xhr(a).done(function(a){a=b.convert(a.responseText);c(a)},function(a){a=b.convert(a.responseText);d(a)},e)});"undefined"!==typeof Ext&&typeof Ext.Ajax&&($data.ajax=$data.ajax||function(a){Ext.Ajax.request(a)});$data.ajax=$data.ajax||function(){$data.TypeSystem.createCallbackSetting(arguments[arguments.length-1]).error("Not implemented")};
$data.Class.define("$data.dbClient.DbCommand",null,null,{connection:{},parameters:{},execute:function(){Guard.raise("Pure class")}},null);$data.Class.define("$data.dbClient.DbConnection",null,null,{connectionParams:{},database:{},isOpen:function(){Guard.raise("Pure class")},open:function(){Guard.raise("Pure class")},close:function(){Guard.raise("Pure class")},createCommand:function(){Guard.raise("Pure class")}},null);
$data.Class.define("$data.dbClient.openDatabaseClient.OpenDbCommand",$data.dbClient.DbCommand,null,{constructor:function(a,b,c){this.query=b;this.connection=a;this.parameters=c},executeNonQuery:function(a){a=$data.typeSystem.createCallbackSetting(a);this.exec(this.query,this.parameters,a.success,a.error)},executeQuery:function(a){a=$data.typeSystem.createCallbackSetting(a);this.exec(this.query,this.parameters,a.success,a.error)},exec:function(a,b,c,d){this.connection.open({success:function(e){function h(){--n==
0&&c(f?j[0]:j)}var f=false;if(!(a instanceof Array)){f=true;a=[a];b=[b]}var j=[],n=0;a.forEach(function(c,f){n++;if(c)e.executeSql(a[f],b[f],function(a,b){var c={rows:[]};try{c.insertId=b.insertId}catch(d){c.rowsAffected=b.rowsAffected;for(var e=b.rows.length,n=0;n<e;n++)c.rows.push(b.rows.item(n))}j[f]=c;h()},function(a,b){d&&d(b)});else{j[f]=null;h()}})}})}},null);
$data.Class.define("$data.dbClient.openDatabaseClient.OpenDbConnection",$data.dbClient.DbConnection,null,{constructor:function(a){this.connectionParams=a},isOpen:function(){return this.database!==null&&this.database!==void 0&&this.transaction!==null&&this.transaction!==void 0},open:function(a){if(this.database)this.database.transaction(function(b){a.success(b)});else{var b=this.connectionParams;this.database=openDatabase(b.fileName,b.version,b.displayName,b.maxSize);this.database.transaction(function(b){a.success(b)})}},
close:function(){this.database=this.transaction=void 0},createCommand:function(a,b){return new $data.dbClient.openDatabaseClient.OpenDbCommand(this,a,b)}},null);
$data.Class.define("$data.dbClient.jayStorageClient.JayStorageCommand",$data.dbClient.DbCommand,null,{constructor:function(a,b,c){this.query=b;this.connection=a;this.parameters=c},executeNonQuery:function(a){a=$data.typeSystem.createCallbackSetting(a);this.exec(this.query,this.parameters,a.success,a.error)},executeQuery:function(a){a=$data.typeSystem.createCallbackSetting(a);this.exec(this.query,this.parameters,a.success,a.error)},exec:function(a,b,c,d){if(b==null||b==void 0)b={};var e=false;if(!(a instanceof
Array)){e=true;a=[a];b=[b]}var h=[],f=a.length,j=function(){--f==0&&c(e?h[0]:h)};a.forEach(function(a,c){if(a)$data.ajax({url:"http"+(this.connection.connectionParams.storage.ssl?"s":"")+"://"+this.connection.connectionParams.storage.src.replace("http://","").replace("https://","")+"?db="+this.connection.connectionParams.storage.key,type:"POST",headers:{"X-PINGOTHER":"pingpong"},data:{query:a,parameters:b[c]},dataType:"json",contentType:"application/json;charset=UTF-8",success:function(a){if(a&&a.error){console.log("JayStorage error",
a.error);d(a.error)}else{h[c]=this.lastID?{insertId:this.lastID,rows:(a||{rows:[]}).rows}:{rows:(a||{rows:[]}).rows};j()}}});else{h[c]=null;j()}},this)}},null);$data.Class.define("$data.dbClient.jayStorageClient.JayStorageConnection",$data.dbClient.DbConnection,null,{constructor:function(a){this.connectionParams=a},isOpen:function(){return true},open:function(){},close:function(){},createCommand:function(a,b){return new $data.dbClient.jayStorageClient.JayStorageCommand(this,a,b)}},null);
$data.Class.define("$data.dbClient.sqLiteNJClient.SqLiteNjCommand",$data.dbClient.DbCommand,null,{constructor:function(a,b,c){this.query=b;this.connection=a;this.parameters=c},executeNonQuery:function(a){a=$data.typeSystem.createCallbackSetting(a);this.exec(this.query,this.parameters,a.success,a.error)},executeQuery:function(a){a=$data.typeSystem.createCallbackSetting(a);this.exec(this.query,this.parameters,a.success,a.error)},exec:function(a,b,c,d){this.connection.isOpen()||this.connection.open();
if(b==null||b==void 0)b={};var e=false;if(!(a instanceof Array)){e=true;a=[a];b=[b]}var h=this,f=[],j=0,n=function(){if(--j==0){h.connection.database.exec("COMMIT");c(e?f[0]:f)}};h.connection.database.exec("BEGIN");a.forEach(function(a,c){j++;if(a){var e=function(a,b){if(a!=null)d(a);else{f[c]=this.lastID?{insertId:this.lastID,rows:[]}:{rows:b};n()}},A=h.connection.database.prepare(a,b[c]);a.indexOf("SELECT")==0?A.all(e):A.run(e);A.finalize()}else{f[c]=null;n()}},this)}},null);
$data.Class.define("$data.dbClient.sqLiteNJClient.SqLiteNjConnection",$data.dbClient.DbConnection,null,{constructor:function(a){this.connectionParams=a},isOpen:function(){return this.database!==null&&this.database!==void 0},open:function(){if(this.database==null)this.database=new sqLiteModule.Database(this.connectionParams.fileName)},close:function(){},createCommand:function(a,b){return new $data.dbClient.sqLiteNJClient.SqLiteNjCommand(this,a,b)}},null);
$data.Class.define("$data.storageProviders.sqLite.SqLiteStorageProvider",$data.StorageProviderBase,null,{constructor:function(a,b){this.SqlCommands=[];this.context=b;this.providerConfiguration=$data.typeSystem.extend({databaseName:"JayDataDemo",version:"",displayName:"JayData demo db",maxSize:1048576,dbCreation:$data.storageProviders.sqLite.DbCreationType.DropTableIfChanged},a);if(this.context&&this.context._buildDbType_generateConvertToFunction&&this.buildDbType_generateConvertToFunction)this.context._buildDbType_generateConvertToFunction=
this.buildDbType_generateConvertToFunction;if(this.context&&this.context._buildDbType_modifyInstanceDefinition&&this.buildDbType_modifyInstanceDefinition)this.context._buildDbType_modifyInstanceDefinition=this.buildDbType_modifyInstanceDefinition},_createSqlConnection:function(){var a={fileName:this.providerConfiguration.databaseName,version:"",displayName:this.providerConfiguration.displayName,maxSize:this.providerConfiguration.maxSize,storage:this.providerConfiguration.storage};if(this.connection)return this.connection;
var b=null;return this.connection=b=this.providerConfiguration.storage?new $data.dbClient.jayStorageClient.JayStorageConnection(a):typeof sqLiteModule!=="undefined"?new $data.dbClient.sqLiteNJClient.SqLiteNjConnection(a):new $data.dbClient.openDatabaseClient.OpenDbConnection(a)},supportedDataTypes:{value:[$data.Integer,$data.String,$data.Number,$data.Blob,$data.Boolean,$data.Date],writable:!1},fieldConverter:{value:{fromDb:{"$data.Integer":function(a){return a},"$data.Number":function(a){return a},
"$data.Date":function(a){return new Date(a)},"$data.String":function(a){return a},"$data.Boolean":function(a){return a===1?true:false},"$data.Blob":function(a){return a}},toDb:{"$data.Integer":function(a){return a},"$data.Number":function(a){return a},"$data.Date":function(a){return a?a.valueOf():null},"$data.String":function(a){return a},"$data.Boolean":function(a){return a?1:0},"$data.Blob":function(a){return a}}}},supportedFieldOperations:{value:{length:{dataType:"number",allowedIn:[$data.Expressions.FilterExpression,
$data.Expressions.ProjectionExpression]},substr:{dataType:"string",allowedIn:$data.Expressions.FilterExpression,parameters:[{name:"startFrom",dataType:"number"},{name:"length",dataType:"number"}]},toLowerCase:{dataType:"string",mapTo:"lower"},toUpperCase:{dataType:"string",mapTo:"upper"},contains:{mapTo:"like",dataType:"boolean",allowedIn:$data.Expressions.FilterExpression,parameters:[{name:"strFragment",dataType:"string",prefix:"%",suffix:"%"}]},startsWith:{mapTo:"like",dataType:"boolean",allowedIn:[$data.Expressions.FilterExpression,
$data.Expressions.ProjectionExpression],parameters:[{name:"strFragment",dataType:"string",suffix:"%"}]},endsWith:{mapTo:"like",dataType:"boolean",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.ProjectionExpression],parameters:[{name:"strFragment",dataType:"string",prefix:"%"}]},trim:{dataType:$data.String,allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.ProjectionExpression],mapTo:"trim",parameters:[{name:"@expression",dataType:$data.String},{name:"chars",dataType:$data.String}]},
ltrim:{dataType:$data.String,allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.ProjectionExpression],mapTo:"ltrim",parameters:[{name:"@expression",dataType:$data.String},{name:"chars",dataType:$data.String}]},rtrim:{dataType:$data.String,allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.ProjectionExpression],mapTo:"rtrim",parameters:[{name:"@expression",dataType:$data.String},{name:"chars",dataType:$data.String}]}},enumerable:!0,writable:!0},supportedBinaryOperators:{value:{equal:{mapTo:"=",
dataType:"boolean"},notEqual:{mapTo:"!=",dataType:"boolean"},equalTyped:{mapTo:"=",dataType:"boolean"},notEqualTyped:{mapTo:"!=",dataType:"boolean"},greaterThan:{mapTo:">",dataType:"boolean"},greaterThanOrEqual:{mapTo:">=",dataType:"boolean"},lessThan:{mapTo:"<",dataType:"boolean"},lessThenOrEqual:{mapTo:"<=",dataType:"boolean"},or:{mapTo:"OR",dataType:"boolean"},and:{mapTo:"AND",dataType:"boolean"},add:{mapTo:"+",dataType:"number"},divide:{mapTo:"/"},multiply:{mapTo:"*"},subtract:{mapTo:"-"},modulo:{mapTo:"%"},
orBitwise:{maptTo:"|"},andBitwsise:{mapTo:"&"},"in":{mapTo:"in",dataType:"boolean"}}},supportedUnaryOperators:{value:{not:{mapTo:"not"},positive:{mapTo:"+"},negative:{maptTo:"-"}}},supportedSetOperations:{value:{filter:{},map:{},length:{},forEach:{},toArray:{},single:{},take:{},skip:{},orderBy:{},orderByDescending:{},first:{},include:{}},enumerable:!0,writable:!0},buildDbType_modifyInstanceDefinition:function(a,b){var c=function(a){var b=JSON.parse(JSON.stringify(a));b.dataType=Container.resolveType(a.dataType);
b.key=false;b.computed=false;return b},d=function(a,b,c,d){var n={};n[a.name]=c;n[b.name]=d+"__"+c;return n};b.Associations&&b.Associations.forEach(function(b){var h=false,f=b.FromType,j=b.ToType,n=b.ToPropertyName;b.ReferentialConstraint=b.ReferentialConstraint||[];if(b.FromMultiplicity=="*"&&b.ToMultiplicity=="0..1"||b.FromMultiplicity=="0..1"&&b.ToMultiplicity=="1"){f=b.ToType;j=b.FromType;n=b.FromPropertyName;h=true}f.memberDefinitions.getPublicMappedProperties().filter(function(a){return a.key}).forEach(function(u){h&&
(a[n+"__"+u.name]=c(u));b.ReferentialConstraint.push(d(f,j,u.name,n))},this)},this);b.ComplexTypes&&b.ComplexTypes.forEach(function(b){b.ReferentialConstraint=b.ReferentialConstraint||[];b.ToType.memberDefinitions.getPublicMappedProperties().forEach(function(h){a[b.FromPropertyName+"__"+h.name]=c(h);b.ReferentialConstraint.push(d(b.ToType,b.FromType,h.name,b.FromPropertyName))},this)},this)},buildDbType_generateConvertToFunction:function(a){return function(b){var c=new a.PhysicalType;c.entityState=
b.entityState;a.PhysicalType.memberDefinitions.getPublicMappedProperties().forEach(function(a){c[a.name]=b[a.name]},this);a.Associations&&a.Associations.forEach(function(a){if(a.FromMultiplicity=="*"&&a.ToMultiplicity=="0..1"||a.FromMultiplicity=="0..1"&&a.ToMultiplicity=="1"){var e=b[a.FromPropertyName];e!==void 0&&a.ReferentialConstraint.forEach(function(b){c[b[a.From]]=e!==null?e[b[a.To]]:null},this)}},this);a.ComplexTypes&&a.ComplexTypes.forEach(function(a){var e=b[a.FromPropertyName];e!==void 0&&
a.ReferentialConstraint.forEach(function(b){c[b[a.From]]=e!==null?e[b[a.To]]:null},this)},this);return c}},initializeStore:function(a){a=$data.typeSystem.createCallbackSetting(a);this.context._storageModel.forEach(function(a){this.SqlCommands.push(this.createSqlFromStorageModel(a)+" ")},this);var b=this._createSqlConnection(),c=this;b.createCommand("SELECT * FROM sqlite_master WHERE type = 'table'",null).executeQuery({success:function(d){for(var e={},h=0;h<d.rows.length;h++){var f=d.rows[h];e[f.tbl_name]=
f}switch(c.providerConfiguration.dbCreation){case $data.storageProviders.sqLite.DbCreationType.Merge:Guard.raise(new Exception("Not supported db creation type"));break;case $data.storageProviders.sqLite.DbCreationType.DropTableIfChanged:d=[];for(h=0;h<c.SqlCommands.length;h++)if(c.SqlCommands[h]!=""){var f=/^CREATE TABLE IF NOT EXISTS ([^ ]*) (\(.*\))/g,j=f.exec(c.SqlCommands[h]);if(j){f=j[1];j=j[2];if(e[f.slice(1,f.length-1)]){var n=/^CREATE TABLE ([^ ]*) (\(.*\))/g.exec(e[f.slice(1,f.length-1)].sql)[2];
j.toLowerCase()!=n.toLowerCase()&&d.push("DROP TABLE IF EXISTS ["+e[f.slice(1,f.length-1)].tbl_name+"];")}}else{console.dir(f);console.dir(c.SqlCommands[h])}}c.SqlCommands=c.SqlCommands.concat(d);console.log(d);break;case $data.storageProviders.sqLite.DbCreationType.DropAllExistingTables:for(j in e)j&&!j.match("^__")&&!j.match("^sqlite_")&&c.SqlCommands.push("DROP TABLE IF EXISTS ["+e[j].tbl_name+"];")}c._runSqlCommands(b,{success:a.success,error:a.error})},error:a.error})},executeQuery:function(a,
b){var b=$data.typeSystem.createCallbackSetting(b),c=this._createSqlConnection(),d=this._compile(a);a.actionPack=d.actions;a.sqlConvertMetadata=d.converter;a.modelBinderConfig=d.modelBinderConfig;c.createCommand(d.sqlText,d.params).executeQuery({success:function(c){if(b.success){a.rawDataList=c.rows;b.success(a)}},error:b.error})},_compile:function(a){var b=new $data.storageProviders.sqLite.SQLiteCompiler,a=b.compile(a);a.hasSelect=b.select!=null;return a},getTraceString:function(a){return this._compile(a)},
_runSqlCommands:function(a,b){if(this.SqlCommands&&this.SqlCommands.length>0){var c=this.SqlCommands.pop(),d=this;a.createCommand(c,null).executeQuery({success:function(){d._runSqlCommands.apply(d,[a,b])},error:b.error})}else b.success(this.context)},setContext:function(a){this.context=a},saveChanges:function(a,b){var c=this._createSqlConnection(),d=this.buildIndependentBlocks(b);this.saveIndependentBlocks(b,d,c,a)},saveIndependentBlocks:function(a,b,c,d){function e(){if(f.length===0)d.success();
else{var a=f.shift().map(function(a){var b=h.context._storageModel.getStorageModel(a.data.getType()).PhysicalType;a.physicalData=b.convertTo(a.data);return a},this);h.saveIndependentItems(a,c,{success:function(){h.postProcessItems(a);e()},error:d.error})}}var h=this,f=[].concat(b);e()},saveIndependentItems:function(a,b,c){function d(a,b){var c=[],d=[];b.forEach(function(a,b){if(a){if(a.query)c[b]=a.query;if(a.param)d[b]=a.param}});return a.createCommand(c,d)}var e=this,h=a.map(function(a){return e.saveEntitySet(a)}),
h=h.filter(function(a){return a});h.length===0?c.success(a):d(b,h).executeQuery({success:function(f){f=f.map(function(c,d){return c&&c.insertId?e.save_reloadSavedEntity(c.insertId,a[d].entitySet.tableName,b):null});f=d(b,f);f.query.length>0?f.executeQuery(function(b){b.forEach(function(b,c){if(b&&b.rows)a[c].physicalData.initData=b.rows[0]});c.success(a)}):c.success(0)},error:c.error})},postProcessItems:function(a){function b(a){var b=a.name;if(c.hasOwnProperty(b))return c[b];a=a.memberDefinitions.getPublicMappedProperties().filter(function(a){return a.computed});
return c[b]=a}var c={};a.forEach(function(a){a.physicalData&&b(a.data.getType()).forEach(function(b){a.data[b.name]=a.physicalData[b.name]},this)},this)},saveEntitySet:function(a){switch(a.data.entityState){case $data.EntityState.Added:return this.save_NewEntity(a);case $data.EntityState.Deleted:return this.save_DeleteEntity(a);case $data.EntityState.Modified:return this.save_UpdateEntity(a);case $data.EntityState.Unchanged:break;default:Guard.raise(new Exception("Not supported entity state"))}},
save_DeleteEntity:function(a){for(var b="DELETE FROM ["+a.entitySet.name+"] WHERE(",c=false,d=false,e=[];!c;){a.physicalData.constructor.memberDefinitions.getPublicMappedProperties().forEach(function(h){c&&!b.match(" AND $")&&(b=b+" AND ");if(h.key||d){b=b+("(["+h.name+"] == ?)");e.push(this.fieldConverter.toDb[Container.resolveName(h.dataType)](a.data[h.name]));c=true}},this);c||(d=true)}b.match(" AND $")&&(b=b.slice(0,b.length-5));b=b+");";return{query:b,param:e}},save_UpdateEntity:function(a){var b=
" SET ",c="WHERE(",d=false,e=[],h=[];a.physicalData.constructor.memberDefinitions.getPublicMappedProperties().forEach(function(f){if(a.physicalData[f.name]!==void 0){d&&!c.match(" AND $")&&(c=c+" AND ");b.length>5&&!b.match(",$")&&(b=b+",");if(f.key){c=c+("(["+f.name+"] == ?)");e.push(this.fieldConverter.toDb[Container.resolveName(f.dataType)](a.physicalData[f.name]));d=true}else{b=b+("["+f.name+"] = ?");h.push(this.fieldConverter.toDb[Container.resolveName(f.dataType)](a.physicalData[f.name]))}}},
this);d||Guard.raise(new Exception("Not supported UPDATE function without primary key!"));c.match(" AND $")&&(c=c.slice(0,c.length-5));b.match(",$")&&(b=b.slice(0,b.length-1));return{query:"UPDATE ["+a.entitySet.tableName+"]"+b+" "+c+");",param:h.concat(e)}},save_NewEntity:function(a){var b="INSERT INTO ["+a.entitySet.tableName+"](",c="",d="",e=[];a.physicalData.constructor.memberDefinitions.getPublicMappedProperties().forEach(function(b){if(c.length>0&&c[c.length-1]!=","){c=c+",";d=d+","}var f=b.name;
if(a.physicalData[f]!==void 0&&b.dataType&&(!b.dataType.isAssignableTo||b.dataType.isAssignableTo&&!b.dataType.isAssignableTo($data.EntitySet))){d=d+"?";c=c+("["+f+"]");e.push(this.fieldConverter.toDb[Container.resolveName(b.dataType)](a.physicalData[f]))}},this);e.length<1&&Guard.raise(new Exception("None of the fields contain values in the entity to be saved."));c[c.length-1]==","&&(c=c.slice(0,c.length-1));d[d.length-1]==","&&(d=d.slice(0,d.length-1));return{query:b+(c+") VALUES("+d+");"),param:e}},
save_reloadSavedEntity:function(a,b){return{query:"SELECT * FROM "+b+" WHERE rowid=?",param:[a]}},createSqlFromStorageModel:function(a){(a===void 0||a===null||a.PhysicalType===void 0)&&Guard.raise("StorageModel not contains physical entity definition");var b=0,c=0;a.PhysicalType.memberDefinitions.getPublicMappedProperties().forEach(function(a){a.key&&b++;a.computed&&c++},this);c===1&&b>1&&Guard.raise(new Exception("Do not use computed field with multiple primary key!"));c>1&&b>1&&Guard.raise(new Exception("Do not use multiple computed field!"));
var d="CREATE TABLE IF NOT EXISTS ["+a.TableName+"] (",e=",PRIMARY KEY (";a.PhysicalType.memberDefinitions.getPublicMappedProperties().forEach(function(b,f){f>0&&!d.match(", $")&&!d.match("\\($")&&(d=d+", ");d=d+this.createSqlFragmentFromField(b,c===1,a);if(c===0&&b.key){e.length>14&&!e.match(", $")&&(e=e+", ");e=e+("["+b.name+"]")}},this);d.match(", $")&&(d=d.substr(0,d.length-2));c===0&&e.length>14&&(d=d+(e+")"));return d=d+");"},createSqlFragmentFromField:function(a,b,c){return"schemaCreate"in
a&&a.schemaCreate?a.schemaCreate(a):(new this.FieldTypeBuilder(a,this,b,c)).build()},FieldTypeBuilder:function(a,b,c,d){this.fieldDef="";this.fld=a;this.provider=b;this.parsePk=c;this.entitySet=d;this.build=function(){switch(Container.resolveType(this.fld.dataType)){case $data.String:case "text":case "string":this.buildFieldNameAndType("TEXT");break;case $data.Boolean:case $data.Integer:case "bool":case "boolean":case "int":case "integer":this.buildFieldNameAndType("INTEGER");break;case $data.Number:case $data.Date:case "number":case "datetime":case "date":this.buildFieldNameAndType("REAL");
break;case $data.Blob:case "blob":this.buildFieldNameAndType("BLOB");break;default:this.buildRelations()}return this.fieldDef};this.buildFieldNameAndType=function(a){this.fieldDef="["+this.fld.name+"] "+a;this.parsePk?this.buildPrimaryKey():this.buildNotNull()};this.buildPrimaryKey=function(){if(this.fld.key){this.fieldDef=this.fieldDef+" PRIMARY KEY";this.buildAutoIncrement()}else this.buildNotNull()};this.buildNotNull=function(){if(this.fld.required)this.fieldDef=this.fieldDef+" NOT NULL"};this.buildAutoIncrement=
function(){if(this.fld.computed)this.fieldDef=this.fieldDef+" AUTOINCREMENT"}}},{isSupported:{get:function(){return"openDatabase"in window},set:function(){}}});$data.storageProviders.sqLite.DbCreationType={Merge:10,DropTableIfChanged:20,DropAllExistingTables:30};
$data.storageProviders.sqLite.SqLiteStorageProvider.isSupported&&($data.StorageProviderBase.registerProvider("webSql",$data.storageProviders.sqLite.SqLiteStorageProvider),$data.StorageProviderBase.registerProvider("sqLite",$data.storageProviders.sqLite.SqLiteStorageProvider),$data.webSqlProvider=$data.storageProviders.sqLite.SqLiteStorageProvider);
var SqlStatementBlocks={beginGroup:"(",endGroup:")",nameSeparator:".",valueSeparator:", ",select:"SELECT ",where:" WHERE ",from:" FROM ",skip:" OFFSET ",take:" LIMIT ",parameter:"?",order:" ORDER BY ",as:" AS ",scalarFieldName:"d",rowIdName:"rowid$$",count:"select count(*) cnt from ("};
$C("$data.queryBuilder",null,null,{constructor:function(){this._fragments={};this.selectedFragment=null;this.modelBinderConfig=this._binderConfig={};this._binderConfigPropertyStack=[]},selectTextPart:function(a){this._fragments[a]||(this._fragments[a]={text:"",params:[]});this.selectedFragment=this._fragments[a]},getTextPart:function(a){return this._fragments[a]},addText:function(a){this.selectedFragment.text=this.selectedFragment.text+a},addParameter:function(a){this.selectedFragment.params.push(a)},
selectModelBinderProperty:function(a){this._binderConfigPropertyStack.push(this.modelBinderConfig);a in this.modelBinderConfig||(this.modelBinderConfig[a]={});this.modelBinderConfig=this.modelBinderConfig[a]},popModelBinderProperty:function(){this.modelBinderConfig=this._binderConfigPropertyStack.length===0?this._binderConfig():this._binderConfigPropertyStack.pop()},resetModelBinderProperty:function(){this._binderConfigPropertyStack=[];this.modelBinderConfig=this._binderConfig},addKeyField:function(a){this.modelBinderConfig.$keys||
(this.modelBinderConfig.$keys=[]);this.modelBinderConfig.$keys.push(a)}});$C("$data.sqLite.SqlBuilder",$data.queryBuilder,null,{constructor:function(a,b){this.sets=a;this.entityContext=b},getExpressionAlias:function(a){var b=this.sets.indexOf(a);b==-1&&(b=this.sets.push(a)-1);return"T"+b}});
$C("$data.sqLite.SqlCompiler",$data.Expressions.EntityExpressionVisitor,null,{constructor:function(a,b){this.queryExpression=a;this.sets=b.sets;this.infos=b.infos;this.entityContext=b.entityContext;this.associations=[];this.filters=[];this.newFilters={};this.sortedFilterPart=["projection","from","filter","order","take","skip"]},compile:function(){var a=Container.createSqlBuilder(this.sets,this.entityContext);this.Visit(this.queryExpression,a);a.getTextPart("projection")===void 0&&this.VisitDefaultProjection(a);
a.selectTextPart("result");this.sortedFilterPart.forEach(function(b){if(b=a.getTextPart(b)){a.addText(b.text);a.selectedFragment.params=a.selectedFragment.params.concat(b.params)}},this);var b=a.getTextPart("count");if(b!==void 0){a.selectedFragment.text=b.text+a.selectedFragment.text;a.addText(SqlStatementBlocks.endGroup);a.selectedFragment.params=a.selectedFragment.params.concat(b.params)}a.resetModelBinderProperty();this.filters.push(a)},VisitToArrayExpression:function(a,b){this.Visit(a.source,
b)},VisitCountExpression:function(a,b){this.Visit(a.source,b);b.selectTextPart("count");b.addText(SqlStatementBlocks.count)},VisitFilterExpression:function(a,b){this.Visit(a.source,b);b.selectTextPart("filter");b.addText(SqlStatementBlocks.where);Container.createSqlFilterCompiler().Visit(a.selector,b);return a},VisitOrderExpression:function(a,b){this.Visit(a.source,b);b.selectTextPart("order");if(this.addOrders)b.addText(SqlStatementBlocks.valueSeparator);else{this.addOrders=true;b.addText(SqlStatementBlocks.order)}Container.createSqlOrderCompiler().Visit(a,
b);return a},VisitPagingExpression:function(a,b){this.Visit(a.source,b);switch(a.nodeType){case ExpressionType.Skip:b.selectTextPart("skip");b.addText(SqlStatementBlocks.skip);break;case ExpressionType.Take:b.selectTextPart("take");b.addText(SqlStatementBlocks.take);break;default:Guard.raise("Not supported nodeType")}Container.createSqlPagingCompiler().Visit(a,b);return a},VisitProjectionExpression:function(a,b){this.Visit(a.source,b);b.selectTextPart("projection");this.hasProjection=true;b.addText(SqlStatementBlocks.select);
Container.createSqlProjectionCompiler().Visit(a,b)},VisitIncludeExpression:function(a){var b=Container.createSqlBuilder(this.sets,this.entityContext);this.Visit(a.source,b);this.newFilters.include=projectionBuilder},VisitEntitySetExpression:function(a,b){b.selectTextPart("from");b.addText(SqlStatementBlocks.from);b.sets.forEach(function(a,d){d>0&&b.addText(" \n\tLEFT OUTER JOIN ");var e=b.getExpressionAlias(a);b.addText(a.instance.tableName+" ");b.addText(e);if(d>0){b.addText(" ON (");var h=this.infos[d],
f="T"+h.AliasNumber,j=h.NavigationPath.substring(0,h.NavigationPath.lastIndexOf(".")),e=this.infos.filter(function(a){return a.NavigationPath==j},this),n="T0";e.length>0&&(n="T"+e[0].AliasNumber);h.Association.associationInfo.ReferentialConstraint.forEach(function(a){b.addText(n+"."+a[h.Association.associationInfo.From]);b.addText(" = ");b.addText(f+"."+a[h.Association.associationInfo.To])},this);b.addText(")")}},this)},VisitDefaultProjection:function(a){a.selectTextPart("projection");if(a.sets.length>
1){a.addText(SqlStatementBlocks.select);a.sets[0].storageModel.PhysicalType.memberDefinitions.getPublicMappedProperties().forEach(function(b,c){c>0&&a.addText(SqlStatementBlocks.valueSeparator);a.addText("T0.");a.addText(b.name)},this)}else a.addText("SELECT *")}});$data.Expressions.ExpressionNode.prototype.monitor=function(a,b){return Container.createExpressionMonitor(a).Visit(this,b)};
$C("$data.storageProviders.sqLite.SQLiteCompiler",null,null,{compile:function(a){var b={sets:[],infos:[],entityContext:a.context},c=a.expression.monitor({MonitorEntitySetExpression:function(a,b){if(a.source instanceof $data.Expressions.EntityContextExpression&&b.sets.indexOf(a)==-1){b.sets.push(a);b.infos.push({AliasNumber:0,Association:null,FromType:null,FromPropertyName:null})}},MutateEntitySetExpression:function(a,b){if(a.source instanceof $data.Expressions.EntityContextExpression){this.backupContextExpression=
a.source;this.path="";return a}a.selector.associationInfo.FromMultiplicity=="0..1"&&a.selector.associationInfo.FromMultiplicity=="*"&&Guard.raise("Not supported query on this navigation property: "+a.selector.associationInfo.From+" "+a.selector.associationInfo.FromPropertyName);this.path=this.path+("."+a.selector.associationInfo.FromPropertyName);var c=b.infos.filter(function(a){return a.NavigationPath==this.path},this);if(c.length>0)return b.sets[c[0].AliasNumber];(c=this.backupContextExpression.instance.getType().memberDefinitions.getMember(a.storageModel.EntitySetReference.name))||
Guard.raise("Context schema error");c=Container.createMemberInfoExpression(c);c=Container.createEntitySetExpression(this.backupContextExpression,c);c.instance=this.backupContextExpression.instance[a.storageModel.EntitySetReference.name];var f=b.sets.push(c);b.infos.push({AliasNumber:f-1,Association:a.selector,NavigationPath:this.path});return c}},b),b=Container.createSqlCompiler(c,b);b.compile();Container.createSqlBuilder(this.sets,this.entityContext);a.modelBinderConfig={};Container.createsqLite_ModelBinderCompiler(a,
[]).Visit(c);return{sqlText:b.filters[0].selectedFragment.text,params:b.filters[0].selectedFragment.params,modelBinderConfig:a.modelBinderConfig}}},null);$C("$data.sqLite.SqlPagingCompiler",$data.Expressions.EntityExpressionVisitor,null,{constructor:function(a){this.provider=a},compile:function(a,b){this.Visit(a,b)},VisitPagingExpression:function(a,b){this.Visit(a.amount,b)},VisitConstantExpression:function(a,b){b.addParameter(a.value);b.addText(SqlStatementBlocks.parameter)}});
$C("$data.sqLite.SqlOrderCompiler",$data.Expressions.EntityExpressionVisitor,null,{constructor:function(a){this.provider=a},compile:function(a,b){this.Visit(a,b)},VisitEntitySetExpression:function(a,b){var c=b.getExpressionAlias(a);b.addText(c);b.addText(SqlStatementBlocks.nameSeparator)},VisitOrderExpression:function(a,b){this.Visit(a.selector,b);a.nodeType==ExpressionType.OrderByDescending?b.addText(" DESC"):b.addText(" ASC")},VisitParametricQueryExpression:function(a,b){this.Visit(a.expression,
b)},VisitEntityFieldExpression:function(a,b){this.Visit(a.source,b);this.Visit(a.selector,b)},VisitMemberInfoExpression:function(a,b){b.addText(a.memberName)},VisitComplexTypeExpression:function(a,b){this.Visit(a.source,b);this.Visit(a.selector,b);b.addText("__")}});
$C("$data.sqLite.SqlProjectionCompiler",$data.Expressions.EntityExpressionVisitor,null,{constructor:function(){this.anonymFiledPrefix="";this.currentObjectLiteralName=null},VisitProjectionExpression:function(a,b){this.Visit(a.selector,b)},VisitParametricQueryExpression:function(a,b){if(a.expression instanceof $data.Expressions.EntityExpression)this.VisitEntityExpressionAsProjection(a,b);else if(a.expression instanceof $data.Expressions.ObjectLiteralExpression)this.Visit(a.expression,b);else{this.VisitEntitySetExpression(b.sets[0],
b);b.addText("rowid");b.addText(SqlStatementBlocks.as);b.addText(SqlStatementBlocks.rowIdName);b.addText(", ");b.addKeyField(SqlStatementBlocks.rowIdName);this.Visit(a.expression,b);b.addText(SqlStatementBlocks.as);b.addText(SqlStatementBlocks.scalarFieldName)}},VisitEntityExpressionAsProjection:function(a,b){var c=a.expression,d=b.getExpressionAlias(c.source),e=this.anonymFiledPrefix+(a.fieldName?a.fieldName:""),e=e?e+"__":"";c.storageModel.PhysicalType.memberDefinitions.getPublicMappedProperties().forEach(function(a,
c){c>0&&b.addText(SqlStatementBlocks.valueSeparator);var j=e+a.name;b.addText(d);b.addText(SqlStatementBlocks.nameSeparator);b.addText(a.name);b.addText(SqlStatementBlocks.as);b.addText(j)},this)},VisitEntityFieldOperationExpression:function(a,b){Guard.requireType("expression.operation",a.operation,$data.Expressions.MemberInfoExpression);var c=a.operation.memberDefinition,d=c.mapTo||c.name;b.addText(d);b.addText(SqlStatementBlocks.beginGroup);if(d==="like"){d=Container.createSqlBuilder();this.Visit(a.parameters[0],
d);d.params.forEach(function(a){var d=c.parameters[0],a=d.prefix?d.prefix+a:a,a=d.suffix?a+d.suffix:a;b.addParameter(a)});b.addText(d.sql);b.addText(" , ");this.Visit(a.source,b)}else{this.Visit(a.source,b);a.parameters.forEach(function(a){b.addText(" , ");this.Visit(a,b)},this)}b.addText(SqlStatementBlocks.endGroup)},VisitUnaryExpression:function(a,b){b.addText(a.resolution.mapTo);b.addText(SqlStatementBlocks.beginGroup);this.Visit(a.operand,b);b.addText(SqlStatementBlocks.endGroup)},VisitSimpleBinaryExpression:function(a,
b){b.addText(SqlStatementBlocks.beginGroup);this.Visit(a.left,b);var c=this;b.addText(" "+a.resolution.mapTo+" ");if(a.nodeType=="in"){Guard.requireType("expression.right",a.right,$data.Expressions.ConstantExpression);var d=a.right.value;if(d instanceof Array){b.addText(SqlStatementBlocks.beginGroup);d.forEach(function(a,d){d>0&&b.addText(SqlStatementBlocks.valueSeparator);var f=Container.createConstantExpression(a);c.Visit(f,b)});b.addText(SqlStatementBlocks.endGroup)}else d instanceof $data.Queryable?
Guard.raise("not yet... but coming"):Guard.raise(new Exception("Only constant arrays and Queryables can be on the right side of 'in' operator","UnsupportedType"))}else this.Visit(a.right,b);b.addText(SqlStatementBlocks.endGroup)},VisitConstantExpression:function(a,b){b.addParameter(a.value);b.addText(SqlStatementBlocks.parameter)},VisitEntityFieldExpression:function(a,b){this.Visit(a.source,b);this.Visit(a.selector,b)},VisitEntitySetExpression:function(a,b){var c=b.getExpressionAlias(a);b.addText(c);
b.addText(SqlStatementBlocks.nameSeparator)},VisitComplexTypeExpression:function(a,b){var c=b.getExpressionAlias(a.source.source),d=a.source.storageModel.ComplexTypes[a.selector.memberName];d.ReferentialConstraint.forEach(function(a,h){h>0&&b.addText(SqlStatementBlocks.valueSeparator);b.addText(c);b.addText(SqlStatementBlocks.nameSeparator);b.addText(a[d.From]);b.addText(SqlStatementBlocks.as);b.addText(this.anonymFiledPrefix+a[d.To])},this)},VisitMemberInfoExpression:function(a,b){b.addText(a.memberName)},
VisitObjectLiteralExpression:function(a,b){this.VisitEntitySetExpression(b.sets[0],b);b.addText("rowid AS "+this.anonymFiledPrefix+SqlStatementBlocks.rowIdName+", ");for(var c=a.members.length,d=0;d<c;d++){d!=0&&b.addText(SqlStatementBlocks.valueSeparator);this.Visit(a.members[d],b)}},VisitObjectFieldExpression:function(a,b){var c=this.currentObjectLiteralName;this.currentObjectLiteralName=this.currentObjectLiteralName?this.currentObjectLiteralName+("."+a.fieldName):a.fieldName;if(a.expression instanceof
$data.Expressions.EntityExpression)this.VisitEntityExpressionAsProjection(a,b);else{var d=this.anonymFiledPrefix;this.anonymFiledPrefix=this.anonymFiledPrefix+(a.fieldName+"__");this.Visit(a.expression,b);this.anonymFiledPrefix=d;if(!(a.expression instanceof $data.Expressions.ObjectLiteralExpression)&&!(a.expression instanceof $data.Expressions.ComplexTypeExpression)){b.addText(SqlStatementBlocks.as);b.addText(this.anonymFiledPrefix+a.fieldName)}}this.currentObjectLiteralName=c}},null);
$C("$data.sqLite.ExpressionMonitor",$data.Expressions.EntityExpressionVisitor,null,{constructor:function(a){this.Visit=function(b,c){var d=b,e;if(this.canVisit(b)){a.VisitExpressionNode&&a.VisitExpressionNode.apply(a,arguments);e="Visit"+b.getType().name;e in a&&(d=a[e].apply(a,arguments))}var h=arguments;d!==b&&(h=[d,c]);d=$data.Expressions.EntityExpressionVisitor.prototype.Visit.apply(this,h);h=[d,c];if(this.canVisit(d)){var f=d.getType().name;a.MonitorExpressionNode&&a.MonitorExpressionNode.apply(a,
h);e="Monitor"+f;e in a&&a[e].apply(a,h);a.MutateExpressionNode&&a.MutateExpressionNode.apply(a,h);e="Mutate"+f;e in a&&(d=a[e].apply(a,h))}return d}}});
$C("$data.sqLite.SqlFilterCompiler",$data.Expressions.EntityExpressionVisitor,null,{VisitParametricQueryExpression:function(a,b){this.Visit(a.expression,b)},VisitUnaryExpression:function(a,b){b.addText(a.resolution.mapTo);b.addText(SqlStatementBlocks.beginGroup);this.Visit(a.operand,b);b.addText(SqlStatementBlocks.endGroup)},VisitSimpleBinaryExpression:function(a,b){var c=this;if(a.nodeType=="arrayIndex")this.Visit(a.left,b);else{b.addText(SqlStatementBlocks.beginGroup);this.Visit(a.left,b);b.addText(" "+
a.resolution.mapTo+" ");if(a.nodeType=="in"){Guard.requireType("expression.right",a.right,$data.Expressions.ConstantExpression);var d=a.right.value;if(d instanceof Array){b.addText(SqlStatementBlocks.beginGroup);d.forEach(function(a,d){d>0&&b.addText(SqlStatementBlocks.valueSeparator);var f=Container.createConstantExpression(a);c.Visit(f,b)});b.addText(SqlStatementBlocks.endGroup)}else d instanceof $data.Queryable?b.addText("(SELECT d FROM ("+d.toTraceString().sqlText+"))"):Guard.raise(new Exception("Only constant arrays and Queryables can be on the right side of 'in' operator",
"UnsupportedType"))}else this.Visit(a.right,b);b.addText(SqlStatementBlocks.endGroup)}},VisitEntitySetExpression:function(a,b){var c=b.getExpressionAlias(a);b.addText(c);b.addText(SqlStatementBlocks.nameSeparator)},VisitEntityFieldOperationExpression:function(a,b){Guard.requireType("expression.operation",a.operation,$data.Expressions.MemberInfoExpression);var c=a.operation.memberDefinition,d=c.mapTo||c.name;b.addText(d);b.addText(SqlStatementBlocks.beginGroup);if(d==="like"){d=Container.createSqlBuilder([],
b.entityContext);d.selectTextPart("fragment");this.Visit(a.parameters[0],d);d=d.getTextPart("fragment");d.params.forEach(function(a){var d=c.parameters[0],a=d.prefix?d.prefix+a:a,a=d.suffix?a+d.suffix:a;b.addParameter(a)});b.addText(d.text);b.addText(" , ");this.Visit(a.source,b)}else{this.Visit(a.source,b);a.parameters.forEach(function(a){b.addText(" , ");this.Visit(a,b)},this)}b.addText(SqlStatementBlocks.endGroup)},VisitMemberInfoExpression:function(a,b){b.addText(a.memberName)},VisitQueryParameterExpression:function(a,
b){var c=null,c=a.type=="array"?a.value[a.index]:a.value;b.addParameter(c);b.addText(SqlStatementBlocks.parameter)},VisitConstantExpression:function(a,b){var c=Container.getTypeName(a.value),c=b.entityContext.storageProvider.fieldConverter.toDb[Container.resolveName(Container.resolveType(c))](a.value);b.addParameter(c);b.addText(SqlStatementBlocks.parameter)},VisitEntityFieldExpression:function(a,b){this.Visit(a.source,b);this.Visit(a.selector,b)},VisitComplexTypeExpression:function(a,b){this.Visit(a.source,
b);this.Visit(a.selector,b);b.addText("__")}});
$C("$data.sqLite.sqLite_ModelBinderCompiler",$data.Expressions.EntityExpressionVisitor,null,{constructor:function(a,b){this._query=a;this._includes=b},VisitSingleExpression:function(a){this._defaultModelBinder(a)},VisitSomeExpression:function(a){this._defaultModelBinder(a)},VisitEveryExpression:function(a){this._defaultModelBinder(a)},VisitToArrayExpression:function(a){this._defaultModelBinder(a)},VisitFirstExpression:function(a){this._defaultModelBinder(a)},VisitForEachExpression:function(a){this._defaultModelBinder(a)},
VisitCountExpression:function(){var a=Container.createqueryBuilder();a.modelBinderConfig.$type=$data.Array;a.selectModelBinderProperty("$item");a.modelBinderConfig.$type=$data.Integer;a.modelBinderConfig.$source="cnt";a.resetModelBinderProperty();this._query.modelBinderConfig=a.modelBinderConfig},VisitExpression:function(a,b){var c=Container.createFindProjectionVisitor();c.Visit(a);c.projectionExpression?this.Visit(c.projectionExpression,b):this.DefaultSelection(b)},_defaultModelBinder:function(a){var b=
Container.createqueryBuilder();b.modelBinderConfig.$type=$data.Array;b.modelBinderConfig.$item={};b.selectModelBinderProperty("$item");this.VisitExpression(a,b);b.resetModelBinderProperty();this._query.modelBinderConfig=b.modelBinderConfig},_addPropertyToModelBinderConfig:function(a,b){var c=this._query.context._storageModel.getStorageModel(a);a.memberDefinitions.getPublicMappedProperties().forEach(function(a){if(!c||c&&!c.Associations[a.name]&&!c.ComplexTypes[a.name]){a.key&&(this.currentObjectFieldName?
b.addKeyField(this.currentObjectFieldName+"__"+a.name):b.addKeyField(a.name));b.modelBinderConfig[a.name]=this.currentObjectFieldName?this.currentObjectFieldName+"__"+a.name:a.name}},this);c&&this._addComplexTypeProperties(c.ComplexTypes,b)},_addComplexTypeProperties:function(a,b){a.forEach(function(a){b.selectModelBinderProperty(a.FromPropertyName);b.modelBinderConfig.$type=a.ToType;var d=this.currentObjectFieldName;this.currentObjectFieldName=this.currentObjectFieldName?this.currentObjectFieldName+
"__":"";this.currentObjectFieldName=this.currentObjectFieldName+a.FromPropertyName;this._addPropertyToModelBinderConfig(a.ToType,b);b.popModelBinderProperty();this.currentObjectFieldName=d},this)},DefaultSelection:function(a){a.modelBinderConfig.$type=this._query.defaultType;var b=this._query.context._storageModel.getStorageModel(this._query.defaultType);this._addPropertyToModelBinderConfig(this._query.defaultType,a);this._includes&&this._includes.forEach(function(c){for(var d=c.name.split("."),e=
null,h=b,f=0;f<d.length;f++){a.selectModelBinderProperty(d[f]);e=h.Associations[d[f]];h=this._query.context._storageModel.getStorageModel(e.ToType)}a.modelBinderConfig.$selector="json:"+c.name;if(e.ToMultiplicity==="*"){a.modelBinderConfig.$type=$data.Array;a.selectModelBinderProperty("$item");a.modelBinderConfig.$type=c.type;this._addPropertyToModelBinderConfig(c.type,a);a.popModelBinderProperty()}else{a.modelBinderConfig.$type=c.type;this._addPropertyToModelBinderConfig(c.type,a)}for(f=0;f<d.length;f++)a.popModelBinderProperty()},
this)},VisitProjectionExpression:function(a,b){this.hasProjection=true;this.Visit(a.selector,b)},VisitParametricQueryExpression:function(a,b){if(a.expression instanceof $data.Expressions.EntityExpression)this.VisitEntityAsProjection(a.expression,b);else{this.Visit(a.expression,b);if(a.expression instanceof $data.Expressions.EntityFieldExpression){b.modelBinderConfig.$source="d";b.modelBinderConfig.$keys=["rowid$$"]}}},VisitConstantExpression:function(a,b){b.modelBinderConfig.$type=a.type;b.modelBinderConfig.$source=
this.currentObjectFieldName},VisitEntityAsProjection:function(a,b){this.Visit(a.source,b);b.modelBinderConfig.$type=a.entityType;this._addPropertyToModelBinderConfig(a.entityType,b)},VisitEntityFieldExpression:function(a,b){this.Visit(a.source,b);this.Visit(a.selector,b)},VisitMemberInfoExpression:function(a,b){if(a.memberDefinition instanceof $data.MemberDefinition){b.modelBinderConfig.$type=a.memberDefinition.type;a.memberName in a.memberDefinition.storageModel.ComplexTypes?this._addPropertyToModelBinderConfig(Container.resolveType(a.memberDefinition.type),
b):b.modelBinderConfig.$source=this.currentObjectFieldName}},VisitEntitySetExpression:function(a,b){if(a.source instanceof $data.Expressions.EntityExpression){this.Visit(a.source,b);this.Visit(a.selector,b)}},VisitEntityExpression:function(a,b){this.Visit(a.source,b)},VisitAssociationInfoExpression:function(a,b){"$selector"in b.modelBinderConfig&&b.modelBinderConfig.$selector.length>0?b.modelBinderConfig.$selector=b.modelBinderConfig.$selector+".":b.modelBinderConfig.$selector="json:";b.modelBinderConfig.$selector=
b.modelBinderConfig.$selector+a.associationInfo.FromPropertyName},VisitSimpleBinaryExpression:function(a,b){this.Visit(a.left,b);this.Visit(a.right,b);b.modelBinderConfig.$type=void 0},VisitObjectLiteralExpression:function(a,b){b.modelBinderConfig.$keys=this.currentObjectFieldName?[this.currentObjectFieldName+"__rowid$$"]:["rowid$$"];b.modelBinderConfig.$type=$data.Object;a.members.forEach(function(a){this.Visit(a,b)},this)},VisitObjectFieldExpression:function(a,b){var c=this.currentObjectFieldName;
b.selectModelBinderProperty(a.fieldName);this.currentObjectFieldName=this.currentObjectFieldName?this.currentObjectFieldName+"__":"";this.currentObjectFieldName=this.currentObjectFieldName+a.fieldName;a.expression instanceof $data.Expressions.EntityExpression?this.VisitEntityAsProjection(a.expression,b):this.Visit(a.expression,b);this.currentObjectFieldName=c;b.popModelBinderProperty()}});
$C("$data.storageProviders.oData.oDataProvider",$data.StorageProviderBase,null,{constructor:function(a,b){typeof OData==="undefined"&&Guard.raise(new Exception("datajs is required","Not Found!"));this.SqlCommands=[];this.context=b;this.providerConfiguration=$data.typeSystem.extend({dbCreation:$data.storageProviders.sqLite.DbCreationType.DropTableIfChanged,oDataServiceHost:"/odata.svc",serviceUrl:"",maxDataServiceVersion:"2.0",user:null,password:null},a);if(this.context&&this.context._buildDbType_generateConvertToFunction&&
this.buildDbType_generateConvertToFunction)this.context._buildDbType_generateConvertToFunction=this.buildDbType_generateConvertToFunction;if(this.context&&this.context._buildDbType_modifyInstanceDefinition&&this.buildDbType_modifyInstanceDefinition)this.context._buildDbType_modifyInstanceDefinition=this.buildDbType_modifyInstanceDefinition},initializeStore:function(a){a=$data.typeSystem.createCallbackSetting(a);switch(this.providerConfiguration.dbCreation){case $data.storageProviders.sqLite.DbCreationType.DropAllExistingTables:var b=
this;if(this.providerConfiguration.serviceUrl){var c=[{requestUri:b.providerConfiguration.serviceUrl+"/Delete",method:"POST"},function(){console.log("RESET oData database");a.success(b.context)},function(){a.success(b.context)}];if(this.providerConfiguration.user){c[0].user=this.providerConfiguration.user;c[0].password=this.providerConfiguration.password||""}this.context.prepareRequest.call(this,c);OData.request.apply(this,c)}else a.success(b.context);break;default:a.success(this.context)}},buildDbType_generateConvertToFunction:function(a,
b){return function(c,d){var e=new a.PhysicalType;e.entityState=c.entityState;a.PhysicalType.memberDefinitions.getPublicMappedProperties().forEach(function(a){e[a.name]=c[a.name]},this);a.Associations&&a.Associations.forEach(function(a){if(a.FromMultiplicity=="*"&&a.ToMultiplicity=="0..1"||a.FromMultiplicity=="0..1"&&a.ToMultiplicity=="1"||a.FromMultiplicity=="$$unbound"){var f=c[a.FromPropertyName];if(f!==null&&f!==void 0)if(f instanceof $data.Array){e[a.FromPropertyName]=e[a.FromPropertyName]||[];
f.forEach(function(b){b=d.indexOf(b);b<0&&Guard.raise("Dependency graph error");e[a.FromPropertyName].push({__metadata:{uri:"$"+(b+1)}})},this)}else if(f.entityState===$data.EntityState.Modified){var j=b._storageModel.getStorageModel(f.getType()).TableName,n="(";f.getType().memberDefinitions.getKeyProperties().forEach(function(a,b){b>0&&(n=n+",");n=n+f[a.name]},this);n=n+")";e[a.FromPropertyName]={__metadata:{uri:j+n}}}else{j=d.indexOf(f);j<0&&Guard.raise("Dependency graph error");e[a.FromPropertyName]=
{__metadata:{uri:"$"+(j+1)}}}}},this);a.ComplexTypes&&a.ComplexTypes.forEach(function(a){e[a.FromPropertyName]=c[a.FromPropertyName]},this);return e}},executeQuery:function(a,b){var b=$data.typeSystem.createCallbackSetting(b),c;try{c=this._compile(a)}catch(d){b.error(d);return}c=[{requestUri:this.providerConfiguration.oDataServiceHost+c.queryText,headers:{MaxDataServiceVersion:this.providerConfiguration.maxDataServiceVersion}},function(c){if(b.success){a.rawDataList=typeof c==="string"?[{cnt:c}]:
c;b.success(a)}},function(a,c,d){b.error(d)}];if(this.providerConfiguration.user){c[0].user=this.providerConfiguration.user;c[0].password=this.providerConfiguration.password||""}this.context.prepareRequest.call(this,c);OData.request.apply(this,c)},_compile:function(a){return(new $data.storageProviders.oData.oDataCompiler).compile(a)},saveChanges:function(a,b){b.length>0?this.saveInternal(this.buildIndependentBlocks(b),0,a):a.success(0)},saveInternal:function(a,b,c){batchRequests=[];convertedItem=
[];for(b=0;b<a.length;b++)for(var d=0;d<a[b].length;d++){convertedItem.push(a[b][d].data);var e={};e.headers={"Content-Id":convertedItem.length};switch(a[b][d].data.entityState){case $data.EntityState.Unchanged:continue;case $data.EntityState.Added:e.method="POST";e.requestUri=a[b][d].entitySet.name;e.data=this.save_getInitData(a[b][d],convertedItem);break;case $data.EntityState.Modified:e.method="MERGE";e.requestUri=a[b][d].entitySet.name;e.requestUri=e.requestUri+("("+this.getEntityKeysValue(a[b][d])+
")");this.save_addConcurrencyHeader(a[b][d],e.headers);e.data=this.save_getInitData(a[b][d],convertedItem);break;case $data.EntityState.Deleted:e.method="DELETE";e.requestUri=a[b][d].entitySet.name;e.requestUri=e.requestUri+("("+this.getEntityKeysValue(a[b][d])+")");break;default:Guard.raise(new Exception("Not supported Entity state"))}batchRequests.push(e)}a=[{requestUri:this.providerConfiguration.oDataServiceHost+"/$batch",method:"POST",data:{__batchRequests:[{__changeRequests:batchRequests}]}},
function(a,b){if(b.statusCode==202){for(var d=a.__batchResponses[0].__changeResponses,e=0;e<d.length;e++){var u=convertedItem[e];if(d[e].statusCode==204){if(d[e].headers.ETag){var q=u.getType().memberDefinitions.getPublicMappedProperties().filter(function(a){return a.concurrencyMode===$data.ConcurrencyMode.Fixed});if(q&&q[0])u[q[0].name]=d[e].headers.ETag}}else u.getType().memberDefinitions.getPublicMappedProperties().forEach(function(a){a.computed&&(u[a.name]=a.concurrencyMode===$data.ConcurrencyMode.Fixed?
d[e].headers.ETag:d[e].data[a.name])},this)}c.success&&c.success(convertedItem.length)}else c.error(b)},c.error,OData.batchHandler];if(this.providerConfiguration.user){a[0].user=this.providerConfiguration.user;a[0].password=this.providerConfiguration.password||""}this.context.prepareRequest.call(this,a);OData.request.apply(this,a)},save_getInitData:function(a,b){a.physicalData=this.context._storageModel.getStorageModel(a.data.getType()).PhysicalType.convertTo(a.data,b);var c={};a.physicalData.getType().memberDefinitions.asArray().forEach(function(b){if(b.kind==
$data.MemberTypes.navProperty||b.kind==$data.MemberTypes.complexProperty||b.kind==$data.MemberTypes.property&&!b.notMapped)c[b.name]=a.physicalData[b.name]},this);return c},save_addConcurrencyHeader:function(a,b){var c=a.data.getType().memberDefinitions.getPublicMappedProperties().filter(function(a){return a.concurrencyMode===$data.ConcurrencyMode.Fixed});if(c&&c[0]){b["If-Match"]=a.data[c[0].name];a.data[c[0].name]=""}},getTraceString:function(a){this._compile(a);return a},supportedDataTypes:{value:[$data.Integer,
$data.String,$data.Number,$data.Blob,$data.Boolean,$data.Date],writable:!1},supportedBinaryOperators:{value:{equal:{mapTo:"eq",dataType:"boolean",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression]},notEqual:{mapTo:"ne",dataType:"boolean",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression]},equalTyped:{mapTo:"eq",dataType:"boolean",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression]},notEqualTyped:{mapTo:"ne",dataType:"boolean",
allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression]},greaterThan:{mapTo:"gt",dataType:"boolean",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression]},greaterThanOrEqual:{mapTo:"ge",dataType:"boolean",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression]},lessThan:{mapTo:"lt",dataType:"boolean",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression]},lessThenOrEqual:{mapTo:"le",dataType:"boolean",
allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression]},or:{mapTo:"or",dataType:"boolean",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression]},and:{mapTo:"and",dataType:"boolean",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression]},add:{mapTo:"add",dataType:"number",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression]},divide:{mapTo:"div",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression]},
multiply:{mapTo:"mul",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression]},subtract:{mapTo:"sub",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression]},modulo:{mapTo:"mod",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression]},"in":{mapTo:"in",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression]}}},supportedUnaryOperators:{value:{not:{mapTo:"not"}}},supportedFieldOperations:{value:{contains:{mapTo:"substringof",
dataType:"boolean",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression],parameters:[{name:"substring",dataType:"string"},{name:"@expression"}]},startsWith:{mapTo:"startswith",dataType:"string",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression],parameters:[{name:"@expression",dataType:"string"},{name:"strFragment",dataType:"string"}]},endsWith:{mapTo:"endswith",dataType:"string",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression],
parameters:[{name:"@expression",dataType:"string"},{name:"strFragment",dataType:"string"}]},length:{dataType:"number",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.ProjectionExpression],parameters:[{name:"@expression",dataType:"string"}]},indexOf:{dataType:"number",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression],mapTo:"indexof",baseIndex:1,parameters:[{name:"@expression",dataType:"string"},{name:"strFragment",dataType:"string"}]},replace:{dataType:"string",
allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression],parameters:[{name:"@expression",dataType:"string"},{name:"strFrom",dataType:"string"},{name:"strTo",dataType:"string"}]},substr:{mapTo:"substring",dataType:"string",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression],parameters:[{name:"@expression",dataType:"string"},{name:"startFrom",dataType:"number"},{name:"length",dataType:"number",optional:"true"}]},toLowerCase:{mapTo:"tolower",dataType:"string",
allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression],parameters:[{name:"@expression",dataType:"string"}]},toUpperCase:{mapTo:"toupper",dataType:"string",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression],parameters:[{name:"@expression",dataType:"string"}]},trim:{dataType:"string",allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression],parameters:[{name:"@expression",dataType:"string"}]},concat:{dataType:"string",allowedIn:[$data.Expressions.FilterExpression,
$data.Expressions.OrderExpression],parameters:[{name:"@expression",dataType:"string"},{name:"strFragment",dataType:"string"}]},day:{allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression],parameters:[{name:"@expression",dataType:"date"}]},hour:{allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression],parameters:[{name:"@expression",dataType:"date"}]},minute:{allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression],parameters:[{name:"@expression",
dataType:"date"}]},month:{allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression],parameters:[{name:"@expression",dataType:"date"}]},second:{allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression],parameters:[{name:"@expression",dataType:"date"}]},year:{allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression],parameters:[{name:"@expression",dataType:"date"}]},round:{allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression],
parameters:[{name:"@expression",dataType:"date"}]},floor:{allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression],parameters:[{name:"@expression",dataType:"date"}]},ceiling:{allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.OrderExpression],parameters:[{name:"@expression",dataType:"date"}]}},enumerable:!0,writable:!0},supportedSetOperations:{value:{filter:{},map:{},length:{},forEach:{},toArray:{},single:{},some:{invokable:!1,allowedIn:[$data.Expressions.FilterExpression],
parameters:[{name:"filter",dataType:"$data.Queryable"}],mapTo:"any",frameType:$data.Expressions.SomeExpression},every:{invokable:!1,allowedIn:[$data.Expressions.FilterExpression],parameters:[{name:"filter",dataType:"$data.Queryable"}],mapTo:"all",frameType:$data.Expressions.EveryExpression},take:{},skip:{},orderBy:{},orderByDescending:{},first:{},include:{}},enumerable:!0,writable:!0},fieldConverter:{value:{fromDb:{"$data.Integer":function(a){return a},"$data.Number":function(a){return a},"$data.Date":function(a){return a?
new Date(parseInt(a.substr(6))):void 0},"$data.String":function(a){return a},"$data.Boolean":function(a){return a},"$data.Blob":function(a){return a},"$data.Object":function(a){return a===void 0?new $data.Object:JSON.parse(a)},"$data.Array":function(a){return a===void 0?new $data.Array:JSON.parse(a)}},toDb:{"$data.Integer":function(a){return a},"$data.Number":function(a){return a%1==0?a:a+"m"},"$data.Date":function(a){return a?"datetime'"+a.toISOString()+"'":null},"$data.String":function(a){return"'"+
a.replace(/'/g,"''")+"'"},"$data.Boolean":function(a){return a?"true":"false"},"$data.Blob":function(a){return a},"$data.Object":function(a){return JSON.stringify(a)},"$data.Array":function(a){return JSON.stringify(a)}}}},getEntityKeysValue:function(a){for(var b=[],c=void 0,d=a.entitySet.createNew.memberDefinitions.asArray(),e=0,h=d.length;e<h;e++){var f=d[e];if(f.key){c=a.data[f.name];f.dataType=="string"&&(c="'"+c+"'");b.push(f.name+"="+c)}}return b.length>1?b.join(","):c}},null);
$data.StorageProviderBase.registerProvider("oData",$data.storageProviders.oData.oDataProvider);
$C("$data.storageProviders.oData.oDataCompiler",$data.Expressions.EntityExpressionVisitor,null,{constructor:function(){this.context={};this.provider={};this.mainEntitySet=this.includes=null},compile:function(a){this.provider=a.context.storageProvider;this.context=a.context;this.mainEntitySet=a.context.getEntitySetFromElementType(a.defaultType);var b={urlText:""};this.Visit(a.expression,b);a.modelBinderConfig={};Container.createModelBinderConfigCompiler(a,this.includes,true).Visit(a.expression);var c=
b.urlText,d=false,e;for(e in b)if(e!="urlText"&&e!="actionPack"&&e!="data"&&e!="lambda"&&b[e]!=""){c=d?c+"&":c+"?";d=true;c=e!="$urlParams"?c+(e+"="+b[e]):c+b[e]}a.queryText=c;return{queryText:c,params:[]}},VisitOrderExpression:function(a,b){this.Visit(a.source,b);Container.createoDataOrderCompiler(this.provider).compile(a,b)},VisitPagingExpression:function(a,b){this.Visit(a.source,b);Container.createoDataPagingCompiler().compile(a,b)},VisitIncludeExpression:function(a,b){this.Visit(a.source,b);if(!b.$select){b.$expand=
b.$expand?b.$expand+",":"";b.$expand=b.$expand+a.selector.value.replace(".","/");this.includes=this.includes||[];for(var c=a.selector.value.split("."),d=null,e=this.mainEntitySet.entityContext._storageModel.getStorageModel(this.mainEntitySet.createNew),h=0;h<c.length;h++){d=d?d+("."+c[h]):c[h];(e=e.Associations[c[h]])?this.includes.some(function(a){return a.name==d},this)||this.includes.push({name:d,type:e.ToType}):Guard.raise(new Exception("The given include path is invalid: "+a.selector.value+", invalid point: "+
d));e=this.mainEntitySet.entityContext._storageModel.getStorageModel(e.ToType)}}},VisitProjectionExpression:function(a,b){this.Visit(a.source,b);Container.createoDataProjectionCompiler(this.context).compile(a,b)},VisitFilterExpression:function(a,b){this.Visit(a.source,b);var c=Container.createoDataWhereCompiler(this.provider);b.data="";c.compile(a.selector,b);b.$filter=b.data;b.data=""},VisitEntitySetExpression:function(a,b){b.urlText=b.urlText+("/"+a.instance.tableName);if(a.params)for(var c=0;c<
a.params.length;c++)this.Visit(a.params[c],b)},VisitServiceOperationExpression:function(a,b){b.urlText=b.urlText+("/"+a.cfg.serviceName);if(a.params)for(var c=0;c<a.params.length;c++)this.Visit(a.params[c],b)},VisitConstantExpression:function(a,b){b.$urlParams=b.$urlParams?b.$urlParams+"&":"";var c=Container.getTypeName(a.value);b.$urlParams=b.$urlParams+(a.name+"="+this.provider.fieldConverter.toDb[Container.resolveName(Container.resolveType(c))](a.value))},VisitCountExpression:function(a,b){this.Visit(a.source,
b);b.urlText=b.urlText+"/$count"}},{});
$C("$data.storageProviders.oData.oDataWhereCompiler",$data.Expressions.EntityExpressionVisitor,null,{constructor:function(a,b){this.provider=a;this.lambdaPrefix=b},compile:function(a,b){this.Visit(a,b)},VisitParametricQueryExpression:function(a,b){this.Visit(a.expression,b)},VisitUnaryExpression:function(a,b){b.data=b.data+a.resolution.mapTo;b.data=b.data+"(";this.Visit(a.operand,b);b.data=b.data+")"},VisitSimpleBinaryExpression:function(a,b){b.data=b.data+"(";if(a.nodeType=="in"){Guard.requireType("expression.right",
a.type,$data.Expressions.ConstantExpression);var c=a.right.value;!c instanceof Array&&Guard.raise(new Exception("Right to the 'in' operator must be an array value"));var d=null,e={mapTo:"or",dataType:"boolean",name:"or"},h={mapTo:"eq",dataType:"boolean",name:"equal"};c.forEach(function(b){b=Container.createConstantExpression(b);b=Container.createSimpleBinaryExpression(a.left,b,$data.Expressions.ExpressionType.Equal,"==","boolean",h);d=d?Container.createSimpleBinaryExpression(d,b,$data.Expressions.ExpressionType.Or,
"||","boolean",e):b});c=b.data;b.data="";this.Visit(d,b);b.data=c+b.data.replace(/\(/g,"").replace(/\)/g,"")}else{this.Visit(a.left,b);b.data=b.data+" ";b.data=b.data+a.resolution.mapTo;b.data=b.data+" ";this.Visit(a.right,b)}b.data=b.data+")"},VisitEntityFieldExpression:function(a,b){this.Visit(a.source,b);this.Visit(a.selector,b)},VisitAssociationInfoExpression:function(a,b){b.data=b.data+a.associationInfo.FromPropertyName},VisitMemberInfoExpression:function(a,b){b.data=b.data+a.memberName},VisitQueryParameterExpression:function(a,
b){b.data=b.data+this.provider.fieldConverter.toDb[a.type](a.value)},VisitEntityFieldOperationExpression:function(a,b){Guard.requireType("expression.operation",a.operation,$data.Expressions.MemberInfoExpression);var c=a.operation.memberDefinition;b.data=b.data+(c.mapTo||c.name);b.data=b.data+"(";var d=0;(c.parameters||[{name:"@expression"}]).map(function(b){return b.name==="@expression"?a.source:a.parameters[d++]}).forEach(function(a,c){if(c>0)b.data=b.data+",";this.Visit(a,b)},this);b.data=b.data+
")"},VisitConstantExpression:function(a,b){var c=Container.getTypeName(a.value);b.data=b.data+this.provider.fieldConverter.toDb[Container.resolveName(Container.resolveType(c))](a.value)},VisitEntityExpression:function(a,b){this.Visit(a.source,b);if(this.lambdaPrefix&&a.selector.lambda){b.lambda=a.selector.lambda;b.data=b.data+(a.selector.lambda+"/")}},VisitEntitySetExpression:function(a,b){this.Visit(a.source,b);if(a.selector instanceof $data.Expressions.AssociationInfoExpression){this.Visit(a.selector,
b);b.data=b.data+"/"}},VisitFrameOperationExpression:function(a,b){this.Visit(a.source,b);Guard.requireType("expression.operation",a.operation,$data.Expressions.MemberInfoExpression);var c=a.operation.memberDefinition;b.data=b.data+(c.mapTo||c.name);b.data=b.data+"(";for(var d=0,e=(c.parameters||[{name:"@expression"}]).map(function(b){return b.name==="@expression"?a.source:a.parameters[d++]}),h=0;h<e.length;h++){var f=e[h];if(f.value instanceof $data.Queryable){var j=new c.frameType(f.value.expression),
f=Container.createQueryExpressionCreator(f.value.entityContext).Visit(j),j={data:""};(new $data.storageProviders.oData.oDataWhereCompiler(this.provider,true)).compile(f,j);b.data=b.data+(j.lambda+": "+j.data)}}b.data=b.data+")"}});
$C("$data.storageProviders.oData.oDataOrderCompiler",$data.storageProviders.oData.oDataWhereCompiler,null,{constructor:function(a){this.provider=a},compile:function(a,b){this.Visit(a,b)},VisitOrderExpression:function(a,b){var c={data:""};this.Visit(a.selector,c);b.$orderby=b.$orderby?b.$orderby+",":"";b.$orderby=b.$orderby+(c.data+(a.nodeType==ExpressionType.OrderByDescending?" desc":""))},VisitParametricQueryExpression:function(a,b){this.Visit(a.expression,b)},VisitEntityFieldExpression:function(a,
b){this.Visit(a.source,b);this.Visit(a.selector,b)},VisitComplexTypeExpression:function(a,b){this.Visit(a.source,b);this.Visit(a.selector,b);b.data=b.data+"/"},VisitEntitySetExpression:function(a,b){if(a.selector instanceof $data.Expressions.AssociationInfoExpression){this.Visit(a.source,b);this.Visit(a.selector,b)}},VisitAssociationInfoExpression:function(a,b){b.data=b.data+(a.associationInfo.FromPropertyName+"/")},VisitEntityExpression:function(a,b){this.Visit(a.source,b);this.Visit(a.selector,
b)},VisitMemberInfoExpression:function(a,b){b.data=b.data+a.memberName}});
$C("$data.storageProviders.oData.oDataPagingCompiler",$data.Expressions.EntityExpressionVisitor,null,{constructor:function(a){this.provider=a},compile:function(a,b){this.Visit(a,b)},VisitPagingExpression:function(a,b){var c={data:""};this.Visit(a.amount,c);switch(a.nodeType){case ExpressionType.Skip:b.$skip=c.data;break;case ExpressionType.Take:b.$top=c.data;break;default:Guard.raise("Not supported nodeType")}},VisitConstantExpression:function(a,b){b.data=b.data+a.value}});
$C("$data.storageProviders.oData.oDataProjectionCompiler",$data.Expressions.EntityExpressionVisitor,null,{constructor:function(a){this.entityContext=a;this.hasObjectLiteral=false;this.ObjectLiteralPath="";this.modelBinderMapping=[]},compile:function(a,b){this.Visit(a,b)},VisitProjectionExpression:function(a,b){this.mapping=b.data="";this.Visit(a.selector,b);b.$select=b.$select?b.$select+",":"";b.$select=b.$select+b.data;b.data=""},VisitParametricQueryExpression:function(a,b){this.Visit(a.expression,
b);if(a.expression instanceof $data.Expressions.EntityExpression){b.$expand=b.$expand?b.$expand+",":"";b.$expand=b.$expand+this.mapping.replace(/\./g,"/")}var c=this.mapping.split(".");c.pop();if(c.length>0){b.$expand=b.$expand?b.$expand+",":"";b.$expand=b.$expand+c.join("/")}},VisitObjectLiteralExpression:function(a,b){var c=this.ObjectLiteralPath;this.hasObjectLiteral=true;a.members.forEach(function(c,e){this.Visit(c,b);if(e<a.members.length-1)b.data=b.data+",";this.mapping=""},this);this.ObjectLiteralPath=
c},VisitObjectFieldExpression:function(a,b){this.ObjectLiteralPath=this.ObjectLiteralPath?this.ObjectLiteralPath+("."+a.fieldName):a.fieldName;this.Visit(a.expression,b);if(a.expression instanceof $data.Expressions.EntityExpression){b.$expand=b.$expand?b.$expand+",":"";b.$expand=b.$expand+this.mapping.replace(/\./g,"/")}else{var c=this.mapping.split(".");c.pop();if(c.length>0){b.$expand=b.$expand?b.$expand+",":"";b.$expand=b.$expand+c.join("/")}}},VisitComplexTypeExpression:function(a,b){this.Visit(a.source,
b);this.Visit(a.selector,b)},VisitEntityFieldExpression:function(a,b){this.Visit(a.source,b);this.Visit(a.selector,b)},VisitEntityExpression:function(a,b){this.Visit(a.source,b)},VisitEntitySetExpression:function(a,b){a.source instanceof $data.Expressions.EntityExpression&&this.Visit(a.source,b);a.selector instanceof $data.Expressions.AssociationInfoExpression&&this.Visit(a.selector,b)},VisitAssociationInfoExpression:function(a,b){if(b.data&&b.data.length>0&&b.data[b.data.length-1]!=",")b.data=b.data+
"/";b.data=b.data+a.associationInfo.FromPropertyName;if(this.mapping&&this.mapping.length>0)this.mapping=this.mapping+".";this.mapping=this.mapping+a.associationInfo.FromPropertyName},VisitMemberInfoExpression:function(a,b){if(b.data&&b.data.length>0&&b.data[b.data.length-1]!=",")b.data=b.data+"/";b.data=b.data+a.memberName;if(this.mapping&&this.mapping.length>0)this.mapping=this.mapping+".";this.mapping=this.mapping+a.memberName},VisitConstantExpression:function(a,b){b.data=b.data.slice(0,b.data.length-
1)}});$C("$data.modelBinder.FindProjectionVisitor",$data.Expressions.EntityExpressionVisitor,null,{VisitProjectionExpression:function(a){this.projectionExpression=a}});
$C("$data.modelBinder.ModelBinderConfigCompiler",$data.Expressions.EntityExpressionVisitor,null,{constructor:function(a,b,c){this._query=a;this._includes=b;this._isoDataProvider=c||false},VisitSingleExpression:function(a){this._defaultModelBinder(a)},VisitSomeExpression:function(a){this._defaultModelBinder(a)},VisitEveryExpression:function(a){this._defaultModelBinder(a)},VisitToArrayExpression:function(a){this._defaultModelBinder(a)},VisitFirstExpression:function(a){this._defaultModelBinder(a)},VisitForEachExpression:function(a){this._defaultModelBinder(a)},
VisitServiceOperationExpression:function(a){var b=Container.createqueryBuilder(),c=Container.resolveType(a.cfg.returnType);b.modelBinderConfig.$type=c;c.inheritsFrom===$data.Entity?b.modelBinderConfig.$selector=["json:"+a.cfg.serviceName]:b.modelBinderConfig.$source=a.cfg.serviceName;this.VisitExpression(a,b);b.resetModelBinderProperty();this._query.modelBinderConfig=b.modelBinderConfig},VisitCountExpression:function(){var a=Container.createqueryBuilder();a.modelBinderConfig.$type=$data.Array;a.selectModelBinderProperty("$item");
a.modelBinderConfig.$type=$data.Integer;a.modelBinderConfig.$source="cnt";a.resetModelBinderProperty();this._query.modelBinderConfig=a.modelBinderConfig},VisitConstantExpression:function(a,b){b.modelBinderConfig.$type=a.type;b.modelBinderConfig.$value=a.value},VisitExpression:function(a,b){var c=Container.createFindProjectionVisitor();c.Visit(a);c.projectionExpression?this.Visit(c.projectionExpression,b):this.DefaultSelection(b)},_defaultModelBinder:function(a){var b=Container.createqueryBuilder();
b.modelBinderConfig.$type=$data.Array;this._isoDataProvider&&(b.modelBinderConfig.$selector=["json:d.results","json:d","json:results"]);b.modelBinderConfig.$item={};b.selectModelBinderProperty("$item");this.VisitExpression(a,b);b.resetModelBinderProperty();this._query.modelBinderConfig=b.modelBinderConfig},_addPropertyToModelBinderConfig:function(a,b){var c=this._query.context._storageModel.getStorageModel(a);if(a.memberDefinitions)a.memberDefinitions.getPublicMappedProperties().forEach(function(a){if(!c||
c&&!c.Associations[a.name]&&!c.ComplexTypes[a.name])if(!c&&this._query.context.storageProvider.supportedDataTypes.indexOf(Container.resolveType(a.dataType))<0){b.selectModelBinderProperty(a.name);b.modelBinderConfig.$type=Container.resolveType(a.dataType);b.modelBinderConfig.$selector=this._isoDataProvider?["json:"+a.name+".results","json:"+a.name]:"json:"+a.name;this._addPropertyToModelBinderConfig(Container.resolveType(a.dataType),b);b.popModelBinderProperty()}else{a.key&&b.addKeyField(a.name);
b.modelBinderConfig[a.name]=a.concurrencyMode===$data.ConcurrencyMode.Fixed?{$selector:"json:__metadata",$source:"etag"}:a.name}},this);else{b._binderConfig.$item={};b.modelBinderConfig=b._binderConfig.$item}c&&this._addComplexTypeProperties(c.ComplexTypes,b)},_addComplexTypeProperties:function(a,b){a.forEach(function(a){b.selectModelBinderProperty(a.FromPropertyName);b.modelBinderConfig.$type=a.ToType;b.modelBinderConfig.$selector=this._isoDataProvider?["json:"+a.FromPropertyName+".results","json:"+
a.FromPropertyName]:"json:"+a.FromPropertyName;this._addPropertyToModelBinderConfig(a.ToType,b);b.popModelBinderProperty()},this)},DefaultSelection:function(a){a.modelBinderConfig.$type=this._query.defaultType;var b=this._query.context._storageModel.getStorageModel(this._query.defaultType);this._addPropertyToModelBinderConfig(this._query.defaultType,a);this._includes&&this._includes.forEach(function(c){for(var d=c.name.split("."),e=null,h=b,f=0;f<d.length;f++){a.modelBinderConfig.$item&&a.selectModelBinderProperty("$item");
a.selectModelBinderProperty(d[f]);e=h.Associations[d[f]];h=this._query.context._storageModel.getStorageModel(e.ToType)}a.modelBinderConfig.$selector=this._isoDataProvider?["json:"+d[d.length-1]+".results","json:"+d[d.length-1]]:"json:"+d[d.length-1];if(e.ToMultiplicity==="*"){a.modelBinderConfig.$type=$data.Array;a.selectModelBinderProperty("$item");a.modelBinderConfig.$type=c.type;this._addPropertyToModelBinderConfig(c.type,a);a.popModelBinderProperty()}else{a.modelBinderConfig.$type=c.type;this._addPropertyToModelBinderConfig(c.type,
a)}for(f=0;f<d.length;f++)a.popModelBinderProperty()},this)},VisitProjectionExpression:function(a,b){this.hasProjection=true;this.Visit(a.selector,b)},VisitParametricQueryExpression:function(a,b){a.expression instanceof $data.Expressions.EntityExpression?this.VisitEntityAsProjection(a.expression,b):this.Visit(a.expression,b)},VisitEntityAsProjection:function(a,b){this.Visit(a.source,b);b.modelBinderConfig.$type=a.entityType;this._addPropertyToModelBinderConfig(a.entityType,b)},VisitEntityFieldExpression:function(a,
b){this.Visit(a.source,b);this.Visit(a.selector,b)},VisitMemberInfoExpression:function(a,b){b.modelBinderConfig.$type=a.memberDefinition.type;a.memberDefinition.storageModel&&a.memberName in a.memberDefinition.storageModel.ComplexTypes?this._addPropertyToModelBinderConfig(Container.resolveType(a.memberDefinition.type),b):b.modelBinderConfig.$source=a.memberName},VisitEntitySetExpression:function(a,b){if(a.source instanceof $data.Expressions.EntityExpression){this.Visit(a.source,b);this.Visit(a.selector,
b)}},VisitComplexTypeExpression:function(a,b){this.Visit(a.source,b);this.Visit(a.selector,b);if("$selector"in b.modelBinderConfig&&b.modelBinderConfig.$selector.length>0)if(b.modelBinderConfig.$selector instanceof $data.Array){var c=b.modelBinderConfig.$selector[1];b.modelBinderConfig.$selector[0]=c+"."+a.selector.memberName+".results";b.modelBinderConfig.$selector[1]=c+"."+a.selector.memberName}else b.modelBinderConfig.$selector=b.modelBinderConfig.$selector+("."+a.selector.memberName);else b.modelBinderConfig.$selector=
this._isoDataProvider?["json:"+a.selector.memberName+".results","json:"+a.selector.memberName]:"json:"+a.selector.memberName},VisitEntityExpression:function(a,b){this.Visit(a.source,b)},VisitAssociationInfoExpression:function(a,b){if("$selector"in b.modelBinderConfig&&b.modelBinderConfig.$selector.length>0)if(b.modelBinderConfig.$selector instanceof $data.Array){var c=b.modelBinderConfig.$selector[1];b.modelBinderConfig.$selector[0]=c+"."+a.associationInfo.FromPropertyName+".results";b.modelBinderConfig.$selector[1]=
c+"."+a.associationInfo.FromPropertyName}else b.modelBinderConfig.$selector=b.modelBinderConfig.$selector+("."+a.associationInfo.FromPropertyName);else b.modelBinderConfig.$selector=this._isoDataProvider?["json:"+a.associationInfo.FromPropertyName+".results","json:"+a.associationInfo.FromPropertyName]:"json:"+a.associationInfo.FromPropertyName},VisitObjectLiteralExpression:function(a,b){b.modelBinderConfig.$type=$data.Object;a.members.forEach(function(a){this.Visit(a,b)},this)},VisitObjectFieldExpression:function(a,
b){b.selectModelBinderProperty(a.fieldName);a.expression instanceof $data.Expressions.EntityExpression?this.VisitEntityAsProjection(a.expression,b):this.Visit(a.expression,b);b.popModelBinderProperty()}});
$data.Class.define("$data.storageProviders.indexedDb.IndexedDBStorageProvider",$data.StorageProviderBase,null,{constructor:function(a){this.indexedDB=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.msIndexedDB;this.IDBRequest=window.IDBRequest||window.webkitIDBRequest||window.mozIDBRequest||window.msIDBRequest;this.IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||window.mozIDBTransaction||window.msIDBTransaction;this.IDBKeyRange=window.IDBKeyRange||window.webkitIDBKeyRange||
window.mozIDBKeyRange||window.msIDBKeyRange;this.IDBDatabaseException=window.IDBDatabaseException||window.webkitIDBDatabaseException||window.mozIDBDatabaseException||window.msIDBDatabaseException;this.IDBOpenDBRequest=window.IDBOpenDBRequest||window.webkitIDBOpenDBRequest||window.mozIDBOpenDBRequest||window.msIDBOpenDBRequest;this.newVersionAPI=!(!window.IDBFactory||!IDBFactory.prototype.deleteDatabase);this.sequenceStore="__jayData_sequence";this.SqlCommands=[];this.context={};this.providerConfiguration=
$data.typeSystem.extend({databaseName:"JayDataDemo",version:1,dbCreation:$data.storageProviders.indexedDb.DbCreationType.Default},a);this._setupExtensionMethods()},supportedBinaryOperators:{value:{equal:{mapTo:" == ",dataType:$data.Boolean},notEqual:{mapTo:" != ",dataType:$data.Boolean},equalTyped:{mapTo:" == ",dataType:$data.Boolean},notEqualTyped:{mapTo:" != ",dataType:$data.Boolean},greaterThan:{mapTo:" > ",dataType:$data.Boolean},greaterThanOrEqual:{mapTo:" >= ",dataType:$data.Boolean},lessThan:{mapTo:" < ",
dataType:$data.Boolean},lessThenOrEqual:{mapTo:" <= ",dataType:$data.Boolean},or:{mapTo:" || ",dataType:$data.Boolean},and:{mapTo:" && ",dataType:$data.Boolean}}},supportedSetOperations:{value:{length:{},toArray:{},forEach:{}},enumerable:!0,writable:!0},_setupExtensionMethods:function(){var a=this,b=this.IDBRequest,c=this.IDBTransaction,d=this.IDBOpenDBRequest,e=function(b){typeof b!=="object"&&Guard.raise(new Exception("Invalid callbackSettings",null,b));for(var c in b)typeof this[c]==="undefined"||
typeof b[c]!=="function"||(this[c]=b[c]);this.readyState==a.IDBRequest.DONE&&console.log("WARNING: request finished before setCallbacks. Do not use breakpoints between creating the request object and finishing the setting of callbacks");return this};if(typeof b.prototype.setCallbacks!=="function")b.prototype.setCallbacks=e;if(typeof c.prototype.setCallbacks!=="function")c.prototype.setCallbacks=e;if(d&&typeof d.prototype.setCallbacks!=="function")d.prototype.setCallbacks=e},supportedDataTypes:{value:[$data.Integer,
$data.Number,$data.Date,$data.String,$data.Boolean,$data.Blob,$data.Array,$data.Object],writable:!1},fieldConverter:{value:{fromDb:{"$data.Integer":function(a){return a},"$data.Number":function(a){return a},"$data.Date":function(a){return a},"$data.String":function(a){return a},"$data.Boolean":function(a){return a},"$data.Blob":function(a){return a},"$data.Array":function(a){return a===void 0?new $data.Array:a},"$data.Object":function(a){return a}},toDb:{"$data.Integer":function(a){return a},"$data.Number":function(a){return a},
"$data.Date":function(a){return a},"$data.String":function(a){return a},"$data.Boolean":function(a){return a},"$data.Blob":function(a){return a},"$data.Array":function(a){return a},"$data.Object":function(a){return a}}}},initializeStore:function(a){var a=$data.typeSystem.createCallbackSetting(a),b=this,c=function(a){a.onversionchange=function(a){return a.target.close()};var c=[];b.context._storageModel.forEach(function(d){function e(){var n={},q=b._getKeySettings(d);b.newVersionAPI?q.autoIncrement&&
c.push(d.TableName):n.autoIncrement=q.autoIncrement;if(q.keyPath!==void 0)n.keyPath=q.keyPath;a.createObjectStore(d.TableName,n)}if(a.objectStoreNames.contains(d.TableName)){if(b.providerConfiguration.dbCreation===$data.storageProviders.indexedDb.DbCreationType.DropStoreIfExists){a.deleteObjectStore(d.TableName);e()}}else e()});if(c.length>0&&!a.objectStoreNames.contains(b.sequenceStore)){a.createObjectStore(b.sequenceStore,{keyPath:"store"});c=[]}return c},d=null,e={onupgradeneeded:function(a){d=
c(a.target.result)},onerror:a.error,onblocked:a.error,onsuccess:function(e){b.db=e.target.result;b.db.onversionchange=function(a){a.target.close()};if(b.newVersionAPI){if(d&&d.length>0){var f=b.db.transaction([b.sequenceStore],b.IDBTransaction.READ_WRITE).setCallbacks({onerror:a.error,oncomplete:function(){a.success(b.context)}}).objectStore(b.sequenceStore);switch(b.providerConfiguration.dbCreation){case $data.storageProviders.indexedDb.DbCreationType.DropStoreIfExists:case $data.storageProviders.indexedDb.DbCreationType.DropStoreIfOlderVersion:f.clear();
break;default:d.forEach(function(a){f["delete"](a)})}}a.success(b.context)}else b.db.setVersion(b.providerConfiguration.version).setCallbacks({onerror:a.error,onblocked:a.error,onsuccess:function(){c(b.db);a.success(b.context)}})}};b.newVersionAPI?b.indexedDB.open(b.providerConfiguration.databaseName,parseInt(b.providerConfiguration.version,10)).setCallbacks(e):b.indexedDB.open(b.providerConfiguration.databaseName).setCallbacks(e)},executeQuery:function(a,b){var b=$data.typeSystem.createCallbackSetting(b),
c=a.context.getEntitySetFromElementType(a.defaultType),c=this.db.transaction([c.tableName],this.IDBTransaction.READ_ONLY).setCallbacks({onerror:b.error,onabort:b.error,oncomplete:function(){b.success(a)}}).objectStore(c.tableName);Container.createModelBinderConfigCompiler(a,[]).Visit(a.expression);switch(a.expression.nodeType){case $data.Expressions.ExpressionType.Count:c.count().onsuccess=function(b){a.rawDataList.push({cnt:b.target.result})};break;default:c.openCursor().onsuccess=function(b){if(b=
b.target.result){a.rawDataList.push(b.value);b["continue"]()}}}},_getKeySettings:function(a){var b={autoIncrement:false},c=[];a.PhysicalType.memberDefinitions.getPublicMappedProperties().forEach(function(a){a.key&&c.push(a.name);if(a.computed){a.key||Guard.raise(new Exception("Only key field can be a computed field!"));b.autoIncrement=true}});if(c.length>1){b.autoIncrement&&Guard.raise(new Exception("Auto increment is only valid for a single key!"));b.keys=c}else c.length==1?b.keyPath=c[0]:Guard.raise(new Exception("No valid key found!"));
return b},saveChanges:function(a,b){function c(){if(e.length===0)a.success();else{var b={},f=e.shift().map(function(a){b[a.entitySet.tableName]=true;a.physicalData={};d.context._storageModel.getStorageModel(a.data.getType()).PhysicalType.memberDefinitions.getPublicMappedProperties().forEach(function(b){if(!b.key||!(b.computed&&a.data[b.name]==void 0))a.physicalData[b.name]=a.data[b.name]});return a}),j=[],n;for(n in b)j.push(n);var u=d.db.transaction(j,d.IDBTransaction.READ_WRITE).setCallbacks({onerror:function(b){b.target.errorCode!==
d.IDBDatabaseException.ABORT_ERR&&a.error(b)},oncomplete:function(){c()}}),q=new function(){var a={};this.getSettingsForItem=function(b){var c=b.data.getType().fullName;a.hasOwnProperty(c)||(a[c]=d._getKeySettings(d.context._storageModel.getStorageModel(b.data.getType())));return a[c]}};f.forEach(function(b){var c=u.objectStore(b.entitySet.tableName),e=q.getSettingsForItem(b),f=e.keys&&e.keys.map(function(a){return b.physicalData[a]})||null;try{var h=function(h){var j=e.keyPath?b.physicalData[e.keyPath]:
f,k=b.physicalData;c.openCursor(d.IDBKeyRange.only(j)).onsuccess=function(c){try{var d=c.target.result;d?h(d,j,k):Guard.raise(new Exception("Object not found",null,b))}catch(e){u.abort();a.error(e)}}};switch(b.data.entityState){case $data.EntityState.Added:h=function(a,b){var b=$data.typeSystem.createCallbackSetting(b),c=null,f=d.db.transaction([d.sequenceStore],d.IDBTransaction.READ_WRITE).setCallbacks({onerror:b.error,oncomplete:function(){a.physicalData[e.keyPath]=c.lastInsertedId;b.success(a)}}).objectStore(d.sequenceStore);
f.openCursor(d.IDBKeyRange.only(a.entitySet.tableName)).onsuccess=function(b){if(b=b.target.result){c=b.value;var d=c.lastInsertedId;typeof d!=="number"&&Guard.raise(new Exception("Invalid field type! Must be number",null,d));++c.lastInsertedId;b.update(c)}else f.add(c={store:a.entitySet.tableName,lastInsertedId:1})}};if(e.keyPath){var j=function(a){c.add(a.physicalData).onsuccess=function(b){a.data[e.keyPath]=b.target.result}};d.newVersionAPI&&b.physicalData[e.keyPath]===void 0?h(b,{success:j,error:function(a){Guard.raise(new Exception("Can't generate new id",
null,a))}}):j(b)}else c.add(b.physicalData,f);break;case $data.EntityState.Deleted:h(function(a){a["delete"]()});break;case $data.EntityState.Modified:h(function(a,b,c){a.update(c)});break;case $data.EntityState.Unchanged:break;default:Guard.raise(new Exception("Not supported entity state",null,b))}}catch(n){u.abort();a.error(n)}})}}var d=this,e=d.buildIndependentBlocks(b);c()},_compile:function(a){return Container.createIndexedDBCompiler().compile(a)}},{isSupported:{get:function(){return window.indexedDB||
window.webkitIndexedDB||window.mozIndexedDB||window.msIndexedDB},set:function(){}}});$data.storageProviders.indexedDb.DbCreationType={Default:1,DropStoreIfOlderVersion:2,DropStoreIfExists:3};$data.storageProviders.indexedDb.IndexedDBStorageProvider.isSupported&&$data.StorageProviderBase.registerProvider("indexedDb",$data.storageProviders.indexedDb.IndexedDBStorageProvider);
$data.Class.define("$data.Authentication.AuthenticationBase",null,null,{constructor:function(a){this.configuration=a||{};this.Authenticated=false},Login:function(){Guard.raise("Pure class")},Logout:function(){Guard.raise("Pure class")},CreateRequest:function(){Guard.raise("Pure class")}},null);
$data.Class.define("$data.Authentication.Anonymous",$data.Authentication.AuthenticationBase,null,{constructor:function(a){this.configuration=a||{};this.Authenticated=false},Login:function(){},Logout:function(){},CreateRequest:function(a){$data.ajax(a)}},null);
$data.Class.define("$data.Authentication.FacebookAuth",$data.Authentication.AuthenticationBase,null,{constructor:function(a){this.configuration=$data.typeSystem.extend({Url_code:"",type_code:"",scope:"",Url_token:"",type_token:"",access_token:"",app_id:""},a)},Login:function(a){if(!this.Authenticated){var b=this;b.configuration.stateCallbacks=a||{};$data.ajax({url:this.configuration.Url_code,data:"type="+b.configuration.type_code+"&client_id="+b.configuration.app_id+"&scope="+b.configuration.scope,
type:"POST",dataType:"json",success:function(a){typeof b.configuration.stateCallbacks.pending=="function"&&b.configuration.stateCallbacks.pending(a);b._processRequestToken(a);b.Authenticated=true},error:function(){typeof b.configuration.stateCallbacks.error=="function"&&b.configuration.stateCallbacks.error(arguments)}})}},Logout:function(){this.Authenticated=false},CreateRequest:function(a){if(a){if(a.url&&this.Authenticated){var b="?";a.url.indexOf(b)>0&&(b="&");if(this.configuration.access_token)a.url=
a.url+b+"access_token="+this.configuration.access_token}$data.ajax(a)}},_processRequestToken:function(a){var b=this;$data.ajax({url:b.configuration.Url_token,data:"type="+b.configuration.type_token+"&client_id="+b.configuration.app_id+"&code="+a.code,type:"POST",dataType:"json",success:function(a){b.configuration.access_token=a.access_token;typeof b.configuration.stateCallbacks.success=="function"&&b.configuration.stateCallbacks.success(a)},error:function(c){var d=eval("("+c.responseText+")");d.error&&
(d.error.message=="authorization_pending"?setTimeout(function(){b._processRequestToken(a)},2E3):typeof b.configuration.stateCallbacks.abort=="function"&&b.configuration.stateCallbacks.abort(arguments))}})}},null);
$data.Class.define("$data.storageProviders.Facebook.FacebookProvider",$data.StorageProviderBase,null,{constructor:function(a){this.SqlCommands=[];this.context={};this.providerConfiguration=$data.typeSystem.extend({FQLFormat:"format=json",FQLQueryUrl:"https://graph.facebook.com/fql?q="},a);this.initializeStore=function(a){a=$data.typeSystem.createCallbackSetting(a);a.success(this.context)}},AuthenticationProvider:{dataType:"$data.Authentication.AuthenticationBase",enumerable:!1},supportedDataTypes:{value:[$data.Integer,
$data.Number,$data.Date,$data.String,$data.Boolean,$data.Blob,$data.Array],writable:!1},supportedFieldOperations:{value:{contains:{dataType:$data.String,allowedIn:$data.Expressions.FilterExpression,mapTo:"strpos",parameters:[{name:"@expression",dataType:$data.String},{name:"strFragment",dataType:$data.String}],rigthValue:") >= 0"},startsWith:{dataType:$data.String,allowedIn:$data.Expressions.FilterExpression,mapTo:"strpos",parameters:[{name:"@expression",dataType:$data.String},{name:"strFragment",
dataType:$data.String}],rigthValue:") = 0"},strpos:{dataType:$data.String,allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.ProjectionExpression],mapTo:"strpos",parameters:[{name:"@expression",dataType:$data.String},{name:"strFragment",dataType:$data.String}]},substr:{dataType:$data.String,allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.ProjectionExpression],mapTo:"substr",parameters:[{name:"@expression",dataType:$data.String},{name:"startIdx",dataType:$data.Number},
{name:"length",dataType:$data.Number}]},strlen:{dataType:$data.String,allowedIn:[$data.Expressions.FilterExpression,$data.Expressions.ProjectionExpression],mapTo:"strlen",parameters:[{name:"@expression",dataType:$data.String}]}},enumerable:!0,writable:!0},supportedBinaryOperators:{value:{equal:{mapTo:" = ",dataType:$data.Boolean,allowedIn:$data.Expressions.FilterExpression},notEqual:{mapTo:" != ",dataType:$data.Boolean,allowedIn:$data.Expressions.FilterExpression},equalTyped:{mapTo:" = ",dataType:$data.Boolean,
allowedIn:$data.Expressions.FilterExpression},notEqualTyped:{mapTo:" != ",dataType:$data.Boolean,allowedIn:$data.Expressions.FilterExpression},greaterThan:{mapTo:" > ",dataType:$data.Boolean,allowedIn:$data.Expressions.FilterExpression},greaterThanOrEqual:{mapTo:" >= ",dataType:$data.Boolean,allowedIn:$data.Expressions.FilterExpression},lessThan:{mapTo:" < ",dataType:$data.Boolean,allowedIn:$data.Expressions.FilterExpression},lessThenOrEqual:{mapTo:" <= ",dataType:$data.Boolean,allowedIn:$data.Expressions.FilterExpression},
or:{mapTo:" OR ",dataType:$data.Boolean,allowedIn:$data.Expressions.FilterExpression},and:{mapTo:" AND ",dataType:$data.Booleanv},"in":{mapTo:" IN ",dataType:$data.Boolean,resolvableType:[$data.Array,$data.Queryable],allowedIn:$data.Expressions.FilterExpression}}},supportedUnaryOperators:{value:{}},fieldConverter:{value:{fromDb:{"$data.Number":function(a){return typeof a==="number"?a:parseInt(a)},"$data.Integer":function(a){return typeof a==="number"?a:parseFloat(a)},"$data.String":function(a){return a},
"$data.Date":function(a){return new Date(typeof a==="string"?parseInt(a):a)},"$data.Boolean":function(a){return!!a},"$data.Blob":function(a){return a},"$data.Array":function(a){return a===void 0?new $data.Array:a}},toDb:{"$data.Number":function(a){return a},"$data.Integer":function(a){return a},"$data.String":function(a){return"'"+a+"'"},"$data.Date":function(a){return a?a.valueOf():null},"$data.Boolean":function(a){return a},"$data.Blob":function(a){return a},"$data.Array":function(a){return"("+
a.join(", ")+")"}}}},supportedSetOperations:{value:{filter:{},map:{},forEach:{},toArray:{},single:{},take:{},skip:{},orderBy:{},orderByDescending:{},first:{}},enumerable:!0,writable:!0},executeQuery:function(a,b){b=$data.typeSystem.createCallbackSetting(b);if(!this.AuthenticationProvider)this.AuthenticationProvider=new $data.Authentication.Anonymous({});var c;try{c=this._compile(a)}catch(d){b.error(d);return}var e=a.defaultType,h=[];c.selectMapping||this._discoverType("",e,h);c={url:this.providerConfiguration.FQLQueryUrl+
encodeURIComponent(c.queryText)+"&"+this.providerConfiguration.FQLFormat,dataType:"JSON",success:function(c){a.rawDataList=c.data;Container.createModelBinderConfigCompiler(a,[]).Visit(a.expression);b.success(a)},error:function(a,c,d){c={};try{c=JSON.parse(a.responseText).error}catch(e){c=d+": "+a.responseText}b.error(c)}};this.context.prepareRequest.call(this,c);this.AuthenticationProvider.CreateRequest(c)},_discoverType:function(a,b,c){b.memberDefinitions.getPublicMappedProperties().forEach(function(b){var e=
Container.resolveType(b.dataType);if(e.isAssignableTo||e==Array){var h=a?a+"."+b.name:b.name;if(e==Array||e.isAssignableTo($data.EntitySet))if(b.inverseProperty)e=Container.resolveType(b.elementType);else return;c.push({name:h,type:e});this._discoverType(h,e,c)}},this)},_compile:function(a){return Container.createFacebookCompiler().compile(a)},getTraceString:function(a){if(!this.AuthenticationProvider)this.AuthenticationProvider=new $data.Authentication.Anonymous({});return this._compile(a)},setContext:function(a){this.context=
a},saveChanges:function(){Guard.raise(new Exception("Not implemented","Not implemented"))}},null);$data.StorageProviderBase.registerProvider("Facebook",$data.storageProviders.Facebook.FacebookProvider);
$C("$data.storageProviders.Facebook.FacebookCompiler",$data.Expressions.EntityExpressionVisitor,null,{constructor:function(){this.provider={}},compile:function(a){this.provider=a.context.storageProvider;var b={filterSql:{sql:""},projectionSql:{sql:""},orderSql:{sql:""},skipSql:{sql:""},takeSql:{sql:""},tableName:""};this.Visit(a.expression,b);var c=false;if(!b.projectionSql.sql){b.projectionSql=this.autoGenerateProjection(a);c=true}b.filterSql.sql==""&&Guard.raise(new Exception("Filter/where statement is required",
"invalid operation"));return{queryText:b.projectionSql.sql+" FROM "+b.tableName+b.filterSql.sql+b.orderSql.sql+b.takeSql.sql+(b.takeSql.sql?b.skipSql.sql:""),selectMapping:c==false?b.projectionSql.selectFields:null,params:[]}},autoGenerateProjection:function(a){var b=a.context.getEntitySetFromElementType(a.defaultType),b=new $data.Queryable(a.context,b.expression),c=Container.createCodeExpression(this.generateProjectionFunc(a)),c=Container.createProjectionExpression(b.expression,c),b=Container.createQueryable(b,
c).expression,b=Container.createQueryExpressionCreator(a.context).Visit(b),a={projectionSql:{sql:""}};this.Visit(b,a);return a.projectionSql},generateProjectionFunc:function(a){var b=this.provider.AuthenticationProvider.Authenticated,a=a.defaultType.memberDefinitions.getPublicMappedProperties();!b&&a.some(function(a){return a.isPublic==true})&&(a=a.filter(function(a){return a.isPublic==true}));var c="function (s){ return {";a.forEach(function(a,b){b!=0&&(c=c+", ");c=c+(a.name+": s."+a.name)});return c=
c+"};"},VisitFilterExpression:function(a,b){this.Visit(a.source,b);b.filterSql.type=a.nodeType;b.filterSql.sql=b.filterSql.sql==""?" WHERE ":b.filterSql.sql+" AND ";this.Visit(a.selector,b.filterSql)},VisitProjectionExpression:function(a,b){this.Visit(a.source,b);b.projectionSql.type=a.nodeType;b.projectionSql.sql==""?b.projectionSql.sql="SELECT ":Guard.raise(new Exception("Multiple select error"));this.Visit(a.selector,b.projectionSql)},VisitOrderExpression:function(a,b){this.Visit(a.source,b);b.orderSql.type=
a.nodeType;b.orderSql.sql==""?b.orderSql.sql=" ORDER BY ":Guard.raise(new Exception("Multiple sorting not supported","not supported"));this.Visit(a.selector,b.orderSql);b.orderSql.sql=b.orderSql.sql+(a.nodeType==ExpressionType.OrderByDescending?" DESC":" ASC")},VisitPagingExpression:function(a,b){this.Visit(a.source,b);if(a.nodeType==ExpressionType.Skip){b.skipSql.type=a.nodeType;b.skipSql.sql=" OFFSET ";this.Visit(a.amount,b.skipSql)}else if(a.nodeType==ExpressionType.Take){b.takeSql.type=a.nodeType;
b.takeSql.sql=" LIMIT ";this.Visit(a.amount,b.takeSql)}},VisitSimpleBinaryExpression:function(a,b){b.sql=b.sql+"(";this.Visit(a.left,b);b.sql=b.sql+a.resolution.mapTo;a.resolution.resolvableType&&!Guard.requireType(a.resolution.mapTo+" expression.right.value",a.right.value,a.resolution.resolvableType)&&Guard.raise(new Exception(a.right.type+" not allowed in '"+a.resolution.mapTo+"' statement","invalid operation"));this.Visit(a.right,b);b.sql=b.sql+")"},VisitEntityFieldExpression:function(a,b){this.Visit(a.selector,
b)},VisitMemberInfoExpression:function(a,b){var c=a.memberName;b.sql=b.sql+c;b.fieldData={name:c,dataType:a.memberDefinition.dataType};if(b.type=="Projection"&&!b.selectFields)b.selectFields=b.fieldOperation===true?[{from:"anon"}]:[{from:c,dataType:a.memberDefinition.dataType}]},VisitConstantExpression:function(a,b){b.type=="Projection"&&Guard.raise(new Exception("Constant value is not supported in Projection.","Not supported!"));this.VisitQueryParameterExpression(a,b)},VisitQueryParameterExpression:function(a,
b){var c=Container.resolveType(Container.getTypeName(a.value));if(this.provider.supportedDataTypes.indexOf(c)!=-1)b.sql=b.sql+this.provider.fieldConverter.toDb[Container.resolveName(c)](a.value);else switch(c){case $data.Queryable:b.sql=b.sql+("("+a.value.toTraceString().queryText+")");break;default:b.sql=b.sql+(""+a.value+"")}},VisitParametricQueryExpression:function(a,b){this.Visit(a.expression,b);b.parameters=a.parameters},VisitEntitySetExpression:function(a,b){b.tableName=a.instance.tableName},
VisitObjectLiteralExpression:function(a,b){var c=this;b.selectFields=b.selectFields||[];a.members.forEach(function(a){if(a.expression instanceof $data.Expressions.ObjectLiteralExpression){b.mappingPrefix=b.mappingPrefix||[];b.mappingPrefix.push(a.fieldName);c.Visit(a,b);b.mappingPrefix.pop()}else{if(b.selectFields.length>0)b.sql=b.sql+", ";c.Visit(a,b);a=b.mappingPrefix instanceof Array?b.mappingPrefix.join(".")+"."+a.fieldName:a.fieldName;b.selectFields.push({from:b.fieldData.name,to:a,dataType:b.fieldData.dataType})}})},
VisitObjectFieldExpression:function(a,b){return this.Visit(a.expression,b)},VisitEntityFieldOperationExpression:function(a,b){Guard.requireType("expression.operation",a.operation,$data.Expressions.MemberInfoExpression);var c=a.operation.memberDefinition,d=c.mapTo||c.name;b.sql=b.sql+"(";c.expressionInParameter==false&&this.Visit(a.source,b);b.sql=b.sql+d;b.sql=b.sql+"(";var e=0;(c.parameters||[]).map(function(b){var c={dataType:b.dataType};if(b.value)c.value=b.value;else if(b.name==="@expression")c.value=
a.source;else{c.value=a.parameters[e];c.itemType=a.parameters[e++].type}return c}).forEach(function(c,d){var e=c.itemType?Container.resolveType(c.itemType):null;if(!e||c.dataType instanceof Array&&c.dataType.indexOf(e)!=-1||c.dataType==e){if(d>0)b.sql=b.sql+", ";if(b.type=="Projection")b.fieldOperation=true;this.Visit(c.value,b);if(b.type=="Projection")b.fieldOperation=void 0}else Guard.raise(new Exception(parameter.type+" not allowed in '"+a.operation.memberName+"' statement","invalid operation"))},
this);if(b.fieldData&&b.fieldData.name)b.fieldData.name="anon";b.sql=c.rigthValue?b.sql+c.rigthValue:b.sql+")";b.sql=b.sql+")"}},null);
$data.Class.define("$data.Facebook.types.FbUser",$data.Entity,null,{uid:{type:"int",key:!0,isPublic:!0,searchable:!0},username:{type:"string",isPublic:!0,searchable:!0},first_name:{type:"string",isPublic:!0},middle_name:{type:"string",isPublic:!0},last_name:{type:"string",isPublic:!0},name:{type:"string",isPublic:!0,searchable:!0},pic_small:{type:"string"},pic_big:{type:"string"},pic_square:{type:"string"},pic:{type:"string"},affiliations:{type:"Array",elementType:"Object"},profile_update_time:{type:"datetime"},
timezone:{type:"int"},religion:{type:"string"},birthday:{type:"string"},birthday_date:{type:"string"},sex:{type:"string",isPublic:!0},hometown_location:{type:"Array",elementType:"Object"},meeting_sex:{type:"Array",elementType:"Object"},meeting_for:{type:"Array",elementType:"Object"},relationship_status:{type:"string"},significant_other_id:{type:"int"},political:{type:"string"},current_location:{type:"Array",elementType:"Object"},activities:{type:"string"},interests:{type:"string"},is_app_user:{type:"bool"},
music:{type:"string"},tv:{type:"string"},movies:{type:"string"},books:{type:"string"},quotes:{type:"string"},about_me:{type:"string"},hs_info:{type:"Array",elementType:"Object"},education_history:{type:"Array",elementType:"Object"},work_history:{type:"Array",elementType:"Object"},notes_count:{type:"int"},wall_count:{type:"int"},status:{type:"string"},has_added_app:{type:"bool"},online_presence:{type:"string"},locale:{type:"string",isPublic:!0},proxied_email:{type:"string"},profile_url:{type:"string"},
email_hashes:{type:"Array",elementType:"Object"},pic_small_with_logo:{type:"string",isPublic:!0},pic_big_with_logo:{type:"string",isPublic:!0},pic_square_with_logo:{type:"string",isPublic:!0},pic_with_logo:{type:"string",isPublic:!0},allowed_restrictions:{type:"string"},verified:{type:"bool"},profile_blurb:{type:"string"},family:{type:"Array",elementType:"Object"},website:{type:"string"},is_blocked:{type:"bool"},contact_email:{type:"string"},email:{type:"string"},third_party_id:{type:"string",searchable:!0},
name_format:{type:"string"},video_upload_limits:{type:"Array",elementType:"Object"},games:{type:"string"},work:{type:"Array",elementType:"Object"},education:{type:"Array",elementType:"Object"},sports:{type:"Array",elementType:"Object"},favorite_athletes:{type:"Array",elementType:"Object"},favorite_teams:{type:"Array",elementType:"Object"},inspirational_people:{type:"Array",elementType:"Object"},languages:{type:"Array",elementType:"Object"},likes_count:{type:"int"},friend_count:{type:"int"},mutual_friend_count:{type:"int"},
can_post:{type:"bool"}},null);$data.Class.define("$data.Facebook.types.FbFriend",$data.Entity,null,{uid1:{type:"int",key:!0,searchable:!0},uid2:{type:"int",key:!0,searchable:!0}},null);
$data.Class.define("$data.Facebook.types.FbPage",$data.Entity,null,{page_id:{type:"int",key:!0,isPublic:!0,searchable:!0},name:{type:"string",isPublic:!0,searchable:!0},username:{type:"string",isPublic:!0,searchable:!0},description:{type:"string",isPublic:!0},categories:{type:"string",isPublic:!0},is_community_page:{type:"bool",isPublic:!0},pic_small:{type:"string",isPublic:!0},pic_big:{type:"string",isPublic:!0},pic_square:{type:"string",isPublic:!0},pic:{type:"string",isPublic:!0},pic_large:{type:"string",
isPublic:!0},pic_cover:{type:"string",isPublic:!0},unread_notif_count:{type:"int",isPublic:!1},new_like_count:{type:"int",isPublic:!1},fan_count:{type:"int",isPublic:!0},type:{type:"string",isPublic:!0},website:{type:"string",isPublic:!0},has_added_app:{type:"bool",isPublic:!0},general_info:{type:"string",isPublic:!0},can_post:{type:"bool",isPublic:!0},checkins:{type:"int",isPublic:!0},is_published:{type:"bool",isPublic:!0},founded:{type:"string",isPublic:!0},company_overview:{type:"string",isPublic:!0},
mission:{type:"string",isPublic:!0},products:{type:"string",isPublic:!0},location:{type:"string",isPublic:!0},parking:{type:"string",isPublic:!0},hours:{type:"string",isPublic:!0},pharma_safety_info:{type:"string",isPublic:!0},public_transit:{type:"string",isPublic:!0},attire:{type:"string",isPublic:!0},payment_options:{type:"string",isPublic:!0},culinary_team:{type:"string",isPublic:!0},general_manager:{type:"string",isPublic:!0},price_range:{type:"string",isPublic:!0},restaurant_services:{type:"string",
isPublic:!0},restaurant_specialties:{type:"string",isPublic:!0},phone:{type:"string",isPublic:!0},release_date:{type:"string",isPublic:!0},genre:{type:"string",isPublic:!0},starring:{type:"string",isPublic:!0},screenplay_by:{type:"string",isPublic:!0},directed_by:{type:"string",isPublic:!0},produced_by:{type:"string",isPublic:!0},studio:{type:"string",isPublic:!0},awards:{type:"string",isPublic:!0},plot_outline:{type:"string",isPublic:!0},season:{type:"string",isPublic:!0},network:{type:"string",
isPublic:!0},schedule:{type:"string",isPublic:!0},written_by:{type:"string",isPublic:!0},band_members:{type:"string",isPublic:!0},hometown:{type:"string",isPublic:!0},current_location:{type:"string",isPublic:!0},record_label:{type:"string",isPublic:!0},booking_agent:{type:"string",isPublic:!0},press_contact:{type:"string",isPublic:!0},artists_we_like:{type:"string",isPublic:!0},influences:{type:"string",isPublic:!0},band_interests:{type:"string",isPublic:!0},bio:{type:"string",isPublic:!0},affiliation:{type:"string",
isPublic:!0},birthday:{type:"string",isPublic:!0},personal_info:{type:"string",isPublic:!0},personal_interests:{type:"string",isPublic:!0},built:{type:"string",isPublic:!0},features:{type:"string",isPublic:!0},mpg:{type:"string",isPublic:!0}},null);$data.Class.define("$data.storageProviders.Facebook.EntitySets.Command",null,null,{constructor:function(a){this.Config=$data.typeSystem.extend({CommandValue:""},a)},toString:function(){return this.Config.CommandValue},Config:{}},null);
$data.Class.define("$data.Facebook.FQLContext",$data.EntityContext,null,{constructor:function(){var a=this.Friends.where(function(a){return a.uid1==this.me},{me:$data.Facebook.FQLCommands.me}).select(function(a){return a.uid2});this.MyFriends=this.Users.where(function(a){return a.uid==this.me||a.uid in this.friends},{me:$data.Facebook.FQLCommands.me,friends:a})},Users:{dataType:$data.EntitySet,tableName:"user",elementType:$data.Facebook.types.FbUser},Friends:{dataType:$data.EntitySet,tableName:"friend",
elementType:$data.Facebook.types.FbFriend},Pages:{dataType:$data.EntitySet,tableName:"page",elementType:$data.Facebook.types.FbPage}},null);$data.Facebook.FQLCommands={__namespace:!0,me:new $data.storageProviders.Facebook.EntitySets.Command({CommandValue:"me()"}),now:new $data.storageProviders.Facebook.EntitySets.Command({CommandValue:"now()"})};
$data.Class.define("$data.storageProviders.YQL.YQLProvider",$data.StorageProviderBase,null,{constructor:function(a){this.SqlCommands=[];this.context={};this.extendedCreateNew=[];this.providerConfiguration=$data.typeSystem.extend({YQLFormat:"format=json",YQLQueryUrl:"http://query.yahooapis.com/v1/public/yql?q=",YQLEnv:"",resultPath:["query","results"],resultSkipFirstLevel:true},a);this.initializeStore=function(a){a=$data.typeSystem.createCallbackSetting(a);a.success(this.context)}},AuthenticationProvider:{dataType:"$data.Authentication.AuthenticationBase",
enumerable:!1},supportedDataTypes:{value:[$data.Integer,$data.Number,$data.Date,$data.String,$data.Boolean,$data.Blob,$data.Array],writable:!1},supportedFieldOperations:{value:{contains:{dataType:$data.String,allowedIn:$data.Expressions.FilterExpression,mapTo:" LIKE ",expressionInParameter:!1,parameters:[{name:"inStatement",dataType:$data.String,prefix:"%",suffix:"%"}]},startsWith:{dataType:$data.String,allowedIn:$data.Expressions.FilterExpression,mapTo:" LIKE ",expressionInParameter:!1,parameters:[{name:"inStatement",
dataType:$data.String,suffix:"%"}]},endsWith:{dataType:$data.String,allowedIn:$data.Expressions.FilterExpression,mapTo:" LIKE ",expressionInParameter:!1,parameters:[{name:"inStatement",dataType:$data.String,prefix:"%"}]}},enumerable:!0,writable:!0},supportedBinaryOperators:{value:{equal:{mapTo:" = ",dataType:$data.Boolean,allowedIn:$data.Expressions.FilterExpression},notEqual:{mapTo:" != ",dataType:$data.Boolean,allowedIn:$data.Expressions.FilterExpression},equalTyped:{mapTo:" = ",dataType:$data.Boolean,
allowedIn:$data.Expressions.FilterExpression},notEqualTyped:{mapTo:" != ",dataType:$data.Boolean,allowedIn:$data.Expressions.FilterExpression},greaterThan:{mapTo:" > ",dataType:$data.Boolean,allowedIn:$data.Expressions.FilterExpression},greaterThanOrEqual:{mapTo:" >= ",dataType:$data.Boolean,allowedIn:$data.Expressions.FilterExpression},lessThan:{mapTo:" < ",dataType:$data.Boolean,allowedIn:$data.Expressions.FilterExpression},lessThenOrEqual:{mapTo:" <= ",dataType:$data.Boolean,allowedIn:$data.Expressions.FilterExpression},
or:{mapTo:" OR ",dataType:$data.Boolean,allowedIn:$data.Expressions.FilterExpression},and:{mapTo:" AND ",dataType:$data.Boolean,allowedIn:$data.Expressions.FilterExpression},"in":{mapTo:" IN ",dataType:$data.Boolean,resolvableType:[$data.Array,$data.Queryable],allowedIn:$data.Expressions.FilterExpression}}},supportedUnaryOperators:{value:{}},supportedSetOperations:{value:{filter:{},map:{},forEach:{},toArray:{},single:{},take:{},skip:{},orderBy:{},orderByDescending:{},first:{}},enumerable:!0,writable:!0},
fieldConverter:{value:{fromDb:{"$data.Number":function(a){return typeof a==="number"?a:parseInt(a)},"$data.Integer":function(a){return typeof a==="number"?a:parseFloat(a)},"$data.String":function(a){return a},"$data.Date":function(a){return new Date(typeof a==="string"?parseInt(a):a)},"$data.Boolean":function(a){return!!a},"$data.Blob":function(a){return a},"$data.Array":function(a){return a===void 0?new $data.Array:a}},toDb:{"$data.Number":function(a){return a},"$data.Integer":function(a){return a},
"$data.String":function(a){return"'"+a+"'"},"$data.Date":function(a){return a?a.valueOf():null},"$data.Boolean":function(a){return a},"$data.Blob":function(a){return a},"$data.Array":function(a){return"("+a.join(", ")+")"}}}},executeQuery:function(a,b){var c=this,b=$data.typeSystem.createCallbackSetting(b),d=a.defaultType,e=a.context.getType().memberDefinitions.asArray().filter(function(a){return a.elementType==d})[0]||{};if(!this.AuthenticationProvider)this.AuthenticationProvider=new $data.Authentication.Anonymous({});
var h;try{h=this._compile(a)}catch(f){b.error(f);return}h={url:this.providerConfiguration.YQLQueryUrl+encodeURIComponent(h.queryText)+"&"+this.providerConfiguration.YQLFormat+(this.providerConfiguration.YQLEnv?"&env="+this.providerConfiguration.YQLEnv:""),dataType:"JSON",success:function(d){d=c._preProcessData(d,e);if(d!=false){a.rawDataList=d;e.anonymousResult?a.rawDataList=d:Container.createModelBinderConfigCompiler(a,[]).Visit(a.expression)}b.success(a)},error:function(a,c,d){c={};try{c=JSON.parse(a.responseText).error}catch(e){c=
d+": "+a.responseText}b.error(c)}};this.context.prepareRequest.call(this,h);this.AuthenticationProvider.CreateRequest(h)},_preProcessData:function(a,b){for(var c=a,d=b.resultPath!=void 0?b.resultPath:this.providerConfiguration.resultPath,e=0;e<d.length;e++)if(c[d[e]])c=c[d[e]];else return false;if((b.resultSkipFirstLevel!=void 0?b.resultSkipFirstLevel:this.providerConfiguration.resultSkipFirstLevel)==true){d=Object.keys(c);if(d.length==1&&(c[d[0]]instanceof Array||!b.anonymousResult))c=c[d[0]]}return c.length?
c:[c]},_compile:function(a){return Container.createYQLCompiler().compile(a)},getTraceString:function(a){if(!this.AuthenticationProvider)this.AuthenticationProvider=new $data.Authentication.Anonymous({});return this._compile(a)},setContext:function(a){this.context=a},saveChanges:function(){Guard.raise(new Exception("Not Implemented","Not Implemented"))}},null);$data.StorageProviderBase.registerProvider("YQL",$data.storageProviders.YQL.YQLProvider);
$C("$data.storageProviders.YQL.YQLCompiler",$data.Expressions.EntityExpressionVisitor,null,{constructor:function(){this.provider={};this.cTypeCache={}},compile:function(a){this.provider=a.context.storageProvider;var b={filterSql:{sql:""},projectionSql:{sql:""},orderSql:{sql:""},skipSql:{sql:""},takeSql:{sql:""},tableName:""};this.Visit(a.expression,b);if(b.projectionSql.sql=="")b.projectionSql.sql="SELECT *";if(b.orderSql.sql)b.orderSql.sql=" | sort("+b.orderSql.sql+")";if(b.skipSql.value&&b.takeSql.value){a=
b.skipSql.value;b.skipSql.value=b.takeSql.value;b.takeSql.value=b.takeSql.value+a}if(b.skipSql.value)b.skipSql.sql=b.skipSql.sqlPre+b.skipSql.value+b.skipSql.sqlSuf;if(b.takeSql.value)b.takeSql.sql=b.takeSql.sqlPre+b.takeSql.value+b.takeSql.sqlSuf;return{queryText:b.projectionSql.sql+" FROM "+b.tableName+b.filterSql.sql+b.orderSql.sql+b.takeSql.sql+(b.takeSql.sql?b.skipSql.sql:""),selectMapping:b.projectionSql.selectFields,params:[]}},VisitFilterExpression:function(a,b){this.Visit(a.source,b);b.filterSql.type=
a.nodeType;b.filterSql.sql=b.filterSql.sql==""?" WHERE ":b.filterSql.sql+" AND ";this.Visit(a.selector,b.filterSql)},VisitProjectionExpression:function(a,b){this.Visit(a.source,b);b.projectionSql.type=a.nodeType;b.projectionSql.sql==""?b.projectionSql.sql="SELECT ":Guard.raise(new Exception("multiple select error"));this.Visit(a.selector,b.projectionSql)},VisitOrderExpression:function(a,b){this.Visit(a.source,b);b.orderSql.type=a.nodeType;var c={sql:""};this.Visit(a.selector,c);b.orderSql.sql="field='"+
c.sql+"', descending='"+(a.nodeType==ExpressionType.OrderByDescending)+"'"+(b.orderSql.sql!=""?", "+b.orderSql.sql:"")},VisitPagingExpression:function(a,b){this.Visit(a.source,b);if(a.nodeType==ExpressionType.Skip){b.skipSql.type=a.nodeType;b.skipSql.sqlPre=" | tail(count=";this.Visit(a.amount,b.skipSql);b.skipSql.sqlSuf=")"}else if(a.nodeType==ExpressionType.Take){b.takeSql.type=a.nodeType;b.takeSql.sqlPre=" | truncate(count=";this.Visit(a.amount,b.takeSql);b.takeSql.sqlSuf=")"}},VisitSimpleBinaryExpression:function(a,
b){b.sql=b.sql+"(";this.Visit(a.left,b);b.sql=b.sql+a.resolution.mapTo;a.resolution.resolvableType&&!Guard.requireType(a.resolution.mapTo+" expression.right.value",a.right.value,a.resolution.resolvableType)&&Guard.raise(new Exception(a.right.type+" not allowed in '"+a.resolution.mapTo+"' statement","invalid operation"));this.Visit(a.right,b);b.sql=b.sql+")"},VisitEntityFieldExpression:function(a,b){this.Visit(a.source,b);this.Visit(a.selector,b)},VisitMemberInfoExpression:function(a,b){var c;if(b.wasComplex===
true)b.sql=b.sql+".";b.sql=b.sql+a.memberName;if(b.isComplex==true){b.complex=b.complex+a.memberName;b.wasComplex=true}else{b.wasComplex=false;c=b.complex?b.complex+a.memberName:a.memberName;b.complex=null;b.fieldData={name:c,dataType:a.memberDefinition.dataType};if(b.type=="Projection"&&!b.selectFields)b.selectFields=[{from:c,dataType:a.memberDefinition.dataType}]}},VisitConstantExpression:function(a,b){b.type=="Projection"&&Guard.raise(new Exception("Constant value is not supported in Projection.",
"Not supported!"));this.VisitQueryParameterExpression(a,b)},VisitQueryParameterExpression:function(a,b){b.value=a.value;var c=Container.resolveType(Container.getTypeName(a.value));if(this.provider.supportedDataTypes.indexOf(c)!=-1)b.sql=b.sql+this.provider.fieldConverter.toDb[Container.resolveName(c)](a.value);else switch(c){case $data.Queryable:b.sql=b.sql+("("+a.value.toTraceString().queryText+")");break;default:b.sql=b.sql+(""+a.value+"")}},VisitParametricQueryExpression:function(a,b){if(b.type==
"Projection"){this.Visit(a.expression,b);if(a.expression instanceof $data.Expressions.ComplexTypeExpression){b.selectFields=b.selectFields||[];var c=a.expression.entityType,d=this._getComplexTypeIncludes(c);b.selectFields.push({from:b.complex,type:c,includes:d})}}else{this.Visit(a.expression,b);b.parameters=a.parameters}},VisitEntitySetExpression:function(a,b){if(b.type){if(!b.complex)b.complex=""}else b.tableName=a.instance.tableName},VisitObjectLiteralExpression:function(a,b){var c=this;b.selectFields=
b.selectFields||[];a.members.forEach(function(a){if(a.expression instanceof $data.Expressions.ObjectLiteralExpression){b.mappingPrefix=b.mappingPrefix||[];b.mappingPrefix.push(a.fieldName);c.Visit(a,b);b.mappingPrefix.pop()}else{if(b.selectFields.length>0)b.sql=b.sql+", ";c.Visit(a,b);a={from:b.fieldData.name,to:b.mappingPrefix instanceof Array?b.mappingPrefix.join(".")+"."+a.fieldName:a.fieldName};if(b.selectType){a.type=b.selectType;var e=this._getComplexTypeIncludes(b.selectType);a.includes=e}else a.dataType=
b.fieldData.dataType;b.selectFields.push(a);delete b.fieldData;delete b.selectType}},this)},VisitObjectFieldExpression:function(a,b){this.Visit(a.expression,b);if(a.expression instanceof $data.Expressions.ComplexTypeExpression){b.fieldData=b.fieldData||{};b.fieldData.name=b.complex;b.selectType=a.expression.entityType}},VisitEntityFieldOperationExpression:function(a,b){Guard.requireType("expression.operation",a.operation,$data.Expressions.MemberInfoExpression);var c=a.operation.memberDefinition,d=
c.mapTo||c.name;b.sql=b.sql+"(";c.expressionInParameter==false&&this.Visit(a.source,b);b.sql=b.sql+d;var e=0;(c.parameters||[]).map(function(b){var c={dataType:b.dataType,prefix:b.prefix,suffix:b.suffix};if(b.value)c.value=b.value;else if(b.name==="@expression")c.value=a.source;else{c.value=a.parameters[e];c.itemType=a.parameters[e++].type}return c}).forEach(function(c,e){var j=c.itemType?Container.resolveType(c.itemType):null;if(!j||c.dataType instanceof Array&&c.dataType.indexOf(j)!=-1||c.dataType==
j){if(e>0)b.sql=b.sql+", ";j={sql:""};this.Visit(c.value,j);if(d==" LIKE "){var n=Container.getTypeName(j.value);b.sql=b.sql+(n=="string"?"'":"");b.sql=b.sql+((c.prefix?c.prefix:"")+j.value+(c.suffix?c.suffix:""));b.sql=b.sql+(n=="string"?"'":"")}else b.sql=b.sql+j.sql}else Guard.raise(new Exception(parameter.type+" not allowed in '"+a.operation.memberName+"' statement","invalid operation"))},this);b.sql=c.rigthValue?b.sql+c.rigthValue:b.sql+"";b.sql=b.sql+")"},VisitComplexTypeExpression:function(a,
b){this.Visit(a.source,b);b.isComplex=true;this.Visit(a.selector,b);b.isComplex=false;if(b.complex!="")b.complex=b.complex+"."},VisitEntityExpression:function(a,b){this.Visit(a.source,b)},_findComplexType:function(a,b,c){a.memberDefinitions.getPublicMappedProperties().forEach(function(a){var e=Container.resolveType(a.dataType);if(e.isAssignableTo&&!e.isAssignableTo($data.EntitySet)){a=c?c+"."+a.name:a.name;b.push({name:a,type:e});this._findComplexType(e,b,a)}},this)},_getComplexTypeIncludes:function(a){if(!this.cTypeCache[a.name]){var b=
[];this._findComplexType(a,b);this.cTypeCache[a.name]=b}return this.cTypeCache[a.name]}},null);$data.Class.define("$data.Yahoo.types.Geo.placeTypeNameCf",$data.Entity,null,{code:{type:"string"},content:{type:"string"}},null);$data.Class.define("$data.Yahoo.types.Geo.countryCf",$data.Entity,null,{code:{type:"string"},type:{type:"string"},content:{type:"string"}},null);
$data.Class.define("$data.Yahoo.types.Geo.adminCf",$data.Entity,null,{code:{type:"string"},type:{type:"string"},content:{type:"string"}},null);$data.Class.define("$data.Yahoo.types.Geo.localityCf",$data.Entity,null,{code:{type:"string"},content:{type:"string"}},null);$data.Class.define("$data.Yahoo.types.Geo.centroidCf",$data.Entity,null,{latitude:{type:"string"},longitude:{type:"string"}},null);
$data.Class.define("$data.Yahoo.types.Geo.postalCf",$data.Entity,null,{type:{type:"string"},content:{type:"string"}},null);$data.Class.define("$data.Yahoo.types.Geo.boundingBoxCf",$data.Entity,null,{southWest:{type:"centroidRef"},northEast:{type:"centroidRef"}},null);$data.Class.define("$data.Yahoo.types.Geo.PlaceMeta",null,null,{woeid:{type:"int",key:!0},name:{type:"string"},uri:{type:"string"},placeTypeName:{type:"placeTypeNameRef"},lang:{type:"string"}},null);
$data.Class.defineEx("$data.Yahoo.types.Geo.PlaceMetaFull",[{type:null},{type:$data.Yahoo.types.Geo.PlaceMeta}],null,{country:{type:"countryRef"},admin1:{type:"adminRef"},admin2:{type:"adminRef"},admin3:{type:"adminRef"},locality1:{type:"localityRef"},locality2:{type:"localityRef"},postal:{type:"postalRef"},centroid:{type:"centroidRef"},boundingBox:{type:"boundingBoxRef"},areaRank:{type:"int"},popRank:{type:"int"}},null);
$data.Class.define("$data.Yahoo.types.Geo.placetype",$data.Entity,null,{woeid:{type:"int",key:!0},placeTypeDescription:{type:"string"},uri:{type:"string"},placeTypeName:{type:"placeTypeNameRef"},lang:{type:"string"},placetype:{type:"string"},placetypeid:{type:"string"}},null);$data.Class.defineEx("$data.Yahoo.types.Geo.sibling",[{type:$data.Entity},{type:$data.Yahoo.types.Geo.PlaceMetaFull}],null,{sibling_woeid:{type:"string"}},null);
$data.Class.defineEx("$data.Yahoo.types.Geo.parent",[{type:$data.Entity},{type:$data.Yahoo.types.Geo.PlaceMetaFull}],null,{child_woeid:{type:"string"}},null);$data.Class.defineEx("$data.Yahoo.types.Geo.neighbor",[{type:$data.Entity},{type:$data.Yahoo.types.Geo.PlaceMetaFull}],null,{neighbor_woeid:{type:"string"}},null);
$data.Class.defineEx("$data.Yahoo.types.Geo.common",[{type:$data.Entity},{type:$data.Yahoo.types.Geo.PlaceMetaFull}],null,{woeid1:{type:"string"},woeid2:{type:"string"},woeid3:{type:"string"},woeid4:{type:"string"},woeid5:{type:"string"},woeid6:{type:"string"},woeid7:{type:"string"},woeid8:{type:"string"},"long":{type:"string"}},null);
$data.Class.defineEx("$data.Yahoo.types.Geo.children",[{type:$data.Entity},{type:$data.Yahoo.types.Geo.PlaceMetaFull}],null,{parent_woeid:{type:"string"},placetype:{type:"string"}},null);$data.Class.defineEx("$data.Yahoo.types.Geo.belongto",[{type:$data.Entity},{type:$data.Yahoo.types.Geo.PlaceMetaFull}],null,{member_woeid:{type:"string"},placetype:{type:"string"}},null);
$data.Class.defineEx("$data.Yahoo.types.Geo.ancestor",[{type:$data.Entity},{type:$data.Yahoo.types.Geo.PlaceMetaFull}],null,{descendant_woeid:{type:"string"}},null);$data.Class.defineEx("$data.Yahoo.types.Geo.place",[{type:$data.Entity},{type:$data.Yahoo.types.Geo.PlaceMetaFull}],null,{text:{type:"string"},focus:{type:"string"},placetype:{type:"string"}},null);
$data.Class.defineEx("$data.Yahoo.types.Geo.county",[{type:$data.Entity},{type:$data.Yahoo.types.Geo.PlaceMeta}],null,{place:{type:"string"}},null);$data.Class.defineEx("$data.Yahoo.types.Geo.country",[{type:$data.Entity},{type:$data.Yahoo.types.Geo.PlaceMeta}],null,{place:{type:"string"}},null);$data.Class.defineEx("$data.Yahoo.types.Geo.district",[{type:$data.Entity},{type:$data.Yahoo.types.Geo.PlaceMeta}],null,{place:{type:"string"}},null);
$data.Class.defineEx("$data.Yahoo.types.Geo.sea",[{type:$data.Entity},{type:$data.Yahoo.types.Geo.PlaceMeta}],null,{place:{type:"string"}},null);$data.Class.defineEx("$data.Yahoo.types.Geo.state",[{type:$data.Entity},{type:$data.Yahoo.types.Geo.PlaceMeta}],null,{place:{type:"string"}},null);$data.Class.defineEx("$data.Yahoo.types.Geo.continent",[{type:$data.Entity},{type:$data.Yahoo.types.Geo.PlaceMeta}],null,{place:{type:"string"},view:{type:"string"}},null);
$data.Class.defineEx("$data.Yahoo.types.Geo.ocean",[{type:$data.Entity},{type:$data.Yahoo.types.Geo.PlaceMeta}],null,{place:{type:"string"},view:{type:"string"}},null);$data.Class.defineEx("$data.Yahoo.types.Geo.descendant",[{type:$data.Entity},{type:$data.Yahoo.types.Geo.PlaceMeta}],null,{ancestor_woeid:{type:"string"},placetype:{type:"string"},degree:{type:"string"},view:{type:"string"}},null);Container.registerType("placeTypeNameRef",$data.Yahoo.types.Geo.placeTypeNameCf);
Container.registerType("centroidRef",$data.Yahoo.types.Geo.centroidCf);Container.registerType("countryRef",$data.Yahoo.types.Geo.countryCf);Container.registerType("adminRef",$data.Yahoo.types.Geo.adminCf);Container.registerType("localityRef",$data.Yahoo.types.Geo.localityCf);Container.registerType("postalRef",$data.Yahoo.types.Geo.postalCf);Container.registerType("boundingBoxRef",$data.Yahoo.types.Geo.boundingBoxCf);
$data.Class.define("$data.Yahoo.YQLContext",$data.EntityContext,null,{Continents:{type:$data.EntitySet,elementType:$data.Yahoo.types.Geo.continent,tableName:"geo.continents"},Counties:{type:$data.EntitySet,elementType:$data.Yahoo.types.Geo.county,tableName:"geo.counties"},Countries:{type:$data.EntitySet,elementType:$data.Yahoo.types.Geo.country,tableName:"geo.countries"},Districts:{type:$data.EntitySet,elementType:$data.Yahoo.types.Geo.district,tableName:"geo.districts"},Oceans:{type:$data.EntitySet,
elementType:$data.Yahoo.types.Geo.ocean,tableName:"geo.oceans"},Places:{type:$data.EntitySet,elementType:$data.Yahoo.types.Geo.place,tableName:"geo.places"},PlaceTypes:{type:$data.EntitySet,elementType:$data.Yahoo.types.Geo.placetype,tableName:"geo.placetypes"},PlaceSiblings:{type:$data.EntitySet,elementType:$data.Yahoo.types.Geo.sibling,tableName:"geo.places.siblings"},PlaceParents:{type:$data.EntitySet,elementType:$data.Yahoo.types.Geo.parent,tableName:"geo.places.parent"},PlaceNeighbors:{type:$data.EntitySet,
elementType:$data.Yahoo.types.Geo.neighbor,tableName:"geo.places.neighbors"},PlaceCommons:{type:$data.EntitySet,elementType:$data.Yahoo.types.Geo.common,tableName:"geo.places.common"},PlaceChildrens:{type:$data.EntitySet,elementType:$data.Yahoo.types.Geo.children,tableName:"geo.places.children"},PlaceBelongtos:{type:$data.EntitySet,elementType:$data.Yahoo.types.Geo.belongto,tableName:"geo.places.belongtos"},PlaceAncestors:{type:$data.EntitySet,elementType:$data.Yahoo.types.Geo.ancestor,tableName:"geo.places.ancestors"},
Seas:{type:$data.EntitySet,elementType:$data.Yahoo.types.Geo.sea,tableName:"geo.seas"},States:{type:$data.EntitySet,elementType:$data.Yahoo.types.Geo.state,tableName:"geo.states"},PlaceDescendants:{type:$data.EntitySet,elementType:$data.Yahoo.types.Geo.descendant,tableName:"geo.places.descendants"},placeTypeNameRef:{value:$data.Yahoo.types.Geo.placeTypeNameCf},centroidRef:{value:$data.Yahoo.types.Geo.centroidCf},countryRef:{value:$data.Yahoo.types.Geo.countryCf},adminRef:{value:$data.Yahoo.types.Geo.adminCf},
localityRef:{value:$data.Yahoo.types.Geo.localityCf},postalRef:{value:$data.Yahoo.types.Geo.postalCf},boundingBoxRef:{value:$data.Yahoo.types.Geo.boundingBoxCf},Atom:{anonymousResult:!0,tableName:"atom",resultPath:["query","results"],resultSkipFirstLevel:!0,type:$data.EntitySet,elementType:$data.Class.define("$data.Yahoo.types.YQLAtom",$data.Entity,null,{url:{type:"string",required:!0,searchable:!0}},null)},Csv:{anonymousResult:!0,tableName:"csv",resultPath:["query","results"],resultSkipFirstLevel:!0,
type:$data.EntitySet,elementType:$data.Class.define("$data.Yahoo.types.YQLCsv",$data.Entity,null,{url:{type:"string",required:!0,searchable:!0},charset:{type:"string",searchable:!0},columns:{type:"string",searchable:!0}},null)},DataUri:{anonymousResult:!0,tableName:"data.uri",resultPath:["query","results"],resultSkipFirstLevel:!0,type:$data.EntitySet,elementType:$data.Class.define("$data.Yahoo.types.YQLDataUri",$data.Entity,null,{url:{type:"string",required:!0,searchable:!0}},null)},Feed:{anonymousResult:!0,
tableName:"feed",resultPath:["query","results"],resultSkipFirstLevel:!0,type:$data.EntitySet,elementType:$data.Class.define("$data.Yahoo.types.YQLFeed",$data.Entity,null,{url:{type:"string",required:!0,searchable:!0}},null)},FeedNormalizer:{anonymousResult:!0,tableName:"feednormalizer",resultPath:["query","results"],resultSkipFirstLevel:!0,type:$data.EntitySet,elementType:$data.Class.define("$data.Yahoo.types.YQLFeedNormalizer",$data.Entity,null,{url:{type:"string",required:!0,searchable:!0},output:{type:"string",
searchable:!0},prexslurl:{type:"string",searchable:!0},postxslurl:{type:"string",searchable:!0},timeout:{type:"string",searchable:!0}},null)},Html:{anonymousResult:!0,tableName:"html",resultPath:["query","results"],resultSkipFirstLevel:!0,type:$data.EntitySet,elementType:$data.Class.define("$data.Yahoo.types.YQLHtml",$data.Entity,null,{url:{type:"string",required:!0,searchable:!0},charset:{type:"string",searchable:!0},browser:{type:"bool",searchable:!0},xpath:{type:"string",searchable:!0},compat:{type:"string",
searchable:!0,description:"valid values for compat is 'html5' and 'html4'"},Result:{type:"string",searchable:!0}},null)},Json:{anonymousResult:!0,tableName:"json",resultPath:["query","results"],resultSkipFirstLevel:!0,type:$data.EntitySet,elementType:$data.Class.define("$data.Yahoo.types.YQLJson",$data.Entity,null,{url:{type:"string",required:!0,searchable:!0},itemPath:{type:"string",searchable:!0}},null)},Rss:{anonymousResult:!1,tableName:"rss",resultPath:["query","results"],resultSkipFirstLevel:!0,
type:$data.EntitySet,elementType:$data.Class.define("$data.Yahoo.types.YQLRss",$data.Entity,null,{url:{type:"string",required:!0,searchable:!0},guid:{type:"GuidField"},title:{type:"string"},description:{type:"string"},link:{type:"string"},pubDate:{type:"string"}},null)},GuidField:{type:$data.Class.define("GuidField",$data.Entity,null,{isPermaLink:{type:"string"},content:{type:"string"}},null)},Xml:{anonymousResult:!0,tableName:"xml",resultPath:["query","results"],resultSkipFirstLevel:!0,type:$data.EntitySet,
elementType:$data.Class.define("$data.Yahoo.types.YQLXml",$data.Entity,null,{url:{type:"string",required:!0,searchable:!0},itemPath:{type:"string",searchable:!0}},null)},Xslt:{anonymousResult:!0,tableName:"xslt",resultPath:["query","results"],resultSkipFirstLevel:!0,type:$data.EntitySet,elementType:$data.Class.define("$data.Yahoo.types.YQLXslt",$data.Entity,null,{url:{type:"string",searchable:!0},xml:{type:"string",searchable:!0},stylesheet:{type:"string",searchable:!0},stylesheetliteral:{type:"string",
searchable:!0},wrapperelement:{type:"string",searchable:!0}},null)}},null);
